<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE BangPatterns #-}</span><span>
</span><a name="line-2"></a><span class="hs-pragma">{-# LANGUAGE CPP #-}</span><span>
</span><a name="line-3"></a><span>
</span><a name="line-4"></a><span class="hs-comment">{- |
Module      :  Generics.Deriving.TH
Copyright   :  (c) 2008--2009 Universiteit Utrecht
License     :  BSD3

Maintainer  :  generics@haskell.org
Stability   :  experimental
Portability :  non-portable

This module contains Template Haskell code that can be used to
automatically generate the boilerplate code for the generic deriving
library.

To use these functions, pass the name of a data type as an argument:

@
&amp;#123;-&amp;#35; LANGUAGE TemplateHaskell &amp;#35;-&amp;#125;

data Example a = Example Int Char a
$('deriveAll0'     ''Example) -- Derives Generic instance
$('deriveAll1'     ''Example) -- Derives Generic1 instance
$('deriveAll0And1' ''Example) -- Derives Generic and Generic1 instances
@

On GHC 7.4 or later, this code can also be used with data families. To derive
for a data family instance, pass the name of one of the instance's constructors:

@
&amp;#123;-&amp;#35; LANGUAGE FlexibleInstances, TemplateHaskell, TypeFamilies &amp;#35;-&amp;#125;

data family Family a b
newtype instance Family Char x = FamilyChar Char
data    instance Family Bool x = FamilyTrue | FamilyFalse

$('deriveAll0' 'FamilyChar) -- instance Generic (Family Char b) where ...
$('deriveAll1' 'FamilyTrue) -- instance Generic1 (Family Bool) where ...
-- Alternatively, one could type $(deriveAll1 'FamilyFalse)
@
-}</span><span>
</span><a name="line-43"></a><span>
</span><a name="line-44"></a><span class="hs-comment">-- Adapted from Generics.Regular.TH</span><span>
</span><a name="line-45"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Generics</span><span class="hs-operator">.</span><span class="hs-identifier">Deriving</span><span class="hs-operator">.</span><span class="hs-identifier">TH</span><span> </span><span class="hs-special">(</span><span>
</span><a name="line-46"></a><span>      </span><span class="hs-comment">-- * @derive@- functions</span><span>
</span><a name="line-47"></a><span>      </span><a href="Generics.Deriving.TH.Post4_9.html#deriveMeta"><span class="hs-identifier hs-var">deriveMeta</span></a><span>
</span><a name="line-48"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Generics.Deriving.TH.Post4_9.html#deriveData"><span class="hs-identifier hs-var">deriveData</span></a><span>
</span><a name="line-49"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Generics.Deriving.TH.Post4_9.html#deriveConstructors"><span class="hs-identifier hs-var">deriveConstructors</span></a><span>
</span><a name="line-50"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Generics.Deriving.TH.Post4_9.html#deriveSelectors"><span class="hs-identifier hs-var">deriveSelectors</span></a><span>
</span><a name="line-51"></a><span>
</span><a name="line-52"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Generics.Deriving.TH.html#deriveAll"><span class="hs-identifier hs-var">deriveAll</span></a><span>
</span><a name="line-53"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Generics.Deriving.TH.html#deriveAll0"><span class="hs-identifier hs-var">deriveAll0</span></a><span>
</span><a name="line-54"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Generics.Deriving.TH.html#deriveAll1"><span class="hs-identifier hs-var">deriveAll1</span></a><span>
</span><a name="line-55"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Generics.Deriving.TH.html#deriveAll0And1"><span class="hs-identifier hs-var">deriveAll0And1</span></a><span>
</span><a name="line-56"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Generics.Deriving.TH.html#deriveRepresentable0"><span class="hs-identifier hs-var">deriveRepresentable0</span></a><span>
</span><a name="line-57"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Generics.Deriving.TH.html#deriveRepresentable1"><span class="hs-identifier hs-var">deriveRepresentable1</span></a><span>
</span><a name="line-58"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Generics.Deriving.TH.html#deriveRep0"><span class="hs-identifier hs-var">deriveRep0</span></a><span>
</span><a name="line-59"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Generics.Deriving.TH.html#deriveRep1"><span class="hs-identifier hs-var">deriveRep1</span></a><span>
</span><a name="line-60"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Generics.Deriving.TH.html#simplInstance"><span class="hs-identifier hs-var">simplInstance</span></a><span>
</span><a name="line-61"></a><span>
</span><a name="line-62"></a><span>     </span><span class="hs-comment">-- * @make@- functions</span><span>
</span><a name="line-63"></a><span>     </span><span class="hs-comment">-- $make</span><span>
</span><a name="line-64"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Generics.Deriving.TH.html#makeRep0Inline"><span class="hs-identifier hs-var">makeRep0Inline</span></a><span>
</span><a name="line-65"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Generics.Deriving.TH.html#makeRep0"><span class="hs-identifier hs-var">makeRep0</span></a><span>
</span><a name="line-66"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Generics.Deriving.TH.html#makeRep0FromType"><span class="hs-identifier hs-var">makeRep0FromType</span></a><span>
</span><a name="line-67"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Generics.Deriving.TH.html#makeFrom"><span class="hs-identifier hs-var">makeFrom</span></a><span>
</span><a name="line-68"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Generics.Deriving.TH.html#makeFrom0"><span class="hs-identifier hs-var">makeFrom0</span></a><span>
</span><a name="line-69"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Generics.Deriving.TH.html#makeTo"><span class="hs-identifier hs-var">makeTo</span></a><span>
</span><a name="line-70"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Generics.Deriving.TH.html#makeTo0"><span class="hs-identifier hs-var">makeTo0</span></a><span>
</span><a name="line-71"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Generics.Deriving.TH.html#makeRep1Inline"><span class="hs-identifier hs-var">makeRep1Inline</span></a><span>
</span><a name="line-72"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Generics.Deriving.TH.html#makeRep1"><span class="hs-identifier hs-var">makeRep1</span></a><span>
</span><a name="line-73"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Generics.Deriving.TH.html#makeRep1FromType"><span class="hs-identifier hs-var">makeRep1FromType</span></a><span>
</span><a name="line-74"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Generics.Deriving.TH.html#makeFrom1"><span class="hs-identifier hs-var">makeFrom1</span></a><span>
</span><a name="line-75"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Generics.Deriving.TH.html#makeTo1"><span class="hs-identifier hs-var">makeTo1</span></a><span>
</span><a name="line-76"></a><span>
</span><a name="line-77"></a><span>     </span><span class="hs-comment">-- * Options</span><span>
</span><a name="line-78"></a><span>     </span><span class="hs-comment">-- $options</span><span>
</span><a name="line-79"></a><span>     </span><span class="hs-comment">-- ** Option types</span><span>
</span><a name="line-80"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Generics.Deriving.TH.html#Options"><span class="hs-identifier hs-type">Options</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-81"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Generics.Deriving.TH.html#defaultOptions"><span class="hs-identifier hs-var">defaultOptions</span></a><span>
</span><a name="line-82"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Generics.Deriving.TH.html#RepOptions"><span class="hs-identifier hs-type">RepOptions</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-83"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Generics.Deriving.TH.html#defaultRepOptions"><span class="hs-identifier hs-var">defaultRepOptions</span></a><span>
</span><a name="line-84"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Generics.Deriving.TH.html#KindSigOptions"><span class="hs-identifier hs-type">KindSigOptions</span></a><span>
</span><a name="line-85"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Generics.Deriving.TH.html#defaultKindSigOptions"><span class="hs-identifier hs-var">defaultKindSigOptions</span></a><span>
</span><a name="line-86"></a><span>
</span><a name="line-87"></a><span>    </span><span class="hs-comment">-- ** Functions with optional arguments</span><span>
</span><a name="line-88"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Generics.Deriving.TH.html#deriveAll0Options"><span class="hs-identifier hs-var">deriveAll0Options</span></a><span>
</span><a name="line-89"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Generics.Deriving.TH.html#deriveAll1Options"><span class="hs-identifier hs-var">deriveAll1Options</span></a><span>
</span><a name="line-90"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Generics.Deriving.TH.html#deriveAll0And1Options"><span class="hs-identifier hs-var">deriveAll0And1Options</span></a><span>
</span><a name="line-91"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Generics.Deriving.TH.html#deriveRepresentable0Options"><span class="hs-identifier hs-var">deriveRepresentable0Options</span></a><span>
</span><a name="line-92"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Generics.Deriving.TH.html#deriveRepresentable1Options"><span class="hs-identifier hs-var">deriveRepresentable1Options</span></a><span>
</span><a name="line-93"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Generics.Deriving.TH.html#deriveRep0Options"><span class="hs-identifier hs-var">deriveRep0Options</span></a><span>
</span><a name="line-94"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Generics.Deriving.TH.html#deriveRep1Options"><span class="hs-identifier hs-var">deriveRep1Options</span></a><span>
</span><a name="line-95"></a><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-96"></a><span>
</span><a name="line-97"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Control</span><span class="hs-operator">.</span><span class="hs-identifier">Monad</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-operator hs-var">&gt;=&gt;</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">unless</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">when</span><span class="hs-special">)</span><span>
</span><a name="line-98"></a><span>
</span><a name="line-99"></a><span class="hs-cpp">#if MIN_VERSION_template_haskell(2,8,0) &amp;&amp; !(MIN_VERSION_template_haskell(2,10,0))</span><span>
</span><a name="line-100"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Foldable</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">foldr'</span><span class="hs-special">)</span><span>
</span><a name="line-101"></a><span class="hs-cpp">#endif</span><span>
</span><a name="line-102"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">List</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">nub</span><span class="hs-special">)</span><span>
</span><a name="line-103"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Map</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">Map</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fromList</span><span class="hs-special">)</span><span>
</span><a name="line-104"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Maybe</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">catMaybes</span><span class="hs-special">)</span><span>
</span><a name="line-105"></a><span>
</span><a name="line-106"></a><span class="hs-keyword">import</span><span>           </span><a href="Generics.Deriving.TH.Internal.html"><span class="hs-identifier">Generics</span><span class="hs-operator">.</span><span class="hs-identifier">Deriving</span><span class="hs-operator">.</span><span class="hs-identifier">TH</span><span class="hs-operator">.</span><span class="hs-identifier">Internal</span></a><span>
</span><a name="line-107"></a><span class="hs-cpp">#if MIN_VERSION_base(4,9,0)</span><span>
</span><a name="line-108"></a><span class="hs-keyword">import</span><span>           </span><a href="Generics.Deriving.TH.Post4_9.html"><span class="hs-identifier">Generics</span><span class="hs-operator">.</span><span class="hs-identifier">Deriving</span><span class="hs-operator">.</span><span class="hs-identifier">TH</span><span class="hs-operator">.</span><span class="hs-identifier">Post4_9</span></a><span>
</span><a name="line-109"></a><span class="hs-cpp">#else</span><span>
</span><a name="line-110"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Generics</span><span class="hs-operator">.</span><span class="hs-identifier">Deriving</span><span class="hs-operator">.</span><span class="hs-identifier">TH</span><span class="hs-operator">.</span><span class="hs-identifier">Pre4_9</span><span>
</span><a name="line-111"></a><span class="hs-cpp">#endif</span><span>
</span><a name="line-112"></a><span>
</span><a name="line-113"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Language</span><span class="hs-operator">.</span><span class="hs-identifier">Haskell</span><span class="hs-operator">.</span><span class="hs-identifier">TH</span><span class="hs-operator">.</span><span class="hs-identifier">Lib</span><span>
</span><a name="line-114"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Language</span><span class="hs-operator">.</span><span class="hs-identifier">Haskell</span><span class="hs-operator">.</span><span class="hs-identifier">TH</span><span>
</span><a name="line-115"></a><span>
</span><a name="line-116"></a><span class="hs-comment">{- $options
'Options' gives you a way to further tweak derived 'Generic' and 'Generic1' instances:

* 'RepOptions': By default, all derived 'Rep' and 'Rep1' type instances emit the code
  directly (the 'InlineRep' option). One can also choose to emit a separate type
  synonym for the 'Rep' type (this is the functionality of 'deriveRep0' and
  'deriveRep1') and define a 'Rep' instance in terms of that type synonym (the
  'TypeSynonymRep' option).

* 'KindSigOptions': By default, all derived instances will use explicit kind
  signatures (when the 'KindSigOptions' is 'True'). You might wish to set the
  'KindSigOptions' to 'False' if you want a 'Generic'/'Generic1' instance at
  a particular kind that GHC will infer correctly, but the functions in this
  module won't guess correctly. For example, the following example will only
  compile with 'KindSigOptions' set to 'False':

  @
  newtype Compose (f :: k2 -&gt; *) (g :: k1 -&gt; k2) (a :: k1) = Compose (f (g a))
  $('deriveAll1Options' False ''Compose)
  @
-}</span><span>
</span><a name="line-137"></a><span>
</span><a name="line-138"></a><span class="hs-comment">-- | Given the names of a generic class, a type to instantiate, a function in</span><span>
</span><a name="line-139"></a><span class="hs-comment">-- the class and the default implementation, generates the code for a basic</span><span>
</span><a name="line-140"></a><span class="hs-comment">-- generic instance.</span><span>
</span><a name="line-141"></a><span class="hs-identifier">simplInstance</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Q</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Dec</span><span class="hs-special">]</span><span>
</span><a name="line-142"></a><a name="simplInstance"><a href="Generics.Deriving.TH.html#simplInstance"><span class="hs-identifier">simplInstance</span></a></a><span> </span><a name="local-6989586621679053400"><a href="#local-6989586621679053400"><span class="hs-identifier">cl</span></a></a><span> </span><a name="local-6989586621679053401"><a href="#local-6989586621679053401"><span class="hs-identifier">ty</span></a></a><span> </span><a name="local-6989586621679053402"><a href="#local-6989586621679053402"><span class="hs-identifier">fn</span></a></a><span> </span><a name="local-6989586621679053403"><a href="#local-6989586621679053403"><span class="hs-identifier">df</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-143"></a><span>  </span><a name="local-6989586621679053404"><a href="#local-6989586621679053404"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">newName</span><span> </span><span class="hs-string">&quot;x&quot;</span><span>
</span><a name="line-144"></a><span>  </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679053405"><a href="#local-6989586621679053405"><span class="hs-identifier">typ</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">ForallT</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-var">PlainTV</span><span> </span><a href="#local-6989586621679053404"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-145"></a><span>        </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-identifier hs-var">foldl</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679053406"><a href="#local-6989586621679053406"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">AppT</span><span> </span><a href="#local-6989586621679053406"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">VarT</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Generics.Deriving.TH.Internal.html#tyVarBndrName"><span class="hs-identifier hs-var">tyVarBndrName</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">ConT</span><span> </span><span class="hs-special">(</span><a href="Generics.Deriving.TH.html#genRepName"><span class="hs-identifier hs-var">genRepName</span></a><span> </span><a href="Generics.Deriving.TH.Internal.html#Generic"><span class="hs-identifier hs-var">Generic</span></a><span> </span><a href="Generics.Deriving.TH.Internal.html#DataPlain"><span class="hs-identifier hs-var">DataPlain</span></a><span> </span><a href="#local-6989586621679053401"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">AppT</span><span class="hs-special">`</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">VarT</span><span> </span><a href="#local-6989586621679053404"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-146"></a><span>  </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">:</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">instanceD</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">cxt</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">conT</span><span> </span><a href="#local-6989586621679053400"><span class="hs-identifier hs-var">cl</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">appT</span><span class="hs-special">`</span><span> </span><span class="hs-identifier hs-var">conT</span><span> </span><a href="#local-6989586621679053401"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-147"></a><span>    </span><span class="hs-special">[</span><span class="hs-identifier hs-var">funD</span><span> </span><a href="#local-6989586621679053402"><span class="hs-identifier hs-var">fn</span></a><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-var">clause</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">normalB</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">varE</span><span> </span><a href="#local-6989586621679053403"><span class="hs-identifier hs-var">df</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">appE</span><span class="hs-special">`</span><span>
</span><a name="line-148"></a><span>      </span><span class="hs-special">(</span><span class="hs-identifier hs-var">sigE</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">varE</span><span> </span><a href="Generics.Deriving.TH.Internal.html#undefinedValName"><span class="hs-identifier hs-var">undefinedValName</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">return</span><span> </span><a href="#local-6989586621679053405"><span class="hs-identifier hs-var">typ</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a name="line-149"></a><span>
</span><a name="line-150"></a><span class="hs-comment">-- | Additional options for configuring derived 'Generic'/'Generic1' instances</span><span>
</span><a name="line-151"></a><span class="hs-comment">-- using Template Haskell.</span><span>
</span><a name="line-152"></a><span class="hs-keyword">data</span><span> </span><a name="Options"><a href="Generics.Deriving.TH.html#Options"><span class="hs-identifier">Options</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="Options"><a href="Generics.Deriving.TH.html#Options"><span class="hs-identifier">Options</span></a></a><span>
</span><a name="line-153"></a><span>  </span><span class="hs-special">{</span><span> </span><a name="repOptions"><a href="Generics.Deriving.TH.html#repOptions"><span class="hs-identifier">repOptions</span></a></a><span>     </span><span class="hs-glyph">::</span><span> </span><a href="Generics.Deriving.TH.html#RepOptions"><span class="hs-identifier hs-type">RepOptions</span></a><span>
</span><a name="line-154"></a><span>  </span><span class="hs-special">,</span><span> </span><a name="kindSigOptions"><a href="Generics.Deriving.TH.html#kindSigOptions"><span class="hs-identifier">kindSigOptions</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Generics.Deriving.TH.html#KindSigOptions"><span class="hs-identifier hs-type">KindSigOptions</span></a><span>
</span><a name="line-155"></a><span>  </span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Ord</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Read</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Show</span><span class="hs-special">)</span><span>
</span><a name="line-156"></a><span>
</span><a name="line-157"></a><span class="hs-comment">-- | Sensible default 'Options' ('defaultRepOptions' and 'defaultKindSigOptions').</span><span>
</span><a name="line-158"></a><span class="hs-identifier">defaultOptions</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Generics.Deriving.TH.html#Options"><span class="hs-identifier hs-type">Options</span></a><span>
</span><a name="line-159"></a><a name="defaultOptions"><a href="Generics.Deriving.TH.html#defaultOptions"><span class="hs-identifier">defaultOptions</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Generics.Deriving.TH.html#Options"><span class="hs-identifier hs-var">Options</span></a><span>
</span><a name="line-160"></a><span>  </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">repOptions</span><span>     </span><span class="hs-glyph">=</span><span> </span><a href="Generics.Deriving.TH.html#defaultRepOptions"><span class="hs-identifier hs-var">defaultRepOptions</span></a><span>
</span><a name="line-161"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">kindSigOptions</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Generics.Deriving.TH.html#defaultKindSigOptions"><span class="hs-identifier hs-var">defaultKindSigOptions</span></a><span>
</span><a name="line-162"></a><span>  </span><span class="hs-special">}</span><span>
</span><a name="line-163"></a><span>
</span><a name="line-164"></a><span class="hs-comment">-- | Configures whether 'Rep'/'Rep1' type instances should be defined inline in a</span><span>
</span><a name="line-165"></a><span class="hs-comment">-- derived 'Generic'/'Generic1' instance ('InlineRep') or defined in terms of a</span><span>
</span><a name="line-166"></a><span class="hs-comment">-- type synonym ('TypeSynonymRep').</span><span>
</span><a name="line-167"></a><span class="hs-keyword">data</span><span> </span><a name="RepOptions"><a href="Generics.Deriving.TH.html#RepOptions"><span class="hs-identifier">RepOptions</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="InlineRep"><a href="Generics.Deriving.TH.html#InlineRep"><span class="hs-identifier">InlineRep</span></a></a><span>
</span><a name="line-168"></a><span>                </span><span class="hs-glyph">|</span><span> </span><a name="TypeSynonymRep"><a href="Generics.Deriving.TH.html#TypeSynonymRep"><span class="hs-identifier">TypeSynonymRep</span></a></a><span>
</span><a name="line-169"></a><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Ord</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Read</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Show</span><span class="hs-special">)</span><span>
</span><a name="line-170"></a><span>
</span><a name="line-171"></a><span class="hs-comment">-- | 'InlineRep', a sensible default 'RepOptions'.</span><span>
</span><a name="line-172"></a><span class="hs-identifier">defaultRepOptions</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Generics.Deriving.TH.html#RepOptions"><span class="hs-identifier hs-type">RepOptions</span></a><span>
</span><a name="line-173"></a><a name="defaultRepOptions"><a href="Generics.Deriving.TH.html#defaultRepOptions"><span class="hs-identifier">defaultRepOptions</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Generics.Deriving.TH.html#InlineRep"><span class="hs-identifier hs-var">InlineRep</span></a><span>
</span><a name="line-174"></a><span>
</span><a name="line-175"></a><span class="hs-comment">-- | 'True' if explicit kind signatures should be used in derived</span><span>
</span><a name="line-176"></a><span class="hs-comment">-- 'Generic'/'Generic1' instances, 'False' otherwise.</span><span>
</span><a name="line-177"></a><span class="hs-keyword">type</span><span> </span><a name="KindSigOptions"><a href="Generics.Deriving.TH.html#KindSigOptions"><span class="hs-identifier">KindSigOptions</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-178"></a><span>
</span><a name="line-179"></a><span class="hs-comment">-- | 'True', a sensible default 'KindSigOptions'.</span><span>
</span><a name="line-180"></a><span class="hs-identifier">defaultKindSigOptions</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Generics.Deriving.TH.html#KindSigOptions"><span class="hs-identifier hs-type">KindSigOptions</span></a><span>
</span><a name="line-181"></a><a name="defaultKindSigOptions"><a href="Generics.Deriving.TH.html#defaultKindSigOptions"><span class="hs-identifier">defaultKindSigOptions</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-182"></a><span>
</span><a name="line-183"></a><span class="hs-comment">-- | A backwards-compatible synonym for 'deriveAll0'.</span><span>
</span><a name="line-184"></a><span class="hs-identifier">deriveAll</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Q</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Dec</span><span class="hs-special">]</span><span>
</span><a name="line-185"></a><a name="deriveAll"><a href="Generics.Deriving.TH.html#deriveAll"><span class="hs-identifier">deriveAll</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Generics.Deriving.TH.html#deriveAll0"><span class="hs-identifier hs-var">deriveAll0</span></a><span>
</span><a name="line-186"></a><span>
</span><a name="line-187"></a><span class="hs-comment">-- | Given the type and the name (as string) for the type to derive,</span><span>
</span><a name="line-188"></a><span class="hs-comment">-- generate the 'Data' instance, the 'Constructor' instances, the 'Selector'</span><span>
</span><a name="line-189"></a><span class="hs-comment">-- instances, and the 'Representable0' instance.</span><span>
</span><a name="line-190"></a><span class="hs-identifier">deriveAll0</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Q</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Dec</span><span class="hs-special">]</span><span>
</span><a name="line-191"></a><a name="deriveAll0"><a href="Generics.Deriving.TH.html#deriveAll0"><span class="hs-identifier">deriveAll0</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Generics.Deriving.TH.html#deriveAll0Options"><span class="hs-identifier hs-var">deriveAll0Options</span></a><span> </span><a href="Generics.Deriving.TH.html#defaultOptions"><span class="hs-identifier hs-var">defaultOptions</span></a><span>
</span><a name="line-192"></a><span>
</span><a name="line-193"></a><span class="hs-comment">-- | Like 'deriveAll0', but takes an 'Options' argument.</span><span>
</span><a name="line-194"></a><span class="hs-identifier">deriveAll0Options</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Generics.Deriving.TH.html#Options"><span class="hs-identifier hs-type">Options</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Q</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Dec</span><span class="hs-special">]</span><span>
</span><a name="line-195"></a><a name="deriveAll0Options"><a href="Generics.Deriving.TH.html#deriveAll0Options"><span class="hs-identifier">deriveAll0Options</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Generics.Deriving.TH.html#deriveAllCommon"><span class="hs-identifier hs-var">deriveAllCommon</span></a><span> </span><span class="hs-identifier hs-var">True</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-196"></a><span>
</span><a name="line-197"></a><span class="hs-comment">-- | Given the type and the name (as string) for the type to derive,</span><span>
</span><a name="line-198"></a><span class="hs-comment">-- generate the 'Data' instance, the 'Constructor' instances, the 'Selector'</span><span>
</span><a name="line-199"></a><span class="hs-comment">-- instances, and the 'Representable1' instance.</span><span>
</span><a name="line-200"></a><span class="hs-identifier">deriveAll1</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Q</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Dec</span><span class="hs-special">]</span><span>
</span><a name="line-201"></a><a name="deriveAll1"><a href="Generics.Deriving.TH.html#deriveAll1"><span class="hs-identifier">deriveAll1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Generics.Deriving.TH.html#deriveAll1Options"><span class="hs-identifier hs-var">deriveAll1Options</span></a><span> </span><a href="Generics.Deriving.TH.html#defaultOptions"><span class="hs-identifier hs-var">defaultOptions</span></a><span>
</span><a name="line-202"></a><span>
</span><a name="line-203"></a><span class="hs-comment">-- | Like 'deriveAll1', but takes an 'Options' argument.</span><span>
</span><a name="line-204"></a><span class="hs-identifier">deriveAll1Options</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Generics.Deriving.TH.html#Options"><span class="hs-identifier hs-type">Options</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Q</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Dec</span><span class="hs-special">]</span><span>
</span><a name="line-205"></a><a name="deriveAll1Options"><a href="Generics.Deriving.TH.html#deriveAll1Options"><span class="hs-identifier">deriveAll1Options</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Generics.Deriving.TH.html#deriveAllCommon"><span class="hs-identifier hs-var">deriveAllCommon</span></a><span> </span><span class="hs-identifier hs-var">False</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-206"></a><span>
</span><a name="line-207"></a><span class="hs-comment">-- | Given the type and the name (as string) for the type to derive,</span><span>
</span><a name="line-208"></a><span class="hs-comment">-- generate the 'Data' instance, the 'Constructor' instances, the 'Selector'</span><span>
</span><a name="line-209"></a><span class="hs-comment">-- instances, the 'Representable0' instance, and the 'Representable1' instance.</span><span>
</span><a name="line-210"></a><span class="hs-identifier">deriveAll0And1</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Q</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Dec</span><span class="hs-special">]</span><span>
</span><a name="line-211"></a><a name="deriveAll0And1"><a href="Generics.Deriving.TH.html#deriveAll0And1"><span class="hs-identifier">deriveAll0And1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Generics.Deriving.TH.html#deriveAll0And1Options"><span class="hs-identifier hs-var">deriveAll0And1Options</span></a><span> </span><a href="Generics.Deriving.TH.html#defaultOptions"><span class="hs-identifier hs-var">defaultOptions</span></a><span>
</span><a name="line-212"></a><span>
</span><a name="line-213"></a><span class="hs-comment">-- | Like 'deriveAll0And1', but takes an 'Options' argument.</span><span>
</span><a name="line-214"></a><span class="hs-identifier">deriveAll0And1Options</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Generics.Deriving.TH.html#Options"><span class="hs-identifier hs-type">Options</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Q</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Dec</span><span class="hs-special">]</span><span>
</span><a name="line-215"></a><a name="deriveAll0And1Options"><a href="Generics.Deriving.TH.html#deriveAll0And1Options"><span class="hs-identifier">deriveAll0And1Options</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Generics.Deriving.TH.html#deriveAllCommon"><span class="hs-identifier hs-var">deriveAllCommon</span></a><span> </span><span class="hs-identifier hs-var">True</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-216"></a><span>
</span><a name="line-217"></a><span class="hs-identifier">deriveAllCommon</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Bool</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Generics.Deriving.TH.html#Options"><span class="hs-identifier hs-type">Options</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Q</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Dec</span><span class="hs-special">]</span><span>
</span><a name="line-218"></a><a name="deriveAllCommon"><a href="Generics.Deriving.TH.html#deriveAllCommon"><span class="hs-identifier">deriveAllCommon</span></a></a><span> </span><a name="local-6989586621679053407"><a href="#local-6989586621679053407"><span class="hs-identifier">generic</span></a></a><span> </span><a name="local-6989586621679053408"><a href="#local-6989586621679053408"><span class="hs-identifier">generic1</span></a></a><span> </span><a name="local-6989586621679053409"><a href="#local-6989586621679053409"><span class="hs-identifier">opts</span></a></a><span> </span><a name="local-6989586621679053410"><a href="#local-6989586621679053410"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-219"></a><span>    </span><a name="local-6989586621679053411"><a href="#local-6989586621679053411"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Generics.Deriving.TH.Post4_9.html#deriveMeta"><span class="hs-identifier hs-var">deriveMeta</span></a><span> </span><a href="#local-6989586621679053410"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-220"></a><span>    </span><a name="local-6989586621679053412"><a href="#local-6989586621679053412"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679053407"><span class="hs-identifier hs-var">generic</span></a><span>
</span><a name="line-221"></a><span>            </span><span class="hs-keyword">then</span><span> </span><a href="Generics.Deriving.TH.html#deriveRepresentableCommon"><span class="hs-identifier hs-var">deriveRepresentableCommon</span></a><span> </span><a href="Generics.Deriving.TH.Internal.html#Generic"><span class="hs-identifier hs-var">Generic</span></a><span> </span><a href="#local-6989586621679053409"><span class="hs-identifier hs-var">opts</span></a><span> </span><a href="#local-6989586621679053410"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-222"></a><span>            </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-223"></a><span>    </span><a name="local-6989586621679053413"><a href="#local-6989586621679053413"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679053408"><span class="hs-identifier hs-var">generic1</span></a><span>
</span><a name="line-224"></a><span>            </span><span class="hs-keyword">then</span><span> </span><a href="Generics.Deriving.TH.html#deriveRepresentableCommon"><span class="hs-identifier hs-var">deriveRepresentableCommon</span></a><span> </span><a href="Generics.Deriving.TH.Internal.html#Generic1"><span class="hs-identifier hs-var">Generic1</span></a><span> </span><a href="#local-6989586621679053409"><span class="hs-identifier hs-var">opts</span></a><span> </span><a href="#local-6989586621679053410"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-225"></a><span>            </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-226"></a><span>    </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679053411"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679053412"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679053413"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span>
</span><a name="line-227"></a><span>
</span><a name="line-228"></a><span class="hs-comment">-- | Given the type and the name (as string) for the Representable0 type</span><span>
</span><a name="line-229"></a><span class="hs-comment">-- synonym to derive, generate the 'Representable0' instance.</span><span>
</span><a name="line-230"></a><span class="hs-identifier">deriveRepresentable0</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Q</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Dec</span><span class="hs-special">]</span><span>
</span><a name="line-231"></a><a name="deriveRepresentable0"><a href="Generics.Deriving.TH.html#deriveRepresentable0"><span class="hs-identifier">deriveRepresentable0</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Generics.Deriving.TH.html#deriveRepresentable0Options"><span class="hs-identifier hs-var">deriveRepresentable0Options</span></a><span> </span><a href="Generics.Deriving.TH.html#defaultOptions"><span class="hs-identifier hs-var">defaultOptions</span></a><span>
</span><a name="line-232"></a><span>
</span><a name="line-233"></a><span class="hs-comment">-- | Like 'deriveRepresentable0', but takes an 'Options' argument.</span><span>
</span><a name="line-234"></a><span class="hs-identifier">deriveRepresentable0Options</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Generics.Deriving.TH.html#Options"><span class="hs-identifier hs-type">Options</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Q</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Dec</span><span class="hs-special">]</span><span>
</span><a name="line-235"></a><a name="deriveRepresentable0Options"><a href="Generics.Deriving.TH.html#deriveRepresentable0Options"><span class="hs-identifier">deriveRepresentable0Options</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Generics.Deriving.TH.html#deriveRepresentableCommon"><span class="hs-identifier hs-var">deriveRepresentableCommon</span></a><span> </span><a href="Generics.Deriving.TH.Internal.html#Generic"><span class="hs-identifier hs-var">Generic</span></a><span>
</span><a name="line-236"></a><span>
</span><a name="line-237"></a><span class="hs-comment">-- | Given the type and the name (as string) for the Representable1 type</span><span>
</span><a name="line-238"></a><span class="hs-comment">-- synonym to derive, generate the 'Representable1' instance.</span><span>
</span><a name="line-239"></a><span class="hs-identifier">deriveRepresentable1</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Q</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Dec</span><span class="hs-special">]</span><span>
</span><a name="line-240"></a><a name="deriveRepresentable1"><a href="Generics.Deriving.TH.html#deriveRepresentable1"><span class="hs-identifier">deriveRepresentable1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Generics.Deriving.TH.html#deriveRepresentable1Options"><span class="hs-identifier hs-var">deriveRepresentable1Options</span></a><span> </span><a href="Generics.Deriving.TH.html#defaultOptions"><span class="hs-identifier hs-var">defaultOptions</span></a><span>
</span><a name="line-241"></a><span>
</span><a name="line-242"></a><span class="hs-comment">-- | Like 'deriveRepresentable1', but takes an 'Options' argument.</span><span>
</span><a name="line-243"></a><span class="hs-identifier">deriveRepresentable1Options</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Generics.Deriving.TH.html#Options"><span class="hs-identifier hs-type">Options</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Q</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Dec</span><span class="hs-special">]</span><span>
</span><a name="line-244"></a><a name="deriveRepresentable1Options"><a href="Generics.Deriving.TH.html#deriveRepresentable1Options"><span class="hs-identifier">deriveRepresentable1Options</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Generics.Deriving.TH.html#deriveRepresentableCommon"><span class="hs-identifier hs-var">deriveRepresentableCommon</span></a><span> </span><a href="Generics.Deriving.TH.Internal.html#Generic1"><span class="hs-identifier hs-var">Generic1</span></a><span>
</span><a name="line-245"></a><span>
</span><a name="line-246"></a><span class="hs-identifier">deriveRepresentableCommon</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Generics.Deriving.TH.Internal.html#GenericClass"><span class="hs-identifier hs-type">GenericClass</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Generics.Deriving.TH.html#Options"><span class="hs-identifier hs-type">Options</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Q</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Dec</span><span class="hs-special">]</span><span>
</span><a name="line-247"></a><a name="deriveRepresentableCommon"><a href="Generics.Deriving.TH.html#deriveRepresentableCommon"><span class="hs-identifier">deriveRepresentableCommon</span></a></a><span> </span><a name="local-6989586621679053414"><a href="#local-6989586621679053414"><span class="hs-identifier">gClass</span></a></a><span> </span><a name="local-6989586621679053415"><a href="#local-6989586621679053415"><span class="hs-identifier">opts</span></a></a><span> </span><a name="local-6989586621679053416"><a href="#local-6989586621679053416"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-248"></a><span>    </span><a name="local-6989586621679053417"><a href="#local-6989586621679053417"><span class="hs-identifier">rep</span></a></a><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier">repOptions</span><span> </span><a href="#local-6989586621679053415"><span class="hs-identifier hs-var">opts</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="Generics.Deriving.TH.html#InlineRep"><span class="hs-identifier hs-var">InlineRep</span></a><span>
</span><a name="line-249"></a><span>               </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-250"></a><span>               </span><span class="hs-keyword">else</span><span> </span><a href="Generics.Deriving.TH.html#deriveRepCommon"><span class="hs-identifier hs-var">deriveRepCommon</span></a><span> </span><a href="#local-6989586621679053414"><span class="hs-identifier hs-var">gClass</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">kindSigOptions</span><span> </span><a href="#local-6989586621679053415"><span class="hs-identifier hs-var">opts</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679053416"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-251"></a><span>    </span><a name="local-6989586621679053418"><a href="#local-6989586621679053418"><span class="hs-identifier">inst</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Generics.Deriving.TH.html#deriveInst"><span class="hs-identifier hs-var">deriveInst</span></a><span> </span><a href="#local-6989586621679053414"><span class="hs-identifier hs-var">gClass</span></a><span> </span><a href="#local-6989586621679053415"><span class="hs-identifier hs-var">opts</span></a><span> </span><a href="#local-6989586621679053416"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-252"></a><span>    </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679053417"><span class="hs-identifier hs-var">rep</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679053418"><span class="hs-identifier hs-var">inst</span></a><span class="hs-special">)</span><span>
</span><a name="line-253"></a><span>
</span><a name="line-254"></a><span class="hs-comment">-- | Derive only the 'Rep0' type synonym. Not needed if 'deriveRepresentable0'</span><span>
</span><a name="line-255"></a><span class="hs-comment">-- is used.</span><span>
</span><a name="line-256"></a><span class="hs-identifier">deriveRep0</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Q</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Dec</span><span class="hs-special">]</span><span>
</span><a name="line-257"></a><a name="deriveRep0"><a href="Generics.Deriving.TH.html#deriveRep0"><span class="hs-identifier">deriveRep0</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Generics.Deriving.TH.html#deriveRep0Options"><span class="hs-identifier hs-var">deriveRep0Options</span></a><span> </span><a href="Generics.Deriving.TH.html#defaultKindSigOptions"><span class="hs-identifier hs-var">defaultKindSigOptions</span></a><span>
</span><a name="line-258"></a><span>
</span><a name="line-259"></a><span class="hs-comment">-- | Like 'deriveRep0', but takes an 'KindSigOptions' argument.</span><span>
</span><a name="line-260"></a><span class="hs-identifier">deriveRep0Options</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Generics.Deriving.TH.html#KindSigOptions"><span class="hs-identifier hs-type">KindSigOptions</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Q</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Dec</span><span class="hs-special">]</span><span>
</span><a name="line-261"></a><a name="deriveRep0Options"><a href="Generics.Deriving.TH.html#deriveRep0Options"><span class="hs-identifier">deriveRep0Options</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Generics.Deriving.TH.html#deriveRepCommon"><span class="hs-identifier hs-var">deriveRepCommon</span></a><span> </span><a href="Generics.Deriving.TH.Internal.html#Generic"><span class="hs-identifier hs-var">Generic</span></a><span>
</span><a name="line-262"></a><span>
</span><a name="line-263"></a><span class="hs-comment">-- | Derive only the 'Rep1' type synonym. Not needed if 'deriveRepresentable1'</span><span>
</span><a name="line-264"></a><span class="hs-comment">-- is used.</span><span>
</span><a name="line-265"></a><span class="hs-identifier">deriveRep1</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Q</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Dec</span><span class="hs-special">]</span><span>
</span><a name="line-266"></a><a name="deriveRep1"><a href="Generics.Deriving.TH.html#deriveRep1"><span class="hs-identifier">deriveRep1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Generics.Deriving.TH.html#deriveRep1Options"><span class="hs-identifier hs-var">deriveRep1Options</span></a><span> </span><a href="Generics.Deriving.TH.html#defaultKindSigOptions"><span class="hs-identifier hs-var">defaultKindSigOptions</span></a><span>
</span><a name="line-267"></a><span>
</span><a name="line-268"></a><span class="hs-comment">-- | Like 'deriveRep1', but takes an 'KindSigOptions' argument.</span><span>
</span><a name="line-269"></a><span class="hs-identifier">deriveRep1Options</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Generics.Deriving.TH.html#KindSigOptions"><span class="hs-identifier hs-type">KindSigOptions</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Q</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Dec</span><span class="hs-special">]</span><span>
</span><a name="line-270"></a><a name="deriveRep1Options"><a href="Generics.Deriving.TH.html#deriveRep1Options"><span class="hs-identifier">deriveRep1Options</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Generics.Deriving.TH.html#deriveRepCommon"><span class="hs-identifier hs-var">deriveRepCommon</span></a><span> </span><a href="Generics.Deriving.TH.Internal.html#Generic1"><span class="hs-identifier hs-var">Generic1</span></a><span>
</span><a name="line-271"></a><span>
</span><a name="line-272"></a><span class="hs-identifier">deriveRepCommon</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Generics.Deriving.TH.Internal.html#GenericClass"><span class="hs-identifier hs-type">GenericClass</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Generics.Deriving.TH.html#KindSigOptions"><span class="hs-identifier hs-type">KindSigOptions</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Q</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Dec</span><span class="hs-special">]</span><span>
</span><a name="line-273"></a><a name="deriveRepCommon"><a href="Generics.Deriving.TH.html#deriveRepCommon"><span class="hs-identifier">deriveRepCommon</span></a></a><span> </span><a name="local-6989586621679053419"><a href="#local-6989586621679053419"><span class="hs-identifier">gClass</span></a></a><span> </span><a name="local-6989586621679053420"><a href="#local-6989586621679053420"><span class="hs-identifier">useKindSigs</span></a></a><span> </span><a name="local-6989586621679053421"><a href="#local-6989586621679053421"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-274"></a><span>  </span><a name="local-6989586621679053422"><a href="#local-6989586621679053422"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Generics.Deriving.TH.Internal.html#reifyDataInfo"><span class="hs-identifier hs-var">reifyDataInfo</span></a><span> </span><a href="#local-6989586621679053421"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-275"></a><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679053423"><a href="#local-6989586621679053423"><span class="hs-identifier">name</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679053424"><a href="#local-6989586621679053424"><span class="hs-identifier">isNT</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679053425"><a href="#local-6989586621679053425"><span class="hs-identifier">declTvbs</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679053426"><a href="#local-6989586621679053426"><span class="hs-identifier">cons</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679053427"><a href="#local-6989586621679053427"><span class="hs-identifier">dv</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">either</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-identifier hs-var">id</span><span> </span><a href="#local-6989586621679053422"><span class="hs-identifier hs-var">i</span></a><span>
</span><a name="line-276"></a><span>  </span><span class="hs-comment">-- See Note [Forcing buildTypeInstance]</span><span>
</span><a name="line-277"></a><span>  </span><span class="hs-glyph">!</span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Generics.Deriving.TH.html#buildTypeInstance"><span class="hs-identifier hs-var">buildTypeInstance</span></a><span> </span><a href="#local-6989586621679053419"><span class="hs-identifier hs-var">gClass</span></a><span> </span><a href="#local-6989586621679053420"><span class="hs-identifier hs-var">useKindSigs</span></a><span> </span><a href="#local-6989586621679053423"><span class="hs-identifier hs-var">name</span></a><span> </span><a href="#local-6989586621679053425"><span class="hs-identifier hs-var">declTvbs</span></a><span> </span><a href="#local-6989586621679053427"><span class="hs-identifier hs-var">dv</span></a><span>
</span><a name="line-278"></a><span>  </span><a name="local-6989586621679053428"><a href="#local-6989586621679053428"><span class="hs-identifier">tySynVars</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Generics.Deriving.TH.html#grabTyVarsFromCons"><span class="hs-identifier hs-var">grabTyVarsFromCons</span></a><span> </span><a href="#local-6989586621679053419"><span class="hs-identifier hs-var">gClass</span></a><span> </span><a href="#local-6989586621679053426"><span class="hs-identifier hs-var">cons</span></a><span>
</span><a name="line-279"></a><span>
</span><a name="line-280"></a><span>  </span><span class="hs-comment">-- See Note [Kind signatures in derived instances]</span><span>
</span><a name="line-281"></a><span>  </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679053429"><a href="#local-6989586621679053429"><span class="hs-identifier">tySynVars'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679053420"><span class="hs-identifier hs-var">useKindSigs</span></a><span>
</span><a name="line-282"></a><span>                      </span><span class="hs-keyword">then</span><span> </span><a href="#local-6989586621679053428"><span class="hs-identifier hs-var">tySynVars</span></a><span>
</span><a name="line-283"></a><span>                      </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><a href="Generics.Deriving.TH.Internal.html#unSigT"><span class="hs-identifier hs-var">unSigT</span></a><span> </span><a href="#local-6989586621679053428"><span class="hs-identifier hs-var">tySynVars</span></a><span>
</span><a name="line-284"></a><span>  </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">:</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">tySynD</span><span> </span><span class="hs-special">(</span><a href="Generics.Deriving.TH.html#genRepName"><span class="hs-identifier hs-var">genRepName</span></a><span> </span><a href="#local-6989586621679053419"><span class="hs-identifier hs-var">gClass</span></a><span> </span><a href="#local-6989586621679053427"><span class="hs-identifier hs-var">dv</span></a><span> </span><a href="#local-6989586621679053423"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">)</span><span>
</span><a name="line-285"></a><span>                      </span><span class="hs-special">(</span><span class="hs-identifier hs-var">catMaybes</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><a href="Generics.Deriving.TH.Internal.html#typeToTyVarBndr"><span class="hs-identifier hs-var">typeToTyVarBndr</span></a><span> </span><a href="#local-6989586621679053429"><span class="hs-identifier hs-var">tySynVars'</span></a><span class="hs-special">)</span><span>
</span><a name="line-286"></a><span>                      </span><span class="hs-special">(</span><a href="Generics.Deriving.TH.html#repType"><span class="hs-identifier hs-var">repType</span></a><span> </span><a href="#local-6989586621679053419"><span class="hs-identifier hs-var">gClass</span></a><span> </span><a href="#local-6989586621679053427"><span class="hs-identifier hs-var">dv</span></a><span> </span><a href="#local-6989586621679053423"><span class="hs-identifier hs-var">name</span></a><span> </span><a href="#local-6989586621679053424"><span class="hs-identifier hs-var">isNT</span></a><span> </span><a href="#local-6989586621679053426"><span class="hs-identifier hs-var">cons</span></a><span> </span><a href="#local-6989586621679053428"><span class="hs-identifier hs-var">tySynVars</span></a><span class="hs-special">)</span><span>
</span><a name="line-287"></a><span>
</span><a name="line-288"></a><span class="hs-identifier">deriveInst</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Generics.Deriving.TH.Internal.html#GenericClass"><span class="hs-identifier hs-type">GenericClass</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Generics.Deriving.TH.html#Options"><span class="hs-identifier hs-type">Options</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Q</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Dec</span><span class="hs-special">]</span><span>
</span><a name="line-289"></a><a name="deriveInst"><a href="Generics.Deriving.TH.html#deriveInst"><span class="hs-identifier">deriveInst</span></a></a><span> </span><a href="Generics.Deriving.TH.Internal.html#Generic"><span class="hs-identifier hs-var">Generic</span></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Generics.Deriving.TH.html#deriveInstCommon"><span class="hs-identifier hs-var">deriveInstCommon</span></a><span> </span><a href="Generics.Deriving.TH.Internal.html#genericTypeName"><span class="hs-identifier hs-var">genericTypeName</span></a><span>  </span><a href="Generics.Deriving.TH.Internal.html#repTypeName"><span class="hs-identifier hs-var">repTypeName</span></a><span>  </span><a href="Generics.Deriving.TH.Internal.html#Generic"><span class="hs-identifier hs-var">Generic</span></a><span>  </span><a href="Generics.Deriving.TH.Internal.html#fromValName"><span class="hs-identifier hs-var">fromValName</span></a><span>  </span><a href="Generics.Deriving.TH.Internal.html#toValName"><span class="hs-identifier hs-var">toValName</span></a><span>
</span><a name="line-290"></a><span class="hs-identifier">deriveInst</span><span> </span><a href="Generics.Deriving.TH.Internal.html#Generic1"><span class="hs-identifier hs-var">Generic1</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Generics.Deriving.TH.html#deriveInstCommon"><span class="hs-identifier hs-var">deriveInstCommon</span></a><span> </span><a href="Generics.Deriving.TH.Internal.html#generic1TypeName"><span class="hs-identifier hs-var">generic1TypeName</span></a><span> </span><a href="Generics.Deriving.TH.Internal.html#rep1TypeName"><span class="hs-identifier hs-var">rep1TypeName</span></a><span> </span><a href="Generics.Deriving.TH.Internal.html#Generic1"><span class="hs-identifier hs-var">Generic1</span></a><span> </span><a href="Generics.Deriving.TH.Internal.html#from1ValName"><span class="hs-identifier hs-var">from1ValName</span></a><span> </span><a href="Generics.Deriving.TH.Internal.html#to1ValName"><span class="hs-identifier hs-var">to1ValName</span></a><span>
</span><a name="line-291"></a><span>
</span><a name="line-292"></a><span class="hs-identifier">deriveInstCommon</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Name</span><span>
</span><a name="line-293"></a><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Name</span><span>
</span><a name="line-294"></a><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Generics.Deriving.TH.Internal.html#GenericClass"><span class="hs-identifier hs-type">GenericClass</span></a><span>
</span><a name="line-295"></a><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Name</span><span>
</span><a name="line-296"></a><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Name</span><span>
</span><a name="line-297"></a><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Generics.Deriving.TH.html#Options"><span class="hs-identifier hs-type">Options</span></a><span>
</span><a name="line-298"></a><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Name</span><span>
</span><a name="line-299"></a><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Q</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Dec</span><span class="hs-special">]</span><span>
</span><a name="line-300"></a><a name="deriveInstCommon"><a href="Generics.Deriving.TH.html#deriveInstCommon"><span class="hs-identifier">deriveInstCommon</span></a></a><span> </span><a name="local-6989586621679053430"><a href="#local-6989586621679053430"><span class="hs-identifier">genericName</span></a></a><span> </span><a name="local-6989586621679053431"><a href="#local-6989586621679053431"><span class="hs-identifier">repName</span></a></a><span> </span><a name="local-6989586621679053432"><a href="#local-6989586621679053432"><span class="hs-identifier">gClass</span></a></a><span> </span><a name="local-6989586621679053433"><a href="#local-6989586621679053433"><span class="hs-identifier">fromName</span></a></a><span> </span><a name="local-6989586621679053434"><a href="#local-6989586621679053434"><span class="hs-identifier">toName</span></a></a><span> </span><a name="local-6989586621679053435"><a href="#local-6989586621679053435"><span class="hs-identifier">opts</span></a></a><span> </span><a name="local-6989586621679053436"><a href="#local-6989586621679053436"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-301"></a><span>  </span><a name="local-6989586621679053437"><a href="#local-6989586621679053437"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Generics.Deriving.TH.Internal.html#reifyDataInfo"><span class="hs-identifier hs-var">reifyDataInfo</span></a><span> </span><a href="#local-6989586621679053436"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-302"></a><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679053438"><a href="#local-6989586621679053438"><span class="hs-identifier">name</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679053439"><a href="#local-6989586621679053439"><span class="hs-identifier">isNT</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679053440"><a href="#local-6989586621679053440"><span class="hs-identifier">allTvbs</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679053441"><a href="#local-6989586621679053441"><span class="hs-identifier">cons</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679053442"><a href="#local-6989586621679053442"><span class="hs-identifier">dv</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">either</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-identifier hs-var">id</span><span> </span><a href="#local-6989586621679053437"><span class="hs-identifier hs-var">i</span></a><span>
</span><a name="line-303"></a><span>      </span><a name="local-6989586621679053443"><a href="#local-6989586621679053443"><span class="hs-identifier">useKindSigs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">kindSigOptions</span><span> </span><a href="#local-6989586621679053435"><span class="hs-identifier hs-var">opts</span></a><span>
</span><a name="line-304"></a><span>  </span><span class="hs-comment">-- See Note [Forcing buildTypeInstance]</span><span>
</span><a name="line-305"></a><span>  </span><span class="hs-glyph">!</span><span class="hs-special">(</span><a name="local-6989586621679053444"><a href="#local-6989586621679053444"><span class="hs-identifier">origTy</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679053445"><a href="#local-6989586621679053445"><span class="hs-identifier">origKind</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Generics.Deriving.TH.html#buildTypeInstance"><span class="hs-identifier hs-var">buildTypeInstance</span></a><span> </span><a href="#local-6989586621679053432"><span class="hs-identifier hs-var">gClass</span></a><span> </span><a href="#local-6989586621679053443"><span class="hs-identifier hs-var">useKindSigs</span></a><span> </span><a href="#local-6989586621679053438"><span class="hs-identifier hs-var">name</span></a><span> </span><a href="#local-6989586621679053440"><span class="hs-identifier hs-var">allTvbs</span></a><span> </span><a href="#local-6989586621679053442"><span class="hs-identifier hs-var">dv</span></a><span>
</span><a name="line-306"></a><span>  </span><a name="local-6989586621679053446"><a href="#local-6989586621679053446"><span class="hs-identifier">tyInsRHS</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier">repOptions</span><span> </span><a href="#local-6989586621679053435"><span class="hs-identifier hs-var">opts</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="Generics.Deriving.TH.html#InlineRep"><span class="hs-identifier hs-var">InlineRep</span></a><span>
</span><a name="line-307"></a><span>                 </span><span class="hs-keyword">then</span><span> </span><a href="Generics.Deriving.TH.html#makeRepInline"><span class="hs-identifier hs-var">makeRepInline</span></a><span>   </span><a href="#local-6989586621679053432"><span class="hs-identifier hs-var">gClass</span></a><span> </span><a href="#local-6989586621679053442"><span class="hs-identifier hs-var">dv</span></a><span> </span><a href="#local-6989586621679053438"><span class="hs-identifier hs-var">name</span></a><span> </span><a href="#local-6989586621679053439"><span class="hs-identifier hs-var">isNT</span></a><span> </span><a href="#local-6989586621679053441"><span class="hs-identifier hs-var">cons</span></a><span> </span><a href="#local-6989586621679053444"><span class="hs-identifier hs-var">origTy</span></a><span>
</span><a name="line-308"></a><span>                 </span><span class="hs-keyword">else</span><span> </span><a href="Generics.Deriving.TH.html#makeRepTySynApp"><span class="hs-identifier hs-var">makeRepTySynApp</span></a><span> </span><a href="#local-6989586621679053432"><span class="hs-identifier hs-var">gClass</span></a><span> </span><a href="#local-6989586621679053442"><span class="hs-identifier hs-var">dv</span></a><span> </span><a href="#local-6989586621679053438"><span class="hs-identifier hs-var">name</span></a><span>      </span><a href="#local-6989586621679053441"><span class="hs-identifier hs-var">cons</span></a><span> </span><a href="#local-6989586621679053444"><span class="hs-identifier hs-var">origTy</span></a><span>
</span><a name="line-309"></a><span>
</span><a name="line-310"></a><span>  </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679053447"><a href="#local-6989586621679053447"><span class="hs-identifier">origSigTy</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679053443"><span class="hs-identifier hs-var">useKindSigs</span></a><span>
</span><a name="line-311"></a><span>                     </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier hs-var">SigT</span><span> </span><a href="#local-6989586621679053444"><span class="hs-identifier hs-var">origTy</span></a><span> </span><a href="#local-6989586621679053445"><span class="hs-identifier hs-var">origKind</span></a><span>
</span><a name="line-312"></a><span>                     </span><span class="hs-keyword">else</span><span> </span><a href="#local-6989586621679053444"><span class="hs-identifier hs-var">origTy</span></a><span>
</span><a name="line-313"></a><span>      </span><a name="local-6989586621679053448"><a href="#local-6989586621679053448"><span class="hs-identifier">tyIns</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">TySynInstD</span><span> </span><a href="#local-6989586621679053431"><span class="hs-identifier hs-var">repName</span></a><span>
</span><a name="line-314"></a><span class="hs-cpp">#if MIN_VERSION_template_haskell(2,9,0)</span><span>
</span><a name="line-315"></a><span>                         </span><span class="hs-special">(</span><span class="hs-identifier hs-var">TySynEqn</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679053447"><span class="hs-identifier hs-var">origSigTy</span></a><span class="hs-special">]</span><span> </span><a href="#local-6989586621679053446"><span class="hs-identifier hs-var">tyInsRHS</span></a><span class="hs-special">)</span><span>
</span><a name="line-316"></a><span class="hs-cpp">#else</span><span>
</span><a name="line-317"></a><span>                         </span><span class="hs-special">[</span><span class="hs-identifier">origSigTy</span><span class="hs-special">]</span><span> </span><span class="hs-identifier">tyInsRHS</span><span>
</span><a name="line-318"></a><span class="hs-cpp">#endif</span><span>
</span><a name="line-319"></a><span>      </span><a name="local-6989586621679053449"><a href="#local-6989586621679053449"><span class="hs-identifier">mkBody</span></a></a><span> </span><a name="local-6989586621679053452"><a href="#local-6989586621679053452"><span class="hs-identifier">maker</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-var">clause</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">normalB</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Generics.Deriving.TH.html#mkCaseExp"><span class="hs-identifier hs-var">mkCaseExp</span></a><span> </span><a href="#local-6989586621679053432"><span class="hs-identifier hs-var">gClass</span></a><span> </span><a href="#local-6989586621679053438"><span class="hs-identifier hs-var">name</span></a><span> </span><a href="#local-6989586621679053441"><span class="hs-identifier hs-var">cons</span></a><span> </span><a href="#local-6989586621679053452"><span class="hs-identifier hs-var">maker</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a name="line-320"></a><span>      </span><a name="local-6989586621679053450"><a href="#local-6989586621679053450"><span class="hs-identifier">fcs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679053449"><span class="hs-identifier hs-var">mkBody</span></a><span> </span><a href="Generics.Deriving.TH.html#mkFrom"><span class="hs-identifier hs-var">mkFrom</span></a><span>
</span><a name="line-321"></a><span>      </span><a name="local-6989586621679053451"><a href="#local-6989586621679053451"><span class="hs-identifier">tcs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679053449"><span class="hs-identifier hs-var">mkBody</span></a><span> </span><a href="Generics.Deriving.TH.html#mkTo"><span class="hs-identifier hs-var">mkTo</span></a><span>
</span><a name="line-322"></a><span>
</span><a name="line-323"></a><span>  </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">:</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-324"></a><span>    </span><span class="hs-identifier hs-var">instanceD</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">cxt</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">conT</span><span> </span><a href="#local-6989586621679053430"><span class="hs-identifier hs-var">genericName</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">appT</span><span class="hs-special">`</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><a href="#local-6989586621679053447"><span class="hs-identifier hs-var">origSigTy</span></a><span class="hs-special">)</span><span>
</span><a name="line-325"></a><span>                         </span><span class="hs-special">[</span><span class="hs-identifier hs-var">return</span><span> </span><a href="#local-6989586621679053448"><span class="hs-identifier hs-var">tyIns</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">funD</span><span> </span><a href="#local-6989586621679053433"><span class="hs-identifier hs-var">fromName</span></a><span> </span><a href="#local-6989586621679053450"><span class="hs-identifier hs-var">fcs</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">funD</span><span> </span><a href="#local-6989586621679053434"><span class="hs-identifier hs-var">toName</span></a><span> </span><a href="#local-6989586621679053451"><span class="hs-identifier hs-var">tcs</span></a><span class="hs-special">]</span><span>
</span><a name="line-326"></a><span>
</span><a name="line-327"></a><span class="hs-comment">{- $make

There are some data types for which the Template Haskell deriver functions in
this module are not sophisticated enough to infer the correct 'Generic' or
'Generic1' instances. As an example, consider this data type:

@
newtype Fix f a = Fix (f (Fix f a))
@

A proper 'Generic1' instance would look like this:

@
instance Functor f =&gt; Generic1 (Fix f) where ...
@

Unfortunately, 'deriveRepresentable1' cannot infer the @Functor f@ constraint.
One can still define a 'Generic1' instance for @Fix@, however, by using the
functions in this module that are prefixed with @make@-. For example:

@
$('deriveMeta' ''Fix)
$('deriveRep1' ''Fix)
instance Functor f =&gt; Generic1 (Fix f) where
  type Rep1 (Fix f) = $('makeRep1Inline' ''Fix [t| Fix f |])
  from1 = $('makeFrom1' ''Fix)
  to1   = $('makeTo1'   ''Fix)
@

Note that due to the lack of type-level lambdas in Haskell, one must manually
apply @'makeRep1Inline' ''Fix@ to the type @Fix f@.

Be aware that there is a bug on GHC 7.0, 7.2, and 7.4 which might prevent you from
using 'makeRep0Inline' and 'makeRep1Inline'. In the @Fix@ example above, you
would experience the following error:

@
    Kinded thing `f' used as a type
    In the Template Haskell quotation [t| Fix f |]
@

Then a workaround is to use 'makeRep1' instead, which requires you to:

1. Invoke 'deriveRep1' beforehand

2. Pass as arguments the type variables that occur in the instance, in order
   from left to right, topologically sorted, excluding duplicates. (Normally,
   'makeRep1Inline' would figure this out for you.)

Using the above example:

@
$('deriveMeta' ''Fix)
$('deriveRep1' ''Fix)
instance Functor f =&gt; Generic1 (Fix f) where
  type Rep1 (Fix f) = $('makeRep1' ''Fix) f
  from1 = $('makeFrom1' ''Fix)
  to1   = $('makeTo1'   ''Fix)
@

On GHC 7.4, you might encounter more complicated examples involving data
families. For instance:

@
data family Fix a b c d
newtype instance Fix b (f c) (g b) a = Fix (f (Fix b (f c) (g b) a))

$('deriveMeta' ''Fix)
$('deriveRep1' ''Fix)
instance Functor f =&gt; Generic1 (Fix b (f c) (g b)) where
  type Rep1 (Fix b (f c) (g b)) = $('makeRep1' 'Fix) b f c g
  from1 = $('makeFrom1' 'Fix)
  to1   = $('makeTo1'   'Fix)
@

Note that you don't pass @b@ twice, only once.
-}</span><span>
</span><a name="line-404"></a><span>
</span><a name="line-405"></a><span class="hs-comment">-- | Generates the full 'Rep' type inline. Since this type can be quite</span><span>
</span><a name="line-406"></a><span class="hs-comment">-- large, it is recommended you only use this to define 'Rep', e.g.,</span><span>
</span><a name="line-407"></a><span class="hs-comment">--</span><span>
</span><a name="line-408"></a><span class="hs-comment">-- @</span><span>
</span><a name="line-409"></a><span class="hs-comment">-- type Rep (Foo (a :: k) b) = $('makeRep0Inline' ''Foo [t| Foo (a :: k) b |])</span><span>
</span><a name="line-410"></a><span class="hs-comment">-- @</span><span>
</span><a name="line-411"></a><span class="hs-comment">--</span><span>
</span><a name="line-412"></a><span class="hs-comment">-- You can then simply refer to @Rep (Foo a b)@ elsewhere.</span><span>
</span><a name="line-413"></a><span class="hs-comment">--</span><span>
</span><a name="line-414"></a><span class="hs-comment">-- Note that the type passed as an argument to 'makeRep0Inline' must match the</span><span>
</span><a name="line-415"></a><span class="hs-comment">-- type argument of 'Rep' exactly, even up to including the explicit kind</span><span>
</span><a name="line-416"></a><span class="hs-comment">-- signature on @a@. This is due to a limitation of Template Haskell&#8212;without</span><span>
</span><a name="line-417"></a><span class="hs-comment">-- the kind signature, 'makeRep0Inline' has no way of figuring out the kind of</span><span>
</span><a name="line-418"></a><span class="hs-comment">-- @a@, and the generated type might be completely wrong as a result!</span><span>
</span><a name="line-419"></a><span class="hs-identifier">makeRep0Inline</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Q</span><span> </span><span class="hs-identifier hs-type">Type</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Q</span><span> </span><span class="hs-identifier hs-type">Type</span><span>
</span><a name="line-420"></a><a name="makeRep0Inline"><a href="Generics.Deriving.TH.html#makeRep0Inline"><span class="hs-identifier">makeRep0Inline</span></a></a><span> </span><a name="local-6989586621679053453"><a href="#local-6989586621679053453"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Generics.Deriving.TH.html#makeRepCommon"><span class="hs-identifier hs-var">makeRepCommon</span></a><span> </span><a href="Generics.Deriving.TH.Internal.html#Generic"><span class="hs-identifier hs-var">Generic</span></a><span> </span><a href="Generics.Deriving.TH.html#InlineRep"><span class="hs-identifier hs-var">InlineRep</span></a><span> </span><a href="#local-6989586621679053453"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">Just</span><span>
</span><a name="line-421"></a><span>
</span><a name="line-422"></a><span class="hs-comment">-- | Generates the full 'Rep1' type inline. Since this type can be quite</span><span>
</span><a name="line-423"></a><span class="hs-comment">-- large, it is recommended you only use this to define 'Rep1', e.g.,</span><span>
</span><a name="line-424"></a><span class="hs-comment">--</span><span>
</span><a name="line-425"></a><span class="hs-comment">-- @</span><span>
</span><a name="line-426"></a><span class="hs-comment">-- type Rep1 (Foo (a :: k)) = $('makeRep0Inline' ''Foo [t| Foo (a :: k) |])</span><span>
</span><a name="line-427"></a><span class="hs-comment">-- @</span><span>
</span><a name="line-428"></a><span class="hs-comment">--</span><span>
</span><a name="line-429"></a><span class="hs-comment">-- You can then simply refer to @Rep1 (Foo a)@ elsewhere.</span><span>
</span><a name="line-430"></a><span class="hs-comment">--</span><span>
</span><a name="line-431"></a><span class="hs-comment">-- Note that the type passed as an argument to 'makeRep1Inline' must match the</span><span>
</span><a name="line-432"></a><span class="hs-comment">-- type argument of 'Rep1' exactly, even up to including the explicit kind</span><span>
</span><a name="line-433"></a><span class="hs-comment">-- signature on @a@. This is due to a limitation of Template Haskell&#8212;without</span><span>
</span><a name="line-434"></a><span class="hs-comment">-- the kind signature, 'makeRep1Inline' has no way of figuring out the kind of</span><span>
</span><a name="line-435"></a><span class="hs-comment">-- @a@, and the generated type might be completely wrong as a result!</span><span>
</span><a name="line-436"></a><span class="hs-identifier">makeRep1Inline</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Q</span><span> </span><span class="hs-identifier hs-type">Type</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Q</span><span> </span><span class="hs-identifier hs-type">Type</span><span>
</span><a name="line-437"></a><a name="makeRep1Inline"><a href="Generics.Deriving.TH.html#makeRep1Inline"><span class="hs-identifier">makeRep1Inline</span></a></a><span> </span><a name="local-6989586621679053454"><a href="#local-6989586621679053454"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Generics.Deriving.TH.html#makeRepCommon"><span class="hs-identifier hs-var">makeRepCommon</span></a><span> </span><a href="Generics.Deriving.TH.Internal.html#Generic1"><span class="hs-identifier hs-var">Generic1</span></a><span> </span><a href="Generics.Deriving.TH.html#InlineRep"><span class="hs-identifier hs-var">InlineRep</span></a><span> </span><a href="#local-6989586621679053454"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">Just</span><span>
</span><a name="line-438"></a><span>
</span><a name="line-439"></a><span class="hs-comment">-- | Generates the 'Rep' type synonym constructor (as opposed to 'deriveRep0',</span><span>
</span><a name="line-440"></a><span class="hs-comment">-- which generates the type synonym declaration). After splicing it into</span><span>
</span><a name="line-441"></a><span class="hs-comment">-- Haskell source, it expects types as arguments. For example:</span><span>
</span><a name="line-442"></a><span class="hs-comment">--</span><span>
</span><a name="line-443"></a><span class="hs-comment">-- @</span><span>
</span><a name="line-444"></a><span class="hs-comment">-- type Rep (Foo a b) = $('makeRep0' ''Foo) a b</span><span>
</span><a name="line-445"></a><span class="hs-comment">-- @</span><span>
</span><a name="line-446"></a><span class="hs-comment">--</span><span>
</span><a name="line-447"></a><span class="hs-comment">-- The use of 'makeRep0' is generally discouraged, as it can sometimes be</span><span>
</span><a name="line-448"></a><span class="hs-comment">-- difficult to predict the order in which you are expected to pass type</span><span>
</span><a name="line-449"></a><span class="hs-comment">-- variables. As a result, 'makeRep0Inline' is recommended instead. However,</span><span>
</span><a name="line-450"></a><span class="hs-comment">-- 'makeRep0Inline' is not usable on GHC 7.0, 7.2, or 7.4 due to a GHC bug,</span><span>
</span><a name="line-451"></a><span class="hs-comment">-- so 'makeRep0' still exists for GHC 7.0, 7.2, and 7.4 users.</span><span>
</span><a name="line-452"></a><span class="hs-identifier">makeRep0</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Q</span><span> </span><span class="hs-identifier hs-type">Type</span><span>
</span><a name="line-453"></a><a name="makeRep0"><a href="Generics.Deriving.TH.html#makeRep0"><span class="hs-identifier">makeRep0</span></a></a><span> </span><a name="local-6989586621679053455"><a href="#local-6989586621679053455"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Generics.Deriving.TH.html#makeRepCommon"><span class="hs-identifier hs-var">makeRepCommon</span></a><span> </span><a href="Generics.Deriving.TH.Internal.html#Generic"><span class="hs-identifier hs-var">Generic</span></a><span> </span><a href="Generics.Deriving.TH.html#TypeSynonymRep"><span class="hs-identifier hs-var">TypeSynonymRep</span></a><span> </span><a href="#local-6989586621679053455"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-454"></a><span>
</span><a name="line-455"></a><span class="hs-comment">-- | Generates the 'Rep1' type synonym constructor (as opposed to 'deriveRep1',</span><span>
</span><a name="line-456"></a><span class="hs-comment">-- which generates the type synonym declaration). After splicing it into</span><span>
</span><a name="line-457"></a><span class="hs-comment">-- Haskell source, it expects types as arguments. For example:</span><span>
</span><a name="line-458"></a><span class="hs-comment">--</span><span>
</span><a name="line-459"></a><span class="hs-comment">-- @</span><span>
</span><a name="line-460"></a><span class="hs-comment">-- type Rep1 (Foo a) = $('makeRep1' ''Foo) a</span><span>
</span><a name="line-461"></a><span class="hs-comment">-- @</span><span>
</span><a name="line-462"></a><span class="hs-comment">--</span><span>
</span><a name="line-463"></a><span class="hs-comment">-- The use of 'makeRep1' is generally discouraged, as it can sometimes be</span><span>
</span><a name="line-464"></a><span class="hs-comment">-- difficult to predict the order in which you are expected to pass type</span><span>
</span><a name="line-465"></a><span class="hs-comment">-- variables. As a result, 'makeRep1Inline' is recommended instead. However,</span><span>
</span><a name="line-466"></a><span class="hs-comment">-- 'makeRep1Inline' is not usable on GHC 7.0, 7.2, or 7.4 due to a GHC bug,</span><span>
</span><a name="line-467"></a><span class="hs-comment">-- so 'makeRep1' still exists for GHC 7.0, 7.2, and 7.4 users.</span><span>
</span><a name="line-468"></a><span class="hs-identifier">makeRep1</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Q</span><span> </span><span class="hs-identifier hs-type">Type</span><span>
</span><a name="line-469"></a><a name="makeRep1"><a href="Generics.Deriving.TH.html#makeRep1"><span class="hs-identifier">makeRep1</span></a></a><span> </span><a name="local-6989586621679053456"><a href="#local-6989586621679053456"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Generics.Deriving.TH.html#makeRepCommon"><span class="hs-identifier hs-var">makeRepCommon</span></a><span> </span><a href="Generics.Deriving.TH.Internal.html#Generic1"><span class="hs-identifier hs-var">Generic1</span></a><span> </span><a href="Generics.Deriving.TH.html#TypeSynonymRep"><span class="hs-identifier hs-var">TypeSynonymRep</span></a><span> </span><a href="#local-6989586621679053456"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-470"></a><span>
</span><a name="line-471"></a><span class="hs-comment">-- | Generates the 'Rep' type synonym constructor (as opposed to 'deriveRep0',</span><span>
</span><a name="line-472"></a><span class="hs-comment">-- which generates the type synonym declaration) applied to its type arguments.</span><span>
</span><a name="line-473"></a><span class="hs-comment">-- Unlike 'makeRep0', this also takes a quoted 'Type' as an argument, e.g.,</span><span>
</span><a name="line-474"></a><span class="hs-comment">--</span><span>
</span><a name="line-475"></a><span class="hs-comment">-- @</span><span>
</span><a name="line-476"></a><span class="hs-comment">-- type Rep (Foo (a :: k) b) = $('makeRep0FromType' ''Foo [t| Foo (a :: k) b |])</span><span>
</span><a name="line-477"></a><span class="hs-comment">-- @</span><span>
</span><a name="line-478"></a><span class="hs-comment">--</span><span>
</span><a name="line-479"></a><span class="hs-comment">-- Note that the type passed as an argument to 'makeRep0FromType' must match the</span><span>
</span><a name="line-480"></a><span class="hs-comment">-- type argument of 'Rep' exactly, even up to including the explicit kind</span><span>
</span><a name="line-481"></a><span class="hs-comment">-- signature on @a@. This is due to a limitation of Template Haskell&#8212;without</span><span>
</span><a name="line-482"></a><span class="hs-comment">-- the kind signature, 'makeRep0FromType' has no way of figuring out the kind of</span><span>
</span><a name="line-483"></a><span class="hs-comment">-- @a@, and the generated type might be completely wrong as a result!</span><span>
</span><a name="line-484"></a><span class="hs-comment">--</span><span>
</span><a name="line-485"></a><span class="hs-comment">-- The use of 'makeRep0FromType' is generally discouraged, since 'makeRep0Inline'</span><span>
</span><a name="line-486"></a><span class="hs-comment">-- does exactly the same thing but without having to go through an intermediate</span><span>
</span><a name="line-487"></a><span class="hs-comment">-- type synonym, and as a result, 'makeRep0Inline' tends to be less buggy.</span><span>
</span><a name="line-488"></a><span class="hs-identifier">makeRep0FromType</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Q</span><span> </span><span class="hs-identifier hs-type">Type</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Q</span><span> </span><span class="hs-identifier hs-type">Type</span><span>
</span><a name="line-489"></a><a name="makeRep0FromType"><a href="Generics.Deriving.TH.html#makeRep0FromType"><span class="hs-identifier">makeRep0FromType</span></a></a><span> </span><a name="local-6989586621679053457"><a href="#local-6989586621679053457"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Generics.Deriving.TH.html#makeRepCommon"><span class="hs-identifier hs-var">makeRepCommon</span></a><span> </span><a href="Generics.Deriving.TH.Internal.html#Generic"><span class="hs-identifier hs-var">Generic</span></a><span> </span><a href="Generics.Deriving.TH.html#TypeSynonymRep"><span class="hs-identifier hs-var">TypeSynonymRep</span></a><span> </span><a href="#local-6989586621679053457"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">Just</span><span>
</span><a name="line-490"></a><span>
</span><a name="line-491"></a><span class="hs-comment">-- | Generates the 'Rep1' type synonym constructor (as opposed to 'deriveRep1',</span><span>
</span><a name="line-492"></a><span class="hs-comment">-- which generates the type synonym declaration) applied to its type arguments.</span><span>
</span><a name="line-493"></a><span class="hs-comment">-- Unlike 'makeRep1', this also takes a quoted 'Type' as an argument, e.g.,</span><span>
</span><a name="line-494"></a><span class="hs-comment">--</span><span>
</span><a name="line-495"></a><span class="hs-comment">-- @</span><span>
</span><a name="line-496"></a><span class="hs-comment">-- type Rep1 (Foo (a :: k)) = $('makeRep1FromType' ''Foo [t| Foo (a :: k) |])</span><span>
</span><a name="line-497"></a><span class="hs-comment">-- @</span><span>
</span><a name="line-498"></a><span class="hs-comment">--</span><span>
</span><a name="line-499"></a><span class="hs-comment">-- Note that the type passed as an argument to 'makeRep1FromType' must match the</span><span>
</span><a name="line-500"></a><span class="hs-comment">-- type argument of 'Rep' exactly, even up to including the explicit kind</span><span>
</span><a name="line-501"></a><span class="hs-comment">-- signature on @a@. This is due to a limitation of Template Haskell&#8212;without</span><span>
</span><a name="line-502"></a><span class="hs-comment">-- the kind signature, 'makeRep1FromType' has no way of figuring out the kind of</span><span>
</span><a name="line-503"></a><span class="hs-comment">-- @a@, and the generated type might be completely wrong as a result!</span><span>
</span><a name="line-504"></a><span class="hs-comment">--</span><span>
</span><a name="line-505"></a><span class="hs-comment">-- The use of 'makeRep1FromType' is generally discouraged, since 'makeRep1Inline'</span><span>
</span><a name="line-506"></a><span class="hs-comment">-- does exactly the same thing but without having to go through an intermediate</span><span>
</span><a name="line-507"></a><span class="hs-comment">-- type synonym, and as a result, 'makeRep1Inline' tends to be less buggy.</span><span>
</span><a name="line-508"></a><span class="hs-identifier">makeRep1FromType</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Q</span><span> </span><span class="hs-identifier hs-type">Type</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Q</span><span> </span><span class="hs-identifier hs-type">Type</span><span>
</span><a name="line-509"></a><a name="makeRep1FromType"><a href="Generics.Deriving.TH.html#makeRep1FromType"><span class="hs-identifier">makeRep1FromType</span></a></a><span> </span><a name="local-6989586621679053458"><a href="#local-6989586621679053458"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Generics.Deriving.TH.html#makeRepCommon"><span class="hs-identifier hs-var">makeRepCommon</span></a><span> </span><a href="Generics.Deriving.TH.Internal.html#Generic1"><span class="hs-identifier hs-var">Generic1</span></a><span> </span><a href="Generics.Deriving.TH.html#TypeSynonymRep"><span class="hs-identifier hs-var">TypeSynonymRep</span></a><span> </span><a href="#local-6989586621679053458"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">Just</span><span>
</span><a name="line-510"></a><span>
</span><a name="line-511"></a><span class="hs-identifier">makeRepCommon</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Generics.Deriving.TH.Internal.html#GenericClass"><span class="hs-identifier hs-type">GenericClass</span></a><span>
</span><a name="line-512"></a><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Generics.Deriving.TH.html#RepOptions"><span class="hs-identifier hs-type">RepOptions</span></a><span>
</span><a name="line-513"></a><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Name</span><span>
</span><a name="line-514"></a><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Q</span><span> </span><span class="hs-identifier hs-type">Type</span><span class="hs-special">)</span><span>
</span><a name="line-515"></a><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Q</span><span> </span><span class="hs-identifier hs-type">Type</span><span>
</span><a name="line-516"></a><a name="makeRepCommon"><a href="Generics.Deriving.TH.html#makeRepCommon"><span class="hs-identifier">makeRepCommon</span></a></a><span> </span><a name="local-6989586621679053459"><a href="#local-6989586621679053459"><span class="hs-identifier">gClass</span></a></a><span> </span><a name="local-6989586621679053460"><a href="#local-6989586621679053460"><span class="hs-identifier">repOpts</span></a></a><span> </span><a name="local-6989586621679053461"><a href="#local-6989586621679053461"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621679053462"><a href="#local-6989586621679053462"><span class="hs-identifier">mbQTy</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-517"></a><span>  </span><a name="local-6989586621679053463"><a href="#local-6989586621679053463"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Generics.Deriving.TH.Internal.html#reifyDataInfo"><span class="hs-identifier hs-var">reifyDataInfo</span></a><span> </span><a href="#local-6989586621679053461"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-518"></a><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679053464"><a href="#local-6989586621679053464"><span class="hs-identifier">name</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679053465"><a href="#local-6989586621679053465"><span class="hs-identifier">isNT</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679053466"><a href="#local-6989586621679053466"><span class="hs-identifier">declTvbs</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679053467"><a href="#local-6989586621679053467"><span class="hs-identifier">cons</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679053468"><a href="#local-6989586621679053468"><span class="hs-identifier">dv</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">either</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-identifier hs-var">id</span><span> </span><a href="#local-6989586621679053463"><span class="hs-identifier hs-var">i</span></a><span>
</span><a name="line-519"></a><span>  </span><span class="hs-comment">-- See Note [Forcing buildTypeInstance]</span><span>
</span><a name="line-520"></a><span>  </span><span class="hs-glyph">!</span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Generics.Deriving.TH.html#buildTypeInstance"><span class="hs-identifier hs-var">buildTypeInstance</span></a><span> </span><a href="#local-6989586621679053459"><span class="hs-identifier hs-var">gClass</span></a><span> </span><span class="hs-identifier hs-var">False</span><span> </span><a href="#local-6989586621679053464"><span class="hs-identifier hs-var">name</span></a><span> </span><a href="#local-6989586621679053466"><span class="hs-identifier hs-var">declTvbs</span></a><span> </span><a href="#local-6989586621679053468"><span class="hs-identifier hs-var">dv</span></a><span>
</span><a name="line-521"></a><span>
</span><a name="line-522"></a><span>  </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679053462"><span class="hs-identifier hs-var">mbQTy</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679053460"><span class="hs-identifier hs-var">repOpts</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-523"></a><span>       </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679053469"><a href="#local-6989586621679053469"><span class="hs-identifier">qTy</span></a></a><span class="hs-special">,</span><span> </span><a href="Generics.Deriving.TH.html#TypeSynonymRep"><span class="hs-identifier hs-var">TypeSynonymRep</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679053469"><span class="hs-identifier hs-var">qTy</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><a href="Generics.Deriving.TH.html#makeRepTySynApp"><span class="hs-identifier hs-var">makeRepTySynApp</span></a><span> </span><a href="#local-6989586621679053459"><span class="hs-identifier hs-var">gClass</span></a><span> </span><a href="#local-6989586621679053468"><span class="hs-identifier hs-var">dv</span></a><span> </span><a href="#local-6989586621679053464"><span class="hs-identifier hs-var">name</span></a><span> </span><a href="#local-6989586621679053467"><span class="hs-identifier hs-var">cons</span></a><span>
</span><a name="line-524"></a><span>       </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679053470"><a href="#local-6989586621679053470"><span class="hs-identifier">qTy</span></a></a><span class="hs-special">,</span><span> </span><a href="Generics.Deriving.TH.html#InlineRep"><span class="hs-identifier hs-var">InlineRep</span></a><span class="hs-special">)</span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679053470"><span class="hs-identifier hs-var">qTy</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><a href="Generics.Deriving.TH.html#makeRepInline"><span class="hs-identifier hs-var">makeRepInline</span></a><span>   </span><a href="#local-6989586621679053459"><span class="hs-identifier hs-var">gClass</span></a><span> </span><a href="#local-6989586621679053468"><span class="hs-identifier hs-var">dv</span></a><span> </span><a href="#local-6989586621679053464"><span class="hs-identifier hs-var">name</span></a><span> </span><a href="#local-6989586621679053465"><span class="hs-identifier hs-var">isNT</span></a><span> </span><a href="#local-6989586621679053467"><span class="hs-identifier hs-var">cons</span></a><span>
</span><a name="line-525"></a><span>       </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Nothing</span><span class="hs-special">,</span><span>  </span><a href="Generics.Deriving.TH.html#TypeSynonymRep"><span class="hs-identifier hs-var">TypeSynonymRep</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">conT</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Generics.Deriving.TH.html#genRepName"><span class="hs-identifier hs-var">genRepName</span></a><span> </span><a href="#local-6989586621679053459"><span class="hs-identifier hs-var">gClass</span></a><span> </span><a href="#local-6989586621679053468"><span class="hs-identifier hs-var">dv</span></a><span> </span><a href="#local-6989586621679053464"><span class="hs-identifier hs-var">name</span></a><span>
</span><a name="line-526"></a><span>       </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Nothing</span><span class="hs-special">,</span><span>  </span><a href="Generics.Deriving.TH.html#InlineRep"><span class="hs-identifier hs-var">InlineRep</span></a><span class="hs-special">)</span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">fail</span><span> </span><span class="hs-string">&quot;makeRepCommon&quot;</span><span>
</span><a name="line-527"></a><span>
</span><a name="line-528"></a><span class="hs-identifier">makeRepInline</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Generics.Deriving.TH.Internal.html#GenericClass"><span class="hs-identifier hs-type">GenericClass</span></a><span>
</span><a name="line-529"></a><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Generics.Deriving.TH.Internal.html#DataVariety"><span class="hs-identifier hs-type">DataVariety</span></a><span>
</span><a name="line-530"></a><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Name</span><span>
</span><a name="line-531"></a><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-532"></a><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Con</span><span class="hs-special">]</span><span>
</span><a name="line-533"></a><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Type</span><span>
</span><a name="line-534"></a><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Q</span><span> </span><span class="hs-identifier hs-type">Type</span><span>
</span><a name="line-535"></a><a name="makeRepInline"><a href="Generics.Deriving.TH.html#makeRepInline"><span class="hs-identifier">makeRepInline</span></a></a><span> </span><a name="local-6989586621679053471"><a href="#local-6989586621679053471"><span class="hs-identifier">gClass</span></a></a><span> </span><a name="local-6989586621679053472"><a href="#local-6989586621679053472"><span class="hs-identifier">dv</span></a></a><span> </span><a name="local-6989586621679053473"><a href="#local-6989586621679053473"><span class="hs-identifier">name</span></a></a><span> </span><a name="local-6989586621679053474"><a href="#local-6989586621679053474"><span class="hs-identifier">isNT</span></a></a><span> </span><a name="local-6989586621679053475"><a href="#local-6989586621679053475"><span class="hs-identifier">cons</span></a></a><span> </span><a name="local-6989586621679053476"><a href="#local-6989586621679053476"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-536"></a><span>  </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679053477"><a href="#local-6989586621679053477"><span class="hs-identifier">instVars</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><a href="Generics.Deriving.TH.Internal.html#tyVarBndrToType"><span class="hs-identifier hs-var">tyVarBndrToType</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Generics.Deriving.TH.Internal.html#requiredTyVarsOfType"><span class="hs-identifier hs-var">requiredTyVarsOfType</span></a><span> </span><a href="#local-6989586621679053476"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-537"></a><span>  </span><a href="Generics.Deriving.TH.html#repType"><span class="hs-identifier hs-var">repType</span></a><span> </span><a href="#local-6989586621679053471"><span class="hs-identifier hs-var">gClass</span></a><span> </span><a href="#local-6989586621679053472"><span class="hs-identifier hs-var">dv</span></a><span> </span><a href="#local-6989586621679053473"><span class="hs-identifier hs-var">name</span></a><span> </span><a href="#local-6989586621679053474"><span class="hs-identifier hs-var">isNT</span></a><span> </span><a href="#local-6989586621679053475"><span class="hs-identifier hs-var">cons</span></a><span> </span><a href="#local-6989586621679053477"><span class="hs-identifier hs-var">instVars</span></a><span>
</span><a name="line-538"></a><span>
</span><a name="line-539"></a><span class="hs-identifier">makeRepTySynApp</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Generics.Deriving.TH.Internal.html#GenericClass"><span class="hs-identifier hs-type">GenericClass</span></a><span>
</span><a name="line-540"></a><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Generics.Deriving.TH.Internal.html#DataVariety"><span class="hs-identifier hs-type">DataVariety</span></a><span>
</span><a name="line-541"></a><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Name</span><span>
</span><a name="line-542"></a><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Con</span><span class="hs-special">]</span><span>
</span><a name="line-543"></a><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Type</span><span>
</span><a name="line-544"></a><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Q</span><span> </span><span class="hs-identifier hs-type">Type</span><span>
</span><a name="line-545"></a><a name="makeRepTySynApp"><a href="Generics.Deriving.TH.html#makeRepTySynApp"><span class="hs-identifier">makeRepTySynApp</span></a></a><span> </span><a name="local-6989586621679053478"><a href="#local-6989586621679053478"><span class="hs-identifier">gClass</span></a></a><span> </span><a name="local-6989586621679053479"><a href="#local-6989586621679053479"><span class="hs-identifier">dv</span></a></a><span> </span><a name="local-6989586621679053480"><a href="#local-6989586621679053480"><span class="hs-identifier">name</span></a></a><span> </span><a name="local-6989586621679053481"><a href="#local-6989586621679053481"><span class="hs-identifier">cons</span></a></a><span> </span><a name="local-6989586621679053482"><a href="#local-6989586621679053482"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-546"></a><span>  </span><span class="hs-comment">-- Here, we figure out the distinct type variables (in order from left-to-right)</span><span>
</span><a name="line-547"></a><span>  </span><span class="hs-comment">-- of the LHS of the Rep(1) instance. We call unKindedTV because the kind</span><span>
</span><a name="line-548"></a><span>  </span><span class="hs-comment">-- inferencer can figure out the kinds perfectly well, so we don't need to</span><span>
</span><a name="line-549"></a><span>  </span><span class="hs-comment">-- give anything here explicit kind signatures.</span><span>
</span><a name="line-550"></a><span>  </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679053483"><a href="#local-6989586621679053483"><span class="hs-identifier">instTvbs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><a href="Generics.Deriving.TH.Internal.html#unKindedTV"><span class="hs-identifier hs-var">unKindedTV</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Generics.Deriving.TH.Internal.html#requiredTyVarsOfType"><span class="hs-identifier hs-var">requiredTyVarsOfType</span></a><span> </span><a href="#local-6989586621679053482"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-551"></a><span>  </span><span class="hs-comment">-- We grab the type variables from the first constructor's type signature.</span><span>
</span><a name="line-552"></a><span>  </span><span class="hs-comment">-- Or, if there are no constructors, we grab no type variables. The latter</span><span>
</span><a name="line-553"></a><span>  </span><span class="hs-comment">-- is okay because we use zipWith to ensure that we never pass more type</span><span>
</span><a name="line-554"></a><span>  </span><span class="hs-comment">-- variables than the generated type synonym can accept.</span><span>
</span><a name="line-555"></a><span>  </span><span class="hs-comment">-- See Note [Arguments to generated type synonyms]</span><span>
</span><a name="line-556"></a><span>  </span><a name="local-6989586621679053484"><a href="#local-6989586621679053484"><span class="hs-identifier">tySynVars</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Generics.Deriving.TH.html#grabTyVarsFromCons"><span class="hs-identifier hs-var">grabTyVarsFromCons</span></a><span> </span><a href="#local-6989586621679053478"><span class="hs-identifier hs-var">gClass</span></a><span> </span><a href="#local-6989586621679053481"><span class="hs-identifier hs-var">cons</span></a><span>
</span><a name="line-557"></a><span>  </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Generics.Deriving.TH.Internal.html#applyTyToTvbs"><span class="hs-identifier hs-var">applyTyToTvbs</span></a><span> </span><span class="hs-special">(</span><a href="Generics.Deriving.TH.html#genRepName"><span class="hs-identifier hs-var">genRepName</span></a><span> </span><a href="#local-6989586621679053478"><span class="hs-identifier hs-var">gClass</span></a><span> </span><a href="#local-6989586621679053479"><span class="hs-identifier hs-var">dv</span></a><span> </span><a href="#local-6989586621679053480"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">)</span><span>
</span><a name="line-558"></a><span>         </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">zipWith</span><span> </span><span class="hs-identifier hs-var">const</span><span> </span><a href="#local-6989586621679053483"><span class="hs-identifier hs-var">instTvbs</span></a><span> </span><a href="#local-6989586621679053484"><span class="hs-identifier hs-var">tySynVars</span></a><span>
</span><a name="line-559"></a><span>
</span><a name="line-560"></a><span class="hs-comment">-- | A backwards-compatible synonym for 'makeFrom0'.</span><span>
</span><a name="line-561"></a><span class="hs-identifier">makeFrom</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Q</span><span> </span><span class="hs-identifier hs-type">Exp</span><span>
</span><a name="line-562"></a><a name="makeFrom"><a href="Generics.Deriving.TH.html#makeFrom"><span class="hs-identifier">makeFrom</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Generics.Deriving.TH.html#makeFrom0"><span class="hs-identifier hs-var">makeFrom0</span></a><span>
</span><a name="line-563"></a><span>
</span><a name="line-564"></a><span class="hs-comment">-- | Generates a lambda expression which behaves like 'from'.</span><span>
</span><a name="line-565"></a><span class="hs-identifier">makeFrom0</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Q</span><span> </span><span class="hs-identifier hs-type">Exp</span><span>
</span><a name="line-566"></a><a name="makeFrom0"><a href="Generics.Deriving.TH.html#makeFrom0"><span class="hs-identifier">makeFrom0</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Generics.Deriving.TH.html#makeFunCommon"><span class="hs-identifier hs-var">makeFunCommon</span></a><span> </span><a href="Generics.Deriving.TH.html#mkFrom"><span class="hs-identifier hs-var">mkFrom</span></a><span> </span><a href="Generics.Deriving.TH.Internal.html#Generic"><span class="hs-identifier hs-var">Generic</span></a><span>
</span><a name="line-567"></a><span>
</span><a name="line-568"></a><span class="hs-comment">-- | A backwards-compatible synonym for 'makeTo0'.</span><span>
</span><a name="line-569"></a><span class="hs-identifier">makeTo</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Q</span><span> </span><span class="hs-identifier hs-type">Exp</span><span>
</span><a name="line-570"></a><a name="makeTo"><a href="Generics.Deriving.TH.html#makeTo"><span class="hs-identifier">makeTo</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Generics.Deriving.TH.html#makeTo0"><span class="hs-identifier hs-var">makeTo0</span></a><span>
</span><a name="line-571"></a><span>
</span><a name="line-572"></a><span class="hs-comment">-- | Generates a lambda expression which behaves like 'to'.</span><span>
</span><a name="line-573"></a><span class="hs-identifier">makeTo0</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Q</span><span> </span><span class="hs-identifier hs-type">Exp</span><span>
</span><a name="line-574"></a><a name="makeTo0"><a href="Generics.Deriving.TH.html#makeTo0"><span class="hs-identifier">makeTo0</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Generics.Deriving.TH.html#makeFunCommon"><span class="hs-identifier hs-var">makeFunCommon</span></a><span> </span><a href="Generics.Deriving.TH.html#mkTo"><span class="hs-identifier hs-var">mkTo</span></a><span> </span><a href="Generics.Deriving.TH.Internal.html#Generic"><span class="hs-identifier hs-var">Generic</span></a><span>
</span><a name="line-575"></a><span>
</span><a name="line-576"></a><span class="hs-comment">-- | Generates a lambda expression which behaves like 'from1'.</span><span>
</span><a name="line-577"></a><span class="hs-identifier">makeFrom1</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Q</span><span> </span><span class="hs-identifier hs-type">Exp</span><span>
</span><a name="line-578"></a><a name="makeFrom1"><a href="Generics.Deriving.TH.html#makeFrom1"><span class="hs-identifier">makeFrom1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Generics.Deriving.TH.html#makeFunCommon"><span class="hs-identifier hs-var">makeFunCommon</span></a><span> </span><a href="Generics.Deriving.TH.html#mkFrom"><span class="hs-identifier hs-var">mkFrom</span></a><span> </span><a href="Generics.Deriving.TH.Internal.html#Generic1"><span class="hs-identifier hs-var">Generic1</span></a><span>
</span><a name="line-579"></a><span>
</span><a name="line-580"></a><span class="hs-comment">-- | Generates a lambda expression which behaves like 'to1'.</span><span>
</span><a name="line-581"></a><span class="hs-identifier">makeTo1</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Q</span><span> </span><span class="hs-identifier hs-type">Exp</span><span>
</span><a name="line-582"></a><a name="makeTo1"><a href="Generics.Deriving.TH.html#makeTo1"><span class="hs-identifier">makeTo1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Generics.Deriving.TH.html#makeFunCommon"><span class="hs-identifier hs-var">makeFunCommon</span></a><span> </span><a href="Generics.Deriving.TH.html#mkTo"><span class="hs-identifier hs-var">mkTo</span></a><span> </span><a href="Generics.Deriving.TH.Internal.html#Generic1"><span class="hs-identifier hs-var">Generic1</span></a><span>
</span><a name="line-583"></a><span>
</span><a name="line-584"></a><span class="hs-identifier">makeFunCommon</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="Generics.Deriving.TH.Internal.html#GenericClass"><span class="hs-identifier hs-type">GenericClass</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Con</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Q</span><span> </span><span class="hs-identifier hs-type">Match</span><span class="hs-special">)</span><span>
</span><a name="line-585"></a><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Generics.Deriving.TH.Internal.html#GenericClass"><span class="hs-identifier hs-type">GenericClass</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Q</span><span> </span><span class="hs-identifier hs-type">Exp</span><span>
</span><a name="line-586"></a><a name="makeFunCommon"><a href="Generics.Deriving.TH.html#makeFunCommon"><span class="hs-identifier">makeFunCommon</span></a></a><span> </span><a name="local-6989586621679053485"><a href="#local-6989586621679053485"><span class="hs-identifier">maker</span></a></a><span> </span><a name="local-6989586621679053486"><a href="#local-6989586621679053486"><span class="hs-identifier">gClass</span></a></a><span> </span><a name="local-6989586621679053487"><a href="#local-6989586621679053487"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-587"></a><span>  </span><a name="local-6989586621679053488"><a href="#local-6989586621679053488"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Generics.Deriving.TH.Internal.html#reifyDataInfo"><span class="hs-identifier hs-var">reifyDataInfo</span></a><span> </span><a href="#local-6989586621679053487"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-588"></a><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679053489"><a href="#local-6989586621679053489"><span class="hs-identifier">name</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a name="local-6989586621679053490"><a href="#local-6989586621679053490"><span class="hs-identifier">allTvbs</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679053491"><a href="#local-6989586621679053491"><span class="hs-identifier">cons</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679053492"><a href="#local-6989586621679053492"><span class="hs-identifier">dv</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">either</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-identifier hs-var">id</span><span> </span><a href="#local-6989586621679053488"><span class="hs-identifier hs-var">i</span></a><span>
</span><a name="line-589"></a><span>  </span><span class="hs-comment">-- See Note [Forcing buildTypeInstance]</span><span>
</span><a name="line-590"></a><span>  </span><a href="Generics.Deriving.TH.html#buildTypeInstance"><span class="hs-identifier hs-var">buildTypeInstance</span></a><span> </span><a href="#local-6989586621679053486"><span class="hs-identifier hs-var">gClass</span></a><span> </span><span class="hs-identifier hs-var">False</span><span> </span><a href="#local-6989586621679053489"><span class="hs-identifier hs-var">name</span></a><span> </span><a href="#local-6989586621679053490"><span class="hs-identifier hs-var">allTvbs</span></a><span> </span><a href="#local-6989586621679053492"><span class="hs-identifier hs-var">dv</span></a><span>
</span><a name="line-591"></a><span>    </span><span class="hs-special">`</span><span class="hs-identifier hs-var">seq</span><span class="hs-special">`</span><span> </span><a href="Generics.Deriving.TH.html#mkCaseExp"><span class="hs-identifier hs-var">mkCaseExp</span></a><span> </span><a href="#local-6989586621679053486"><span class="hs-identifier hs-var">gClass</span></a><span> </span><a href="#local-6989586621679053489"><span class="hs-identifier hs-var">name</span></a><span> </span><a href="#local-6989586621679053491"><span class="hs-identifier hs-var">cons</span></a><span> </span><a href="#local-6989586621679053485"><span class="hs-identifier hs-var">maker</span></a><span>
</span><a name="line-592"></a><span>
</span><a name="line-593"></a><span class="hs-identifier">genRepName</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Generics.Deriving.TH.Internal.html#GenericClass"><span class="hs-identifier hs-type">GenericClass</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Generics.Deriving.TH.Internal.html#DataVariety"><span class="hs-identifier hs-type">DataVariety</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Name</span><span>
</span><a name="line-594"></a><a name="genRepName"><a href="Generics.Deriving.TH.html#genRepName"><span class="hs-identifier">genRepName</span></a></a><span> </span><a name="local-6989586621679053493"><a href="#local-6989586621679053493"><span class="hs-identifier">gClass</span></a></a><span> </span><a name="local-6989586621679053494"><a href="#local-6989586621679053494"><span class="hs-identifier">dv</span></a></a><span> </span><a name="local-6989586621679053495"><a href="#local-6989586621679053495"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">mkName</span><span>
</span><a name="line-595"></a><span>                      </span><span class="hs-operator hs-var">.</span><span> </span><a href="Generics.Deriving.TH.Internal.html#showsDataVariety"><span class="hs-identifier hs-var">showsDataVariety</span></a><span> </span><a href="#local-6989586621679053494"><span class="hs-identifier hs-var">dv</span></a><span>
</span><a name="line-596"></a><span>                      </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-string">&quot;Rep&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fromEnum</span><span> </span><a href="#local-6989586621679053493"><span class="hs-identifier hs-var">gClass</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">++</span><span class="hs-special">)</span><span>
</span><a name="line-597"></a><span>                      </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="Generics.Deriving.TH.Internal.html#showNameQual"><span class="hs-identifier hs-var">showNameQual</span></a><span> </span><a href="#local-6989586621679053495"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;_&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">++</span><span class="hs-special">)</span><span>
</span><a name="line-598"></a><span>                      </span><span class="hs-operator hs-var">.</span><span> </span><a href="Generics.Deriving.TH.Internal.html#sanitizeName"><span class="hs-identifier hs-var">sanitizeName</span></a><span>
</span><a name="line-599"></a><span>                      </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">nameBase</span><span> </span><a href="#local-6989586621679053495"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-600"></a><span>
</span><a name="line-601"></a><span class="hs-identifier">repType</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Generics.Deriving.TH.Internal.html#GenericClass"><span class="hs-identifier hs-type">GenericClass</span></a><span>
</span><a name="line-602"></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Generics.Deriving.TH.Internal.html#DataVariety"><span class="hs-identifier hs-type">DataVariety</span></a><span>
</span><a name="line-603"></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Name</span><span>
</span><a name="line-604"></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-605"></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Con</span><span class="hs-special">]</span><span>
</span><a name="line-606"></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Type</span><span class="hs-special">]</span><span>
</span><a name="line-607"></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Q</span><span> </span><span class="hs-identifier hs-type">Type</span><span>
</span><a name="line-608"></a><a name="repType"><a href="Generics.Deriving.TH.html#repType"><span class="hs-identifier">repType</span></a></a><span> </span><a name="local-6989586621679053496"><a href="#local-6989586621679053496"><span class="hs-identifier">gClass</span></a></a><span> </span><a name="local-6989586621679053497"><a href="#local-6989586621679053497"><span class="hs-identifier">dv</span></a></a><span> </span><a name="local-6989586621679053498"><a href="#local-6989586621679053498"><span class="hs-identifier">dt</span></a></a><span> </span><a name="local-6989586621679053499"><a href="#local-6989586621679053499"><span class="hs-identifier">isNT</span></a></a><span> </span><a name="local-6989586621679053500"><a href="#local-6989586621679053500"><span class="hs-identifier">cs</span></a></a><span> </span><a name="local-6989586621679053501"><a href="#local-6989586621679053501"><span class="hs-identifier">tySynVars</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-609"></a><span>    </span><span class="hs-identifier hs-var">conT</span><span> </span><a href="Generics.Deriving.TH.Internal.html#d1TypeName"><span class="hs-identifier hs-var">d1TypeName</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">appT</span><span class="hs-special">`</span><span> </span><a href="Generics.Deriving.TH.Post4_9.html#mkMetaDataType"><span class="hs-identifier hs-var">mkMetaDataType</span></a><span> </span><a href="#local-6989586621679053497"><span class="hs-identifier hs-var">dv</span></a><span> </span><a href="#local-6989586621679053498"><span class="hs-identifier hs-var">dt</span></a><span> </span><a href="#local-6989586621679053499"><span class="hs-identifier hs-var">isNT</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">appT</span><span class="hs-special">`</span><span>
</span><a name="line-610"></a><span>      </span><a href="Generics.Deriving.TH.Internal.html#foldr1%27"><span class="hs-identifier hs-var">foldr1'</span></a><span> </span><a href="#local-6989586621679053502"><span class="hs-identifier hs-var">sum'</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">conT</span><span> </span><a href="Generics.Deriving.TH.Internal.html#v1TypeName"><span class="hs-identifier hs-var">v1TypeName</span></a><span class="hs-special">)</span><span>
</span><a name="line-611"></a><span>        </span><span class="hs-special">(</span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><a href="Generics.Deriving.TH.html#repCon"><span class="hs-identifier hs-var">repCon</span></a><span> </span><a href="#local-6989586621679053496"><span class="hs-identifier hs-var">gClass</span></a><span> </span><a href="#local-6989586621679053497"><span class="hs-identifier hs-var">dv</span></a><span> </span><a href="#local-6989586621679053498"><span class="hs-identifier hs-var">dt</span></a><span> </span><a href="#local-6989586621679053501"><span class="hs-identifier hs-var">tySynVars</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679053500"><span class="hs-identifier hs-var">cs</span></a><span class="hs-special">)</span><span>
</span><a name="line-612"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-613"></a><span>    </span><span class="hs-identifier">sum'</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Q</span><span> </span><span class="hs-identifier hs-type">Type</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Q</span><span> </span><span class="hs-identifier hs-type">Type</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Q</span><span> </span><span class="hs-identifier hs-type">Type</span><span>
</span><a name="line-614"></a><span>    </span><a name="local-6989586621679053502"><a href="#local-6989586621679053502"><span class="hs-identifier">sum'</span></a></a><span> </span><a name="local-6989586621679053503"><a href="#local-6989586621679053503"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679053504"><a href="#local-6989586621679053504"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">conT</span><span> </span><a href="Generics.Deriving.TH.Internal.html#sumTypeName"><span class="hs-identifier hs-var">sumTypeName</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">appT</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621679053503"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">appT</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621679053504"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-615"></a><span>
</span><a name="line-616"></a><span class="hs-identifier">repCon</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Generics.Deriving.TH.Internal.html#GenericClass"><span class="hs-identifier hs-type">GenericClass</span></a><span>
</span><a name="line-617"></a><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Generics.Deriving.TH.Internal.html#DataVariety"><span class="hs-identifier hs-type">DataVariety</span></a><span>
</span><a name="line-618"></a><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Name</span><span>
</span><a name="line-619"></a><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Type</span><span class="hs-special">]</span><span>
</span><a name="line-620"></a><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Con</span><span>
</span><a name="line-621"></a><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Q</span><span> </span><span class="hs-identifier hs-type">Type</span><span>
</span><a name="line-622"></a><a name="repCon"><a href="Generics.Deriving.TH.html#repCon"><span class="hs-identifier">repCon</span></a></a><span> </span><a name="local-6989586621679053505"><a href="#local-6989586621679053505"><span class="hs-identifier">gClass</span></a></a><span> </span><a name="local-6989586621679053506"><a href="#local-6989586621679053506"><span class="hs-identifier">dv</span></a></a><span> </span><a name="local-6989586621679053507"><a href="#local-6989586621679053507"><span class="hs-identifier">dt</span></a></a><span> </span><a name="local-6989586621679053508"><a href="#local-6989586621679053508"><span class="hs-identifier">tySynVars</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">NormalC</span><span> </span><a name="local-6989586621679053509"><a href="#local-6989586621679053509"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621679053510"><a href="#local-6989586621679053510"><span class="hs-identifier">bts</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-623"></a><span>    </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679053511"><a href="#local-6989586621679053511"><span class="hs-identifier">bangs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-identifier hs-var">fst</span><span> </span><a href="#local-6989586621679053510"><span class="hs-identifier hs-var">bts</span></a><span>
</span><a name="line-624"></a><span>    </span><a name="local-6989586621679053523"><a href="#local-6989586621679053523"><span class="hs-identifier">ssis</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Generics.Deriving.TH.Post4_9.html#reifySelStrictInfo"><span class="hs-identifier hs-var">reifySelStrictInfo</span></a><span> </span><a href="#local-6989586621679053509"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621679053511"><span class="hs-identifier hs-var">bangs</span></a><span>
</span><a name="line-625"></a><span>    </span><a href="Generics.Deriving.TH.html#repConWith"><span class="hs-identifier hs-var">repConWith</span></a><span> </span><a href="#local-6989586621679053505"><span class="hs-identifier hs-var">gClass</span></a><span> </span><a href="#local-6989586621679053506"><span class="hs-identifier hs-var">dv</span></a><span> </span><a href="#local-6989586621679053507"><span class="hs-identifier hs-var">dt</span></a><span> </span><a href="#local-6989586621679053509"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621679053508"><span class="hs-identifier hs-var">tySynVars</span></a><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><a href="#local-6989586621679053523"><span class="hs-identifier hs-var">ssis</span></a><span> </span><span class="hs-identifier hs-var">False</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-626"></a><span class="hs-identifier">repCon</span><span> </span><a name="local-6989586621679053524"><a href="#local-6989586621679053524"><span class="hs-identifier">gClass</span></a></a><span> </span><a name="local-6989586621679053525"><a href="#local-6989586621679053525"><span class="hs-identifier">dv</span></a></a><span> </span><a name="local-6989586621679053526"><a href="#local-6989586621679053526"><span class="hs-identifier">dt</span></a></a><span> </span><a name="local-6989586621679053527"><a href="#local-6989586621679053527"><span class="hs-identifier">tySynVars</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">RecC</span><span> </span><a name="local-6989586621679053528"><a href="#local-6989586621679053528"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621679053529"><a href="#local-6989586621679053529"><span class="hs-identifier">vbts</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-627"></a><span>    </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679053530"><a href="#local-6989586621679053530"><span class="hs-identifier">selNames</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679053531"><a href="#local-6989586621679053531"><span class="hs-identifier">bangs</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">unzip3</span><span> </span><a href="#local-6989586621679053529"><span class="hs-identifier hs-var">vbts</span></a><span>
</span><a name="line-628"></a><span>    </span><a name="local-6989586621679053532"><a href="#local-6989586621679053532"><span class="hs-identifier">ssis</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Generics.Deriving.TH.Post4_9.html#reifySelStrictInfo"><span class="hs-identifier hs-var">reifySelStrictInfo</span></a><span> </span><a href="#local-6989586621679053528"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621679053531"><span class="hs-identifier hs-var">bangs</span></a><span>
</span><a name="line-629"></a><span>    </span><a href="Generics.Deriving.TH.html#repConWith"><span class="hs-identifier hs-var">repConWith</span></a><span> </span><a href="#local-6989586621679053524"><span class="hs-identifier hs-var">gClass</span></a><span> </span><a href="#local-6989586621679053525"><span class="hs-identifier hs-var">dv</span></a><span> </span><a href="#local-6989586621679053526"><span class="hs-identifier hs-var">dt</span></a><span> </span><a href="#local-6989586621679053528"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621679053527"><span class="hs-identifier hs-var">tySynVars</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><a href="#local-6989586621679053530"><span class="hs-identifier hs-var">selNames</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679053532"><span class="hs-identifier hs-var">ssis</span></a><span> </span><span class="hs-identifier hs-var">True</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-630"></a><span class="hs-identifier">repCon</span><span> </span><a name="local-6989586621679053533"><a href="#local-6989586621679053533"><span class="hs-identifier">gClass</span></a></a><span> </span><a name="local-6989586621679053534"><a href="#local-6989586621679053534"><span class="hs-identifier">dv</span></a></a><span> </span><a name="local-6989586621679053535"><a href="#local-6989586621679053535"><span class="hs-identifier">dt</span></a></a><span> </span><a name="local-6989586621679053536"><a href="#local-6989586621679053536"><span class="hs-identifier">tySynVars</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">InfixC</span><span> </span><a name="local-6989586621679053537"><a href="#local-6989586621679053537"><span class="hs-identifier">t1</span></a></a><span> </span><a name="local-6989586621679053538"><a href="#local-6989586621679053538"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621679053539"><a href="#local-6989586621679053539"><span class="hs-identifier">t2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-631"></a><span>    </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679053540"><a href="#local-6989586621679053540"><span class="hs-identifier">bangs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-identifier hs-var">fst</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679053537"><span class="hs-identifier hs-var">t1</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679053539"><span class="hs-identifier hs-var">t2</span></a><span class="hs-special">]</span><span>
</span><a name="line-632"></a><span>    </span><a name="local-6989586621679053541"><a href="#local-6989586621679053541"><span class="hs-identifier">ssis</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Generics.Deriving.TH.Post4_9.html#reifySelStrictInfo"><span class="hs-identifier hs-var">reifySelStrictInfo</span></a><span> </span><a href="#local-6989586621679053538"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621679053540"><span class="hs-identifier hs-var">bangs</span></a><span>
</span><a name="line-633"></a><span>    </span><a href="Generics.Deriving.TH.html#repConWith"><span class="hs-identifier hs-var">repConWith</span></a><span> </span><a href="#local-6989586621679053533"><span class="hs-identifier hs-var">gClass</span></a><span> </span><a href="#local-6989586621679053534"><span class="hs-identifier hs-var">dv</span></a><span> </span><a href="#local-6989586621679053535"><span class="hs-identifier hs-var">dt</span></a><span> </span><a href="#local-6989586621679053538"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621679053536"><span class="hs-identifier hs-var">tySynVars</span></a><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><a href="#local-6989586621679053541"><span class="hs-identifier hs-var">ssis</span></a><span> </span><span class="hs-identifier hs-var">False</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-634"></a><span class="hs-identifier">repCon</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679053542"><a href="#local-6989586621679053542"><span class="hs-identifier">con</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Generics.Deriving.TH.Internal.html#gadtError"><span class="hs-identifier hs-var">gadtError</span></a><span> </span><a href="#local-6989586621679053542"><span class="hs-identifier hs-var">con</span></a><span>
</span><a name="line-635"></a><span>
</span><a name="line-636"></a><span class="hs-identifier">repConWith</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Generics.Deriving.TH.Internal.html#GenericClass"><span class="hs-identifier hs-type">GenericClass</span></a><span>
</span><a name="line-637"></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Generics.Deriving.TH.Internal.html#DataVariety"><span class="hs-identifier hs-type">DataVariety</span></a><span>
</span><a name="line-638"></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Name</span><span>
</span><a name="line-639"></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Name</span><span>
</span><a name="line-640"></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Type</span><span class="hs-special">]</span><span>
</span><a name="line-641"></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Name</span><span class="hs-special">]</span><span>
</span><a name="line-642"></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Generics.Deriving.TH.Post4_9.html#SelStrictInfo"><span class="hs-identifier hs-type">SelStrictInfo</span></a><span class="hs-special">]</span><span>
</span><a name="line-643"></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-644"></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-645"></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Q</span><span> </span><span class="hs-identifier hs-type">Type</span><span>
</span><a name="line-646"></a><a name="repConWith"><a href="Generics.Deriving.TH.html#repConWith"><span class="hs-identifier">repConWith</span></a></a><span> </span><a name="local-6989586621679053543"><a href="#local-6989586621679053543"><span class="hs-identifier">gClass</span></a></a><span> </span><a name="local-6989586621679053544"><a href="#local-6989586621679053544"><span class="hs-identifier">dv</span></a></a><span> </span><a name="local-6989586621679053545"><a href="#local-6989586621679053545"><span class="hs-identifier">dt</span></a></a><span> </span><a name="local-6989586621679053546"><a href="#local-6989586621679053546"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621679053547"><a href="#local-6989586621679053547"><span class="hs-identifier">tySynVars</span></a></a><span> </span><a name="local-6989586621679053548"><a href="#local-6989586621679053548"><span class="hs-identifier">mbSelNames</span></a></a><span> </span><a name="local-6989586621679053549"><a href="#local-6989586621679053549"><span class="hs-identifier">ssis</span></a></a><span> </span><a name="local-6989586621679053550"><a href="#local-6989586621679053550"><span class="hs-identifier">isRecord</span></a></a><span> </span><a name="local-6989586621679053551"><a href="#local-6989586621679053551"><span class="hs-identifier">isInfix</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-647"></a><span>    </span><span class="hs-special">(</span><a name="local-6989586621679053552"><a href="#local-6989586621679053552"><span class="hs-identifier">conVars</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679053553"><a href="#local-6989586621679053553"><span class="hs-identifier">ts</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679053554"><a href="#local-6989586621679053554"><span class="hs-identifier">gk</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Generics.Deriving.TH.Internal.html#reifyConTys"><span class="hs-identifier hs-var">reifyConTys</span></a><span> </span><a href="#local-6989586621679053543"><span class="hs-identifier hs-var">gClass</span></a><span> </span><a href="#local-6989586621679053546"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-648"></a><span>
</span><a name="line-649"></a><span>    </span><span class="hs-keyword">let</span><span> </span><span class="hs-identifier">structureType</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Q</span><span> </span><span class="hs-identifier hs-type">Type</span><span>
</span><a name="line-650"></a><span>        </span><a name="local-6989586621679053555"><a href="#local-6989586621679053555"><span class="hs-identifier">structureType</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679053549"><span class="hs-identifier hs-var">ssis</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-651"></a><span>                             </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">conT</span><span> </span><a href="Generics.Deriving.TH.Internal.html#u1TypeName"><span class="hs-identifier hs-var">u1TypeName</span></a><span>
</span><a name="line-652"></a><span>                             </span><span class="hs-identifier">_</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">foldr1</span><span> </span><a href="Generics.Deriving.TH.html#prodT"><span class="hs-identifier hs-var">prodT</span></a><span> </span><a href="#local-6989586621679053557"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-653"></a><span>
</span><a name="line-654"></a><span>        </span><span class="hs-comment">-- See Note [Substituting types in a constructor type signature]</span><span>
</span><a name="line-655"></a><span>        </span><span class="hs-identifier">typeSubst</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Generics.Deriving.TH.Internal.html#TypeSubst"><span class="hs-identifier hs-type">TypeSubst</span></a><span>
</span><a name="line-656"></a><span>        </span><a name="local-6989586621679053556"><a href="#local-6989586621679053556"><span class="hs-identifier">typeSubst</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Map</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">fromList</span><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-657"></a><span>          </span><span class="hs-identifier hs-var">zip</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">nub</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">concatMap</span><span>             </span><a href="Generics.Deriving.TH.Internal.html#tyVarNamesOfType"><span class="hs-identifier hs-var">tyVarNamesOfType</span></a><span>  </span><a href="#local-6989586621679053552"><span class="hs-identifier hs-var">conVars</span></a><span class="hs-special">)</span><span>
</span><a name="line-658"></a><span>              </span><span class="hs-special">(</span><span class="hs-identifier hs-var">nub</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">concatMap</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-identifier hs-var">VarT</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Generics.Deriving.TH.Internal.html#tyVarNamesOfType"><span class="hs-identifier hs-var">tyVarNamesOfType</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679053547"><span class="hs-identifier hs-var">tySynVars</span></a><span class="hs-special">)</span><span>
</span><a name="line-659"></a><span>
</span><a name="line-660"></a><span>        </span><span class="hs-identifier">f</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Q</span><span> </span><span class="hs-identifier hs-type">Type</span><span class="hs-special">]</span><span>
</span><a name="line-661"></a><span>        </span><a name="local-6989586621679053557"><a href="#local-6989586621679053557"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679053548"><span class="hs-identifier hs-var">mbSelNames</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-662"></a><span>                 </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679053558"><a href="#local-6989586621679053558"><span class="hs-identifier">selNames</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">zipWith3</span><span> </span><span class="hs-special">(</span><a href="Generics.Deriving.TH.html#repField"><span class="hs-identifier hs-var">repField</span></a><span> </span><a href="#local-6989586621679053554"><span class="hs-identifier hs-var">gk</span></a><span> </span><a href="#local-6989586621679053544"><span class="hs-identifier hs-var">dv</span></a><span> </span><a href="#local-6989586621679053545"><span class="hs-identifier hs-var">dt</span></a><span> </span><a href="#local-6989586621679053546"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621679053556"><span class="hs-identifier hs-var">typeSubst</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">Just</span><span class="hs-special">)</span><span>
</span><a name="line-663"></a><span>                                           </span><a href="#local-6989586621679053558"><span class="hs-identifier hs-var">selNames</span></a><span> </span><a href="#local-6989586621679053549"><span class="hs-identifier hs-var">ssis</span></a><span> </span><a href="#local-6989586621679053553"><span class="hs-identifier hs-var">ts</span></a><span>
</span><a name="line-664"></a><span>                 </span><span class="hs-identifier hs-var">Nothing</span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">zipWith</span><span>  </span><span class="hs-special">(</span><a href="Generics.Deriving.TH.html#repField"><span class="hs-identifier hs-var">repField</span></a><span> </span><a href="#local-6989586621679053554"><span class="hs-identifier hs-var">gk</span></a><span> </span><a href="#local-6989586621679053544"><span class="hs-identifier hs-var">dv</span></a><span> </span><a href="#local-6989586621679053545"><span class="hs-identifier hs-var">dt</span></a><span> </span><a href="#local-6989586621679053546"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621679053556"><span class="hs-identifier hs-var">typeSubst</span></a><span> </span><span class="hs-identifier hs-var">Nothing</span><span class="hs-special">)</span><span>
</span><a name="line-665"></a><span>                                           </span><a href="#local-6989586621679053549"><span class="hs-identifier hs-var">ssis</span></a><span> </span><a href="#local-6989586621679053553"><span class="hs-identifier hs-var">ts</span></a><span>
</span><a name="line-666"></a><span>
</span><a name="line-667"></a><span>    </span><span class="hs-identifier hs-var">conT</span><span> </span><a href="Generics.Deriving.TH.Internal.html#c1TypeName"><span class="hs-identifier hs-var">c1TypeName</span></a><span>
</span><a name="line-668"></a><span>      </span><span class="hs-special">`</span><span class="hs-identifier hs-var">appT</span><span class="hs-special">`</span><span> </span><a href="Generics.Deriving.TH.Post4_9.html#mkMetaConsType"><span class="hs-identifier hs-var">mkMetaConsType</span></a><span> </span><a href="#local-6989586621679053544"><span class="hs-identifier hs-var">dv</span></a><span> </span><a href="#local-6989586621679053545"><span class="hs-identifier hs-var">dt</span></a><span> </span><a href="#local-6989586621679053546"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621679053550"><span class="hs-identifier hs-var">isRecord</span></a><span> </span><a href="#local-6989586621679053551"><span class="hs-identifier hs-var">isInfix</span></a><span>
</span><a name="line-669"></a><span>      </span><span class="hs-special">`</span><span class="hs-identifier hs-var">appT</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621679053555"><span class="hs-identifier hs-var">structureType</span></a><span>
</span><a name="line-670"></a><span>
</span><a name="line-671"></a><span class="hs-identifier">prodT</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Q</span><span> </span><span class="hs-identifier hs-type">Type</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Q</span><span> </span><span class="hs-identifier hs-type">Type</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Q</span><span> </span><span class="hs-identifier hs-type">Type</span><span>
</span><a name="line-672"></a><a name="prodT"><a href="Generics.Deriving.TH.html#prodT"><span class="hs-identifier">prodT</span></a></a><span> </span><a name="local-6989586621679053559"><a href="#local-6989586621679053559"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679053560"><a href="#local-6989586621679053560"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">conT</span><span> </span><a href="Generics.Deriving.TH.Internal.html#productTypeName"><span class="hs-identifier hs-var">productTypeName</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">appT</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621679053559"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">appT</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621679053560"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-673"></a><span>
</span><a name="line-674"></a><span class="hs-identifier">repField</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Generics.Deriving.TH.Internal.html#GenericKind"><span class="hs-identifier hs-type">GenericKind</span></a><span>
</span><a name="line-675"></a><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Generics.Deriving.TH.Internal.html#DataVariety"><span class="hs-identifier hs-type">DataVariety</span></a><span>
</span><a name="line-676"></a><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Name</span><span>
</span><a name="line-677"></a><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Name</span><span>
</span><a name="line-678"></a><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Generics.Deriving.TH.Internal.html#TypeSubst"><span class="hs-identifier hs-type">TypeSubst</span></a><span>
</span><a name="line-679"></a><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-identifier hs-type">Name</span><span>
</span><a name="line-680"></a><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Generics.Deriving.TH.Post4_9.html#SelStrictInfo"><span class="hs-identifier hs-type">SelStrictInfo</span></a><span>
</span><a name="line-681"></a><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Type</span><span>
</span><a name="line-682"></a><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Q</span><span> </span><span class="hs-identifier hs-type">Type</span><span>
</span><a name="line-683"></a><a name="repField"><a href="Generics.Deriving.TH.html#repField"><span class="hs-identifier">repField</span></a></a><span> </span><a name="local-6989586621679053561"><a href="#local-6989586621679053561"><span class="hs-identifier">gk</span></a></a><span> </span><a name="local-6989586621679053562"><a href="#local-6989586621679053562"><span class="hs-identifier">dv</span></a></a><span> </span><a name="local-6989586621679053563"><a href="#local-6989586621679053563"><span class="hs-identifier">dt</span></a></a><span> </span><a name="local-6989586621679053564"><a href="#local-6989586621679053564"><span class="hs-identifier">ns</span></a></a><span> </span><a name="local-6989586621679053565"><a href="#local-6989586621679053565"><span class="hs-identifier">typeSubst</span></a></a><span> </span><a name="local-6989586621679053566"><a href="#local-6989586621679053566"><span class="hs-identifier">mbF</span></a></a><span> </span><a name="local-6989586621679053567"><a href="#local-6989586621679053567"><span class="hs-identifier">ssi</span></a></a><span> </span><a name="local-6989586621679053568"><a href="#local-6989586621679053568"><span class="hs-identifier">t</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-684"></a><span>           </span><span class="hs-identifier hs-var">conT</span><span> </span><a href="Generics.Deriving.TH.Internal.html#s1TypeName"><span class="hs-identifier hs-var">s1TypeName</span></a><span>
</span><a name="line-685"></a><span>    </span><span class="hs-special">`</span><span class="hs-identifier hs-var">appT</span><span class="hs-special">`</span><span> </span><a href="Generics.Deriving.TH.Post4_9.html#mkMetaSelType"><span class="hs-identifier hs-var">mkMetaSelType</span></a><span> </span><a href="#local-6989586621679053562"><span class="hs-identifier hs-var">dv</span></a><span> </span><a href="#local-6989586621679053563"><span class="hs-identifier hs-var">dt</span></a><span> </span><a href="#local-6989586621679053564"><span class="hs-identifier hs-var">ns</span></a><span> </span><a href="#local-6989586621679053566"><span class="hs-identifier hs-var">mbF</span></a><span> </span><a href="#local-6989586621679053567"><span class="hs-identifier hs-var">ssi</span></a><span>
</span><a name="line-686"></a><span>    </span><span class="hs-special">`</span><span class="hs-identifier hs-var">appT</span><span class="hs-special">`</span><span> </span><span class="hs-special">(</span><a href="Generics.Deriving.TH.html#repFieldArg"><span class="hs-identifier hs-var">repFieldArg</span></a><span> </span><a href="#local-6989586621679053561"><span class="hs-identifier hs-var">gk</span></a><span> </span><span class="hs-operator hs-var">=&lt;&lt;</span><span> </span><a href="Generics.Deriving.TH.Internal.html#expandSyn"><span class="hs-identifier hs-var">expandSyn</span></a><span> </span><a href="#local-6989586621679053570"><span class="hs-identifier hs-var">t''</span></a><span class="hs-special">)</span><span>
</span><a name="line-687"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-688"></a><span>    </span><span class="hs-comment">-- See Note [Substituting types in constructor type signatures]</span><span>
</span><a name="line-689"></a><span>    </span><span class="hs-identifier">t'</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">t''</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Type</span><span>
</span><a name="line-690"></a><span>    </span><a name="local-6989586621679053569"><a href="#local-6989586621679053569"><span class="hs-identifier">t'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679053561"><span class="hs-identifier hs-var">gk</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-691"></a><span>              </span><a href="Generics.Deriving.TH.Internal.html#Gen1"><span class="hs-identifier hs-var">Gen1</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679053571"><a href="#local-6989586621679053571"><span class="hs-identifier">_kvName</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-692"></a><span class="hs-comment">-- See Note [Generic1 is polykinded in base-4.10]</span><span>
</span><a name="line-693"></a><span class="hs-cpp">#if MIN_VERSION_base(4,10,0)</span><span>
</span><a name="line-694"></a><span>                </span><span class="hs-identifier">t</span><span>
</span><a name="line-695"></a><span class="hs-cpp">#else</span><span>
</span><a name="line-696"></a><span>                </span><a href="Generics.Deriving.TH.Internal.html#substNameWithKind"><span class="hs-identifier hs-var">substNameWithKind</span></a><span> </span><a href="#local-6989586621679053571"><span class="hs-identifier hs-var">_kvName</span></a><span> </span><span class="hs-identifier hs-var">starK</span><span> </span><a href="#local-6989586621679053568"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-697"></a><span class="hs-cpp">#endif</span><span>
</span><a name="line-698"></a><span>              </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679053568"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-699"></a><span>    </span><a name="local-6989586621679053570"><a href="#local-6989586621679053570"><span class="hs-identifier">t''</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Generics.Deriving.TH.Internal.html#substType"><span class="hs-identifier hs-var">substType</span></a><span> </span><a href="#local-6989586621679053565"><span class="hs-identifier hs-var">typeSubst</span></a><span> </span><a href="#local-6989586621679053569"><span class="hs-identifier hs-var">t'</span></a><span>
</span><a name="line-700"></a><span>
</span><a name="line-701"></a><span class="hs-identifier">repFieldArg</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Generics.Deriving.TH.Internal.html#GenericKind"><span class="hs-identifier hs-type">GenericKind</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Type</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Q</span><span> </span><span class="hs-identifier hs-type">Type</span><span>
</span><a name="line-702"></a><a name="repFieldArg"><a href="Generics.Deriving.TH.html#repFieldArg"><span class="hs-identifier">repFieldArg</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier hs-var">ForallT</span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Generics.Deriving.TH.Internal.html#rankNError"><span class="hs-identifier hs-var">rankNError</span></a><span>
</span><a name="line-703"></a><span class="hs-identifier">repFieldArg</span><span> </span><a name="local-6989586621679053572"><a href="#local-6989586621679053572"><span class="hs-identifier">gk</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">SigT</span><span> </span><a name="local-6989586621679053573"><a href="#local-6989586621679053573"><span class="hs-identifier">t</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Generics.Deriving.TH.html#repFieldArg"><span class="hs-identifier hs-var">repFieldArg</span></a><span> </span><a href="#local-6989586621679053572"><span class="hs-identifier hs-var">gk</span></a><span> </span><a href="#local-6989586621679053573"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-704"></a><span class="hs-identifier">repFieldArg</span><span> </span><a href="Generics.Deriving.TH.Internal.html#Gen0"><span class="hs-identifier hs-var">Gen0</span></a><span> </span><a name="local-6989586621679053574"><a href="#local-6989586621679053574"><span class="hs-identifier">t</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Generics.Deriving.TH.html#boxT"><span class="hs-identifier hs-var">boxT</span></a><span> </span><a href="#local-6989586621679053574"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-705"></a><span class="hs-identifier">repFieldArg</span><span> </span><span class="hs-special">(</span><a href="Generics.Deriving.TH.Internal.html#Gen1"><span class="hs-identifier hs-var">Gen1</span></a><span> </span><a name="local-6989586621679053575"><a href="#local-6989586621679053575"><span class="hs-identifier">name</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">VarT</span><span> </span><a name="local-6989586621679053576"><a href="#local-6989586621679053576"><span class="hs-identifier">t</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679053576"><span class="hs-identifier hs-var">t</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679053575"><span class="hs-identifier hs-var">name</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">conT</span><span> </span><a href="Generics.Deriving.TH.Internal.html#par1TypeName"><span class="hs-identifier hs-var">par1TypeName</span></a><span>
</span><a name="line-706"></a><span class="hs-identifier">repFieldArg</span><span> </span><a name="local-6989586621679053577"><a href="#local-6989586621679053577"><span class="hs-identifier">gk</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Generics.Deriving.TH.Internal.html#Gen1"><span class="hs-identifier hs-var">Gen1</span></a><span> </span><a name="local-6989586621679053578"><a href="#local-6989586621679053578"><span class="hs-identifier">name</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><a name="local-6989586621679053579"><a href="#local-6989586621679053579"><span class="hs-identifier">t</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-707"></a><span>  </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679053580"><a href="#local-6989586621679053580"><span class="hs-identifier">tyHead</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679053581"><a href="#local-6989586621679053581"><span class="hs-identifier">tyArgs</span></a></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="Generics.Deriving.TH.Internal.html#unapplyTy"><span class="hs-identifier hs-var">unapplyTy</span></a><span> </span><a href="#local-6989586621679053579"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-708"></a><span>      </span><a name="local-6989586621679053582"><a href="#local-6989586621679053582"><span class="hs-identifier">numLastArgs</span></a></a><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">min</span><span> </span><span class="hs-number">1</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">length</span><span> </span><a href="#local-6989586621679053581"><span class="hs-identifier hs-var">tyArgs</span></a><span>
</span><a name="line-709"></a><span>      </span><span class="hs-special">(</span><a name="local-6989586621679053583"><a href="#local-6989586621679053583"><span class="hs-identifier">lhsArgs</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679053584"><a href="#local-6989586621679053584"><span class="hs-identifier">rhsArgs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">splitAt</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">length</span><span> </span><a href="#local-6989586621679053581"><span class="hs-identifier hs-var">tyArgs</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679053582"><span class="hs-identifier hs-var">numLastArgs</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679053581"><span class="hs-identifier hs-var">tyArgs</span></a><span>
</span><a name="line-710"></a><span>      </span><a name="local-6989586621679053585"><a href="#local-6989586621679053585"><span class="hs-identifier">rec0Type</span></a></a><span>           </span><span class="hs-glyph">=</span><span> </span><a href="Generics.Deriving.TH.html#boxT"><span class="hs-identifier hs-var">boxT</span></a><span> </span><a href="#local-6989586621679053579"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-711"></a><span>      </span><a name="local-6989586621679053586"><a href="#local-6989586621679053586"><span class="hs-identifier">phiType</span></a></a><span>            </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Generics.Deriving.TH.Internal.html#applyTyToTys"><span class="hs-identifier hs-var">applyTyToTys</span></a><span> </span><a href="#local-6989586621679053580"><span class="hs-identifier hs-var">tyHead</span></a><span> </span><a href="#local-6989586621679053583"><span class="hs-identifier hs-var">lhsArgs</span></a><span>
</span><a name="line-712"></a><span>
</span><a name="line-713"></a><span>      </span><span class="hs-identifier">inspectTy</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Type</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Q</span><span> </span><span class="hs-identifier hs-type">Type</span><span>
</span><a name="line-714"></a><span>      </span><a name="local-6989586621679053587"><a href="#local-6989586621679053587"><span class="hs-identifier">inspectTy</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">VarT</span><span> </span><a name="local-6989586621679053588"><a href="#local-6989586621679053588"><span class="hs-identifier">a</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-715"></a><span>        </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679053588"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679053578"><span class="hs-identifier hs-var">name</span></a><span>
</span><a name="line-716"></a><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">conT</span><span> </span><a href="Generics.Deriving.TH.Internal.html#rec1TypeName"><span class="hs-identifier hs-var">rec1TypeName</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">appT</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621679053586"><span class="hs-identifier hs-var">phiType</span></a><span>
</span><a name="line-717"></a><span>      </span><span class="hs-identifier">inspectTy</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">SigT</span><span> </span><a name="local-6989586621679053589"><a href="#local-6989586621679053589"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679053587"><span class="hs-identifier hs-var">inspectTy</span></a><span> </span><a href="#local-6989586621679053589"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-718"></a><span>      </span><span class="hs-identifier">inspectTy</span><span> </span><a name="local-6989586621679053590"><a href="#local-6989586621679053590"><span class="hs-identifier">beta</span></a></a><span>
</span><a name="line-719"></a><span>        </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-special">(</span><a href="Generics.Deriving.TH.Internal.html#ground"><span class="hs-identifier hs-var">ground</span></a><span> </span><a href="#local-6989586621679053590"><span class="hs-identifier hs-var">beta</span></a><span> </span><a href="#local-6989586621679053578"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">)</span><span>
</span><a name="line-720"></a><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">conT</span><span> </span><a href="Generics.Deriving.TH.Internal.html#composeTypeName"><span class="hs-identifier hs-var">composeTypeName</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">appT</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621679053586"><span class="hs-identifier hs-var">phiType</span></a><span>
</span><a name="line-721"></a><span>                               </span><span class="hs-special">`</span><span class="hs-identifier hs-var">appT</span><span class="hs-special">`</span><span> </span><a href="Generics.Deriving.TH.html#repFieldArg"><span class="hs-identifier hs-var">repFieldArg</span></a><span> </span><a href="#local-6989586621679053577"><span class="hs-identifier hs-var">gk</span></a><span> </span><a href="#local-6989586621679053590"><span class="hs-identifier hs-var">beta</span></a><span>
</span><a name="line-722"></a><span>      </span><span class="hs-identifier">inspectTy</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679053585"><span class="hs-identifier hs-var">rec0Type</span></a><span>
</span><a name="line-723"></a><span>
</span><a name="line-724"></a><span>  </span><a name="local-6989586621679053591"><a href="#local-6989586621679053591"><span class="hs-identifier">itf</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Generics.Deriving.TH.Internal.html#isTyFamily"><span class="hs-identifier hs-var">isTyFamily</span></a><span> </span><a href="#local-6989586621679053580"><span class="hs-identifier hs-var">tyHead</span></a><span>
</span><a name="line-725"></a><span>  </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier hs-var">any</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-special">(</span><span class="hs-special">`</span><a href="Generics.Deriving.TH.Internal.html#ground"><span class="hs-identifier hs-var">ground</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679053578"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679053583"><span class="hs-identifier hs-var">lhsArgs</span></a><span>
</span><a name="line-726"></a><span>       </span><span class="hs-operator hs-var">||</span><span> </span><span class="hs-identifier hs-var">any</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-special">(</span><span class="hs-special">`</span><a href="Generics.Deriving.TH.Internal.html#ground"><span class="hs-identifier hs-var">ground</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679053578"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679053581"><span class="hs-identifier hs-var">tyArgs</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="#local-6989586621679053591"><span class="hs-identifier hs-var">itf</span></a><span>
</span><a name="line-727"></a><span>     </span><span class="hs-keyword">then</span><span> </span><a href="Generics.Deriving.TH.Internal.html#outOfPlaceTyVarError"><span class="hs-identifier hs-var">outOfPlaceTyVarError</span></a><span>
</span><a name="line-728"></a><span>     </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679053584"><span class="hs-identifier hs-var">rhsArgs</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-729"></a><span>          </span><span class="hs-special">[</span><span class="hs-special">]</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679053585"><span class="hs-identifier hs-var">rec0Type</span></a><span>
</span><a name="line-730"></a><span>          </span><a name="local-6989586621679053592"><a href="#local-6989586621679053592"><span class="hs-identifier">ty</span></a></a><span class="hs-glyph">:</span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679053587"><span class="hs-identifier hs-var">inspectTy</span></a><span> </span><a href="#local-6989586621679053592"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-731"></a><span>
</span><a name="line-732"></a><span class="hs-identifier">boxT</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Type</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Q</span><span> </span><span class="hs-identifier hs-type">Type</span><span>
</span><a name="line-733"></a><a name="boxT"><a href="Generics.Deriving.TH.html#boxT"><span class="hs-identifier">boxT</span></a></a><span> </span><a name="local-6989586621679053593"><a href="#local-6989586621679053593"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="Generics.Deriving.TH.html#unboxedRepNames"><span class="hs-identifier hs-var">unboxedRepNames</span></a><span> </span><a href="#local-6989586621679053593"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-734"></a><span>    </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679053594"><a href="#local-6989586621679053594"><span class="hs-identifier">boxTyName</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">conT</span><span> </span><a href="#local-6989586621679053594"><span class="hs-identifier hs-var">boxTyName</span></a><span>
</span><a name="line-735"></a><span>    </span><span class="hs-identifier hs-var">Nothing</span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">conT</span><span> </span><a href="Generics.Deriving.TH.Internal.html#rec0TypeName"><span class="hs-identifier hs-var">rec0TypeName</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">appT</span><span class="hs-special">`</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><a href="#local-6989586621679053593"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-736"></a><span>
</span><a name="line-737"></a><span class="hs-identifier">mkCaseExp</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Generics.Deriving.TH.Internal.html#GenericClass"><span class="hs-identifier hs-type">GenericClass</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Con</span><span class="hs-special">]</span><span>
</span><a name="line-738"></a><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="Generics.Deriving.TH.Internal.html#GenericClass"><span class="hs-identifier hs-type">GenericClass</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Con</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Q</span><span> </span><span class="hs-identifier hs-type">Match</span><span class="hs-special">)</span><span>
</span><a name="line-739"></a><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Q</span><span> </span><span class="hs-identifier hs-type">Exp</span><span>
</span><a name="line-740"></a><a name="mkCaseExp"><a href="Generics.Deriving.TH.html#mkCaseExp"><span class="hs-identifier">mkCaseExp</span></a></a><span> </span><a name="local-6989586621679053595"><a href="#local-6989586621679053595"><span class="hs-identifier">gClass</span></a></a><span> </span><a name="local-6989586621679053596"><a href="#local-6989586621679053596"><span class="hs-identifier">dt</span></a></a><span> </span><a name="local-6989586621679053597"><a href="#local-6989586621679053597"><span class="hs-identifier">cs</span></a></a><span> </span><a name="local-6989586621679053598"><a href="#local-6989586621679053598"><span class="hs-identifier">matchmaker</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-741"></a><span>  </span><a name="local-6989586621679053599"><a href="#local-6989586621679053599"><span class="hs-identifier">val</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">newName</span><span> </span><span class="hs-string">&quot;val&quot;</span><span>
</span><a name="line-742"></a><span>  </span><span class="hs-identifier hs-var">lam1E</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">varP</span><span> </span><a href="#local-6989586621679053599"><span class="hs-identifier hs-var">val</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">caseE</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">varE</span><span> </span><a href="#local-6989586621679053599"><span class="hs-identifier hs-var">val</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679053598"><span class="hs-identifier hs-var">matchmaker</span></a><span> </span><a href="#local-6989586621679053595"><span class="hs-identifier hs-var">gClass</span></a><span> </span><span class="hs-number">1</span><span> </span><span class="hs-number">0</span><span> </span><a href="#local-6989586621679053596"><span class="hs-identifier hs-var">dt</span></a><span> </span><a href="#local-6989586621679053597"><span class="hs-identifier hs-var">cs</span></a><span class="hs-special">]</span><span>
</span><a name="line-743"></a><span>
</span><a name="line-744"></a><span class="hs-identifier">mkFrom</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Generics.Deriving.TH.Internal.html#GenericClass"><span class="hs-identifier hs-type">GenericClass</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Con</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Q</span><span> </span><span class="hs-identifier hs-type">Match</span><span>
</span><a name="line-745"></a><a name="mkFrom"><a href="Generics.Deriving.TH.html#mkFrom"><span class="hs-identifier">mkFrom</span></a></a><span> </span><a name="local-6989586621679053600"><a href="#local-6989586621679053600"><span class="hs-identifier">gClass</span></a></a><span> </span><a name="local-6989586621679053601"><a href="#local-6989586621679053601"><span class="hs-identifier">m</span></a></a><span> </span><a name="local-6989586621679053602"><a href="#local-6989586621679053602"><span class="hs-identifier">i</span></a></a><span> </span><a name="local-6989586621679053603"><a href="#local-6989586621679053603"><span class="hs-identifier">dt</span></a></a><span> </span><a name="local-6989586621679053604"><a href="#local-6989586621679053604"><span class="hs-identifier">cs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-746"></a><span>    </span><a name="local-6989586621679053608"><a href="#local-6989586621679053608"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">newName</span><span> </span><span class="hs-string">&quot;y&quot;</span><span>
</span><a name="line-747"></a><span>    </span><span class="hs-identifier hs-var">match</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">varP</span><span> </span><a href="#local-6989586621679053608"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span>
</span><a name="line-748"></a><span>          </span><span class="hs-special">(</span><span class="hs-identifier hs-var">normalB</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">conE</span><span> </span><a href="Generics.Deriving.TH.Internal.html#m1DataName"><span class="hs-identifier hs-var">m1DataName</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">appE</span><span class="hs-special">`</span><span> </span><span class="hs-identifier hs-var">caseE</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">varE</span><span> </span><a href="#local-6989586621679053608"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679053605"><span class="hs-identifier hs-var">cases</span></a><span class="hs-special">)</span><span>
</span><a name="line-749"></a><span>          </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-750"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-751"></a><span>    </span><a name="local-6989586621679053605"><a href="#local-6989586621679053605"><span class="hs-identifier">cases</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679053604"><span class="hs-identifier hs-var">cs</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-752"></a><span>              </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Generics.Deriving.TH.html#errorFrom"><span class="hs-identifier hs-var">errorFrom</span></a><span> </span><a href="#local-6989586621679053603"><span class="hs-identifier hs-var">dt</span></a><span class="hs-special">]</span><span>
</span><a name="line-753"></a><span>              </span><span class="hs-identifier">_</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">zipWith</span><span> </span><span class="hs-special">(</span><a href="Generics.Deriving.TH.html#fromCon"><span class="hs-identifier hs-var">fromCon</span></a><span> </span><a href="#local-6989586621679053600"><span class="hs-identifier hs-var">gClass</span></a><span> </span><a href="#local-6989586621679053606"><span class="hs-identifier hs-var">wrapE</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">length</span><span> </span><a href="#local-6989586621679053604"><span class="hs-identifier hs-var">cs</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-number">0</span><span class="hs-glyph">..</span><span class="hs-special">]</span><span> </span><a href="#local-6989586621679053604"><span class="hs-identifier hs-var">cs</span></a><span>
</span><a name="line-754"></a><span>    </span><a name="local-6989586621679053606"><a href="#local-6989586621679053606"><span class="hs-identifier">wrapE</span></a></a><span> </span><a name="local-6989586621679053607"><a href="#local-6989586621679053607"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Generics.Deriving.TH.html#lrE"><span class="hs-identifier hs-var">lrE</span></a><span> </span><a href="#local-6989586621679053601"><span class="hs-identifier hs-var">m</span></a><span> </span><a href="#local-6989586621679053602"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="#local-6989586621679053607"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-755"></a><span>
</span><a name="line-756"></a><span class="hs-identifier">errorFrom</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Q</span><span> </span><span class="hs-identifier hs-type">Match</span><span>
</span><a name="line-757"></a><a name="errorFrom"><a href="Generics.Deriving.TH.html#errorFrom"><span class="hs-identifier">errorFrom</span></a></a><span> </span><a name="local-6989586621679053609"><a href="#local-6989586621679053609"><span class="hs-identifier">dt</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-758"></a><span>  </span><span class="hs-identifier hs-var">match</span><span>
</span><a name="line-759"></a><span>    </span><span class="hs-identifier hs-var">wildP</span><span>
</span><a name="line-760"></a><span>    </span><span class="hs-special">(</span><span class="hs-identifier hs-var">normalB</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">varE</span><span> </span><a href="Generics.Deriving.TH.Internal.html#errorValName"><span class="hs-identifier hs-var">errorValName</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">appE</span><span class="hs-special">`</span><span> </span><span class="hs-identifier hs-var">stringE</span><span>
</span><a name="line-761"></a><span>      </span><span class="hs-special">(</span><span class="hs-string">&quot;No generic representation for empty datatype &quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">nameBase</span><span> </span><a href="#local-6989586621679053609"><span class="hs-identifier hs-var">dt</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-762"></a><span>    </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-763"></a><span>
</span><a name="line-764"></a><span class="hs-identifier">errorTo</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Q</span><span> </span><span class="hs-identifier hs-type">Match</span><span>
</span><a name="line-765"></a><a name="errorTo"><a href="Generics.Deriving.TH.html#errorTo"><span class="hs-identifier">errorTo</span></a></a><span> </span><a name="local-6989586621679053610"><a href="#local-6989586621679053610"><span class="hs-identifier">dt</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-766"></a><span>  </span><span class="hs-identifier hs-var">match</span><span>
</span><a name="line-767"></a><span>    </span><span class="hs-identifier hs-var">wildP</span><span>
</span><a name="line-768"></a><span>    </span><span class="hs-special">(</span><span class="hs-identifier hs-var">normalB</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">varE</span><span> </span><a href="Generics.Deriving.TH.Internal.html#errorValName"><span class="hs-identifier hs-var">errorValName</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">appE</span><span class="hs-special">`</span><span> </span><span class="hs-identifier hs-var">stringE</span><span>
</span><a name="line-769"></a><span>      </span><span class="hs-special">(</span><span class="hs-string">&quot;No values for empty datatype &quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">nameBase</span><span> </span><a href="#local-6989586621679053610"><span class="hs-identifier hs-var">dt</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-770"></a><span>    </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-771"></a><span>
</span><a name="line-772"></a><span class="hs-identifier">mkTo</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Generics.Deriving.TH.Internal.html#GenericClass"><span class="hs-identifier hs-type">GenericClass</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Con</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Q</span><span> </span><span class="hs-identifier hs-type">Match</span><span>
</span><a name="line-773"></a><a name="mkTo"><a href="Generics.Deriving.TH.html#mkTo"><span class="hs-identifier">mkTo</span></a></a><span> </span><a name="local-6989586621679053611"><a href="#local-6989586621679053611"><span class="hs-identifier">gClass</span></a></a><span> </span><a name="local-6989586621679053612"><a href="#local-6989586621679053612"><span class="hs-identifier">m</span></a></a><span> </span><a name="local-6989586621679053613"><a href="#local-6989586621679053613"><span class="hs-identifier">i</span></a></a><span> </span><a name="local-6989586621679053614"><a href="#local-6989586621679053614"><span class="hs-identifier">dt</span></a></a><span> </span><a name="local-6989586621679053615"><a href="#local-6989586621679053615"><span class="hs-identifier">cs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-774"></a><span>    </span><a name="local-6989586621679053619"><a href="#local-6989586621679053619"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">newName</span><span> </span><span class="hs-string">&quot;y&quot;</span><span>
</span><a name="line-775"></a><span>    </span><span class="hs-identifier hs-var">match</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">conP</span><span> </span><a href="Generics.Deriving.TH.Internal.html#m1DataName"><span class="hs-identifier hs-var">m1DataName</span></a><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-var">varP</span><span> </span><a href="#local-6989586621679053619"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-776"></a><span>          </span><span class="hs-special">(</span><span class="hs-identifier hs-var">normalB</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">caseE</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">varE</span><span> </span><a href="#local-6989586621679053619"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679053616"><span class="hs-identifier hs-var">cases</span></a><span class="hs-special">)</span><span>
</span><a name="line-777"></a><span>          </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-778"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-779"></a><span>    </span><a name="local-6989586621679053616"><a href="#local-6989586621679053616"><span class="hs-identifier">cases</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679053615"><span class="hs-identifier hs-var">cs</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-780"></a><span>              </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Generics.Deriving.TH.html#errorTo"><span class="hs-identifier hs-var">errorTo</span></a><span> </span><a href="#local-6989586621679053614"><span class="hs-identifier hs-var">dt</span></a><span class="hs-special">]</span><span>
</span><a name="line-781"></a><span>              </span><span class="hs-identifier">_</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">zipWith</span><span> </span><span class="hs-special">(</span><a href="Generics.Deriving.TH.html#toCon"><span class="hs-identifier hs-var">toCon</span></a><span> </span><a href="#local-6989586621679053611"><span class="hs-identifier hs-var">gClass</span></a><span> </span><a href="#local-6989586621679053617"><span class="hs-identifier hs-var">wrapP</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">length</span><span> </span><a href="#local-6989586621679053615"><span class="hs-identifier hs-var">cs</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-number">0</span><span class="hs-glyph">..</span><span class="hs-special">]</span><span> </span><a href="#local-6989586621679053615"><span class="hs-identifier hs-var">cs</span></a><span>
</span><a name="line-782"></a><span>    </span><a name="local-6989586621679053617"><a href="#local-6989586621679053617"><span class="hs-identifier">wrapP</span></a></a><span> </span><a name="local-6989586621679053618"><a href="#local-6989586621679053618"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Generics.Deriving.TH.html#lrP"><span class="hs-identifier hs-var">lrP</span></a><span> </span><a href="#local-6989586621679053612"><span class="hs-identifier hs-var">m</span></a><span> </span><a href="#local-6989586621679053613"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="#local-6989586621679053618"><span class="hs-identifier hs-var">p</span></a><span>
</span><a name="line-783"></a><span>
</span><a name="line-784"></a><span class="hs-identifier">fromCon</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Generics.Deriving.TH.Internal.html#GenericClass"><span class="hs-identifier hs-type">GenericClass</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Q</span><span> </span><span class="hs-identifier hs-type">Exp</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Q</span><span> </span><span class="hs-identifier hs-type">Exp</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Con</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Q</span><span> </span><span class="hs-identifier hs-type">Match</span><span>
</span><a name="line-785"></a><a name="fromCon"><a href="Generics.Deriving.TH.html#fromCon"><span class="hs-identifier">fromCon</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679053620"><a href="#local-6989586621679053620"><span class="hs-identifier">wrap</span></a></a><span> </span><a name="local-6989586621679053621"><a href="#local-6989586621679053621"><span class="hs-identifier">m</span></a></a><span> </span><a name="local-6989586621679053622"><a href="#local-6989586621679053622"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">NormalC</span><span> </span><a name="local-6989586621679053623"><a href="#local-6989586621679053623"><span class="hs-identifier">cn</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-786"></a><span>  </span><span class="hs-identifier hs-var">match</span><span>
</span><a name="line-787"></a><span>    </span><span class="hs-special">(</span><span class="hs-identifier hs-var">conP</span><span> </span><a href="#local-6989586621679053623"><span class="hs-identifier hs-var">cn</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-788"></a><span>    </span><span class="hs-special">(</span><span class="hs-identifier hs-var">normalB</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679053620"><span class="hs-identifier hs-var">wrap</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Generics.Deriving.TH.html#lrE"><span class="hs-identifier hs-var">lrE</span></a><span> </span><a href="#local-6989586621679053621"><span class="hs-identifier hs-var">m</span></a><span> </span><a href="#local-6989586621679053622"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">conE</span><span> </span><a href="Generics.Deriving.TH.Internal.html#m1DataName"><span class="hs-identifier hs-var">m1DataName</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">appE</span><span class="hs-special">`</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">conE</span><span> </span><a href="Generics.Deriving.TH.Internal.html#u1DataName"><span class="hs-identifier hs-var">u1DataName</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-789"></a><span class="hs-identifier">fromCon</span><span> </span><a name="local-6989586621679053624"><a href="#local-6989586621679053624"><span class="hs-identifier">gClass</span></a></a><span> </span><a name="local-6989586621679053625"><a href="#local-6989586621679053625"><span class="hs-identifier">wrap</span></a></a><span> </span><a name="local-6989586621679053626"><a href="#local-6989586621679053626"><span class="hs-identifier">m</span></a></a><span> </span><a name="local-6989586621679053627"><a href="#local-6989586621679053627"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">NormalC</span><span> </span><a name="local-6989586621679053628"><a href="#local-6989586621679053628"><span class="hs-identifier">cn</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-790"></a><span>  </span><span class="hs-special">(</span><a name="local-6989586621679053629"><a href="#local-6989586621679053629"><span class="hs-identifier">ts</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679053630"><a href="#local-6989586621679053630"><span class="hs-identifier">gk</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><a href="Generics.Deriving.TH.Internal.html#shrink"><span class="hs-identifier hs-var">shrink</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Generics.Deriving.TH.Internal.html#reifyConTys"><span class="hs-identifier hs-var">reifyConTys</span></a><span> </span><a href="#local-6989586621679053624"><span class="hs-identifier hs-var">gClass</span></a><span> </span><a href="#local-6989586621679053628"><span class="hs-identifier hs-var">cn</span></a><span>
</span><a name="line-791"></a><span>  </span><a name="local-6989586621679053631"><a href="#local-6989586621679053631"><span class="hs-identifier">fNames</span></a></a><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Generics.Deriving.TH.Internal.html#newNameList"><span class="hs-identifier hs-var">newNameList</span></a><span> </span><span class="hs-string">&quot;f&quot;</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">length</span><span> </span><a href="#local-6989586621679053629"><span class="hs-identifier hs-var">ts</span></a><span>
</span><a name="line-792"></a><span>  </span><span class="hs-identifier hs-var">match</span><span>
</span><a name="line-793"></a><span>    </span><span class="hs-special">(</span><span class="hs-identifier hs-var">conP</span><span> </span><a href="#local-6989586621679053628"><span class="hs-identifier hs-var">cn</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-identifier hs-var">varP</span><span> </span><a href="#local-6989586621679053631"><span class="hs-identifier hs-var">fNames</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-794"></a><span>    </span><span class="hs-special">(</span><span class="hs-identifier hs-var">normalB</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679053625"><span class="hs-identifier hs-var">wrap</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Generics.Deriving.TH.html#lrE"><span class="hs-identifier hs-var">lrE</span></a><span> </span><a href="#local-6989586621679053626"><span class="hs-identifier hs-var">m</span></a><span> </span><a href="#local-6989586621679053627"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">conE</span><span> </span><a href="Generics.Deriving.TH.Internal.html#m1DataName"><span class="hs-identifier hs-var">m1DataName</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">appE</span><span class="hs-special">`</span><span>
</span><a name="line-795"></a><span>      </span><span class="hs-identifier hs-var">foldr1</span><span> </span><a href="Generics.Deriving.TH.html#prodE"><span class="hs-identifier hs-var">prodE</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">zipWith</span><span> </span><span class="hs-special">(</span><a href="Generics.Deriving.TH.html#fromField"><span class="hs-identifier hs-var">fromField</span></a><span> </span><a href="#local-6989586621679053630"><span class="hs-identifier hs-var">gk</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679053631"><span class="hs-identifier hs-var">fNames</span></a><span> </span><a href="#local-6989586621679053629"><span class="hs-identifier hs-var">ts</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-796"></a><span class="hs-identifier">fromCon</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679053632"><a href="#local-6989586621679053632"><span class="hs-identifier">wrap</span></a></a><span> </span><a name="local-6989586621679053633"><a href="#local-6989586621679053633"><span class="hs-identifier">m</span></a></a><span> </span><a name="local-6989586621679053634"><a href="#local-6989586621679053634"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">RecC</span><span> </span><a name="local-6989586621679053635"><a href="#local-6989586621679053635"><span class="hs-identifier">cn</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-797"></a><span>  </span><span class="hs-identifier hs-var">match</span><span>
</span><a name="line-798"></a><span>    </span><span class="hs-special">(</span><span class="hs-identifier hs-var">conP</span><span> </span><a href="#local-6989586621679053635"><span class="hs-identifier hs-var">cn</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-799"></a><span>    </span><span class="hs-special">(</span><span class="hs-identifier hs-var">normalB</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679053632"><span class="hs-identifier hs-var">wrap</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Generics.Deriving.TH.html#lrE"><span class="hs-identifier hs-var">lrE</span></a><span> </span><a href="#local-6989586621679053633"><span class="hs-identifier hs-var">m</span></a><span> </span><a href="#local-6989586621679053634"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">conE</span><span> </span><a href="Generics.Deriving.TH.Internal.html#m1DataName"><span class="hs-identifier hs-var">m1DataName</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">appE</span><span class="hs-special">`</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">conE</span><span> </span><a href="Generics.Deriving.TH.Internal.html#u1DataName"><span class="hs-identifier hs-var">u1DataName</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-800"></a><span class="hs-identifier">fromCon</span><span> </span><a name="local-6989586621679053636"><a href="#local-6989586621679053636"><span class="hs-identifier">gClass</span></a></a><span> </span><a name="local-6989586621679053637"><a href="#local-6989586621679053637"><span class="hs-identifier">wrap</span></a></a><span> </span><a name="local-6989586621679053638"><a href="#local-6989586621679053638"><span class="hs-identifier">m</span></a></a><span> </span><a name="local-6989586621679053639"><a href="#local-6989586621679053639"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">RecC</span><span> </span><a name="local-6989586621679053640"><a href="#local-6989586621679053640"><span class="hs-identifier">cn</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-801"></a><span>  </span><span class="hs-special">(</span><a name="local-6989586621679053641"><a href="#local-6989586621679053641"><span class="hs-identifier">ts</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679053642"><a href="#local-6989586621679053642"><span class="hs-identifier">gk</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><a href="Generics.Deriving.TH.Internal.html#shrink"><span class="hs-identifier hs-var">shrink</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Generics.Deriving.TH.Internal.html#reifyConTys"><span class="hs-identifier hs-var">reifyConTys</span></a><span> </span><a href="#local-6989586621679053636"><span class="hs-identifier hs-var">gClass</span></a><span> </span><a href="#local-6989586621679053640"><span class="hs-identifier hs-var">cn</span></a><span>
</span><a name="line-802"></a><span>  </span><a name="local-6989586621679053643"><a href="#local-6989586621679053643"><span class="hs-identifier">fNames</span></a></a><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Generics.Deriving.TH.Internal.html#newNameList"><span class="hs-identifier hs-var">newNameList</span></a><span> </span><span class="hs-string">&quot;f&quot;</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">length</span><span> </span><a href="#local-6989586621679053641"><span class="hs-identifier hs-var">ts</span></a><span>
</span><a name="line-803"></a><span>  </span><span class="hs-identifier hs-var">match</span><span>
</span><a name="line-804"></a><span>    </span><span class="hs-special">(</span><span class="hs-identifier hs-var">conP</span><span> </span><a href="#local-6989586621679053640"><span class="hs-identifier hs-var">cn</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-identifier hs-var">varP</span><span> </span><a href="#local-6989586621679053643"><span class="hs-identifier hs-var">fNames</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-805"></a><span>    </span><span class="hs-special">(</span><span class="hs-identifier hs-var">normalB</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679053637"><span class="hs-identifier hs-var">wrap</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Generics.Deriving.TH.html#lrE"><span class="hs-identifier hs-var">lrE</span></a><span> </span><a href="#local-6989586621679053638"><span class="hs-identifier hs-var">m</span></a><span> </span><a href="#local-6989586621679053639"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">conE</span><span> </span><a href="Generics.Deriving.TH.Internal.html#m1DataName"><span class="hs-identifier hs-var">m1DataName</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">appE</span><span class="hs-special">`</span><span>
</span><a name="line-806"></a><span>      </span><span class="hs-identifier hs-var">foldr1</span><span> </span><a href="Generics.Deriving.TH.html#prodE"><span class="hs-identifier hs-var">prodE</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">zipWith</span><span> </span><span class="hs-special">(</span><a href="Generics.Deriving.TH.html#fromField"><span class="hs-identifier hs-var">fromField</span></a><span> </span><a href="#local-6989586621679053642"><span class="hs-identifier hs-var">gk</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679053643"><span class="hs-identifier hs-var">fNames</span></a><span> </span><a href="#local-6989586621679053641"><span class="hs-identifier hs-var">ts</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-807"></a><span class="hs-identifier">fromCon</span><span> </span><a name="local-6989586621679053644"><a href="#local-6989586621679053644"><span class="hs-identifier">gClass</span></a></a><span> </span><a name="local-6989586621679053645"><a href="#local-6989586621679053645"><span class="hs-identifier">wrap</span></a></a><span> </span><a name="local-6989586621679053646"><a href="#local-6989586621679053646"><span class="hs-identifier">m</span></a></a><span> </span><a name="local-6989586621679053647"><a href="#local-6989586621679053647"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">InfixC</span><span> </span><a name="local-6989586621679053648"><a href="#local-6989586621679053648"><span class="hs-identifier">t1</span></a></a><span> </span><a name="local-6989586621679053649"><a href="#local-6989586621679053649"><span class="hs-identifier">cn</span></a></a><span> </span><a name="local-6989586621679053650"><a href="#local-6989586621679053650"><span class="hs-identifier">t2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-808"></a><span>  </span><a href="Generics.Deriving.TH.html#fromCon"><span class="hs-identifier hs-var">fromCon</span></a><span> </span><a href="#local-6989586621679053644"><span class="hs-identifier hs-var">gClass</span></a><span> </span><a href="#local-6989586621679053645"><span class="hs-identifier hs-var">wrap</span></a><span> </span><a href="#local-6989586621679053646"><span class="hs-identifier hs-var">m</span></a><span> </span><a href="#local-6989586621679053647"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">NormalC</span><span> </span><a href="#local-6989586621679053649"><span class="hs-identifier hs-var">cn</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679053648"><span class="hs-identifier hs-var">t1</span></a><span class="hs-special">,</span><a href="#local-6989586621679053650"><span class="hs-identifier hs-var">t2</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-809"></a><span class="hs-identifier">fromCon</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679053651"><a href="#local-6989586621679053651"><span class="hs-identifier">con</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Generics.Deriving.TH.Internal.html#gadtError"><span class="hs-identifier hs-var">gadtError</span></a><span> </span><a href="#local-6989586621679053651"><span class="hs-identifier hs-var">con</span></a><span>
</span><a name="line-810"></a><span>
</span><a name="line-811"></a><span class="hs-identifier">prodE</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Q</span><span> </span><span class="hs-identifier hs-type">Exp</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Q</span><span> </span><span class="hs-identifier hs-type">Exp</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Q</span><span> </span><span class="hs-identifier hs-type">Exp</span><span>
</span><a name="line-812"></a><a name="prodE"><a href="Generics.Deriving.TH.html#prodE"><span class="hs-identifier">prodE</span></a></a><span> </span><a name="local-6989586621679053652"><a href="#local-6989586621679053652"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679053653"><a href="#local-6989586621679053653"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">conE</span><span> </span><a href="Generics.Deriving.TH.Internal.html#productDataName"><span class="hs-identifier hs-var">productDataName</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">appE</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621679053652"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">appE</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621679053653"><span class="hs-identifier hs-var">y</span></a><span>
</span><a name="line-813"></a><span>
</span><a name="line-814"></a><span class="hs-identifier">fromField</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Generics.Deriving.TH.Internal.html#GenericKind"><span class="hs-identifier hs-type">GenericKind</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Type</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Q</span><span> </span><span class="hs-identifier hs-type">Exp</span><span>
</span><a name="line-815"></a><a name="fromField"><a href="Generics.Deriving.TH.html#fromField"><span class="hs-identifier">fromField</span></a></a><span> </span><a name="local-6989586621679053654"><a href="#local-6989586621679053654"><span class="hs-identifier">gk</span></a></a><span> </span><a name="local-6989586621679053655"><a href="#local-6989586621679053655"><span class="hs-identifier">nr</span></a></a><span> </span><a name="local-6989586621679053656"><a href="#local-6989586621679053656"><span class="hs-identifier">t</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">conE</span><span> </span><a href="Generics.Deriving.TH.Internal.html#m1DataName"><span class="hs-identifier hs-var">m1DataName</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">appE</span><span class="hs-special">`</span><span> </span><span class="hs-special">(</span><a href="Generics.Deriving.TH.html#fromFieldWrap"><span class="hs-identifier hs-var">fromFieldWrap</span></a><span> </span><a href="#local-6989586621679053654"><span class="hs-identifier hs-var">gk</span></a><span> </span><a href="#local-6989586621679053655"><span class="hs-identifier hs-var">nr</span></a><span> </span><span class="hs-operator hs-var">=&lt;&lt;</span><span> </span><a href="Generics.Deriving.TH.Internal.html#expandSyn"><span class="hs-identifier hs-var">expandSyn</span></a><span> </span><a href="#local-6989586621679053656"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">)</span><span>
</span><a name="line-816"></a><span>
</span><a name="line-817"></a><span class="hs-identifier">fromFieldWrap</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Generics.Deriving.TH.Internal.html#GenericKind"><span class="hs-identifier hs-type">GenericKind</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Type</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Q</span><span> </span><span class="hs-identifier hs-type">Exp</span><span>
</span><a name="line-818"></a><a name="fromFieldWrap"><a href="Generics.Deriving.TH.html#fromFieldWrap"><span class="hs-identifier">fromFieldWrap</span></a></a><span> </span><span class="hs-identifier">_</span><span>             </span><span class="hs-identifier">_</span><span>  </span><span class="hs-identifier hs-var">ForallT</span><span class="hs-special">{</span><span class="hs-special">}</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Generics.Deriving.TH.Internal.html#rankNError"><span class="hs-identifier hs-var">rankNError</span></a><span>
</span><a name="line-819"></a><span class="hs-identifier">fromFieldWrap</span><span> </span><a name="local-6989586621679053657"><a href="#local-6989586621679053657"><span class="hs-identifier">gk</span></a></a><span>            </span><a name="local-6989586621679053658"><a href="#local-6989586621679053658"><span class="hs-identifier">nr</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">SigT</span><span> </span><a name="local-6989586621679053659"><a href="#local-6989586621679053659"><span class="hs-identifier">t</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Generics.Deriving.TH.html#fromFieldWrap"><span class="hs-identifier hs-var">fromFieldWrap</span></a><span> </span><a href="#local-6989586621679053657"><span class="hs-identifier hs-var">gk</span></a><span> </span><a href="#local-6989586621679053658"><span class="hs-identifier hs-var">nr</span></a><span> </span><a href="#local-6989586621679053659"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-820"></a><span class="hs-identifier">fromFieldWrap</span><span> </span><a href="Generics.Deriving.TH.Internal.html#Gen0"><span class="hs-identifier hs-var">Gen0</span></a><span>          </span><a name="local-6989586621679053660"><a href="#local-6989586621679053660"><span class="hs-identifier">nr</span></a></a><span> </span><a name="local-6989586621679053661"><a href="#local-6989586621679053661"><span class="hs-identifier">t</span></a></a><span>          </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">conE</span><span> </span><span class="hs-special">(</span><a href="Generics.Deriving.TH.html#boxRepName"><span class="hs-identifier hs-var">boxRepName</span></a><span> </span><a href="#local-6989586621679053661"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">appE</span><span class="hs-special">`</span><span> </span><span class="hs-identifier hs-var">varE</span><span> </span><a href="#local-6989586621679053660"><span class="hs-identifier hs-var">nr</span></a><span>
</span><a name="line-821"></a><span class="hs-identifier">fromFieldWrap</span><span> </span><span class="hs-special">(</span><a href="Generics.Deriving.TH.Internal.html#Gen1"><span class="hs-identifier hs-var">Gen1</span></a><span> </span><a name="local-6989586621679053662"><a href="#local-6989586621679053662"><span class="hs-identifier">name</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><a name="local-6989586621679053663"><a href="#local-6989586621679053663"><span class="hs-identifier">nr</span></a></a><span> </span><a name="local-6989586621679053664"><a href="#local-6989586621679053664"><span class="hs-identifier">t</span></a></a><span>          </span><span class="hs-glyph">=</span><span> </span><a href="Generics.Deriving.TH.html#wC"><span class="hs-identifier hs-var">wC</span></a><span> </span><a href="#local-6989586621679053664"><span class="hs-identifier hs-var">t</span></a><span> </span><a href="#local-6989586621679053662"><span class="hs-identifier hs-var">name</span></a><span>           </span><span class="hs-special">`</span><span class="hs-identifier hs-var">appE</span><span class="hs-special">`</span><span> </span><span class="hs-identifier hs-var">varE</span><span> </span><a href="#local-6989586621679053663"><span class="hs-identifier hs-var">nr</span></a><span>
</span><a name="line-822"></a><span>
</span><a name="line-823"></a><span class="hs-identifier">wC</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Type</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Q</span><span> </span><span class="hs-identifier hs-type">Exp</span><span>
</span><a name="line-824"></a><a name="wC"><a href="Generics.Deriving.TH.html#wC"><span class="hs-identifier">wC</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">VarT</span><span> </span><a name="local-6989586621679053665"><a href="#local-6989586621679053665"><span class="hs-identifier">t</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679053666"><a href="#local-6989586621679053666"><span class="hs-identifier">name</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679053665"><span class="hs-identifier hs-var">t</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679053666"><span class="hs-identifier hs-var">name</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">conE</span><span> </span><a href="Generics.Deriving.TH.Internal.html#par1DataName"><span class="hs-identifier hs-var">par1DataName</span></a><span>
</span><a name="line-825"></a><span class="hs-identifier">wC</span><span> </span><a name="local-6989586621679053667"><a href="#local-6989586621679053667"><span class="hs-identifier">t</span></a></a><span> </span><a name="local-6989586621679053668"><a href="#local-6989586621679053668"><span class="hs-identifier">name</span></a></a><span>
</span><a name="line-826"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="Generics.Deriving.TH.Internal.html#ground"><span class="hs-identifier hs-var">ground</span></a><span> </span><a href="#local-6989586621679053667"><span class="hs-identifier hs-var">t</span></a><span> </span><a href="#local-6989586621679053668"><span class="hs-identifier hs-var">name</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">conE</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Generics.Deriving.TH.html#boxRepName"><span class="hs-identifier hs-var">boxRepName</span></a><span> </span><a href="#local-6989586621679053667"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-827"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-828"></a><span>      </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679053669"><a href="#local-6989586621679053669"><span class="hs-identifier">tyHead</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679053670"><a href="#local-6989586621679053670"><span class="hs-identifier">tyArgs</span></a></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="Generics.Deriving.TH.Internal.html#unapplyTy"><span class="hs-identifier hs-var">unapplyTy</span></a><span> </span><a href="#local-6989586621679053667"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-829"></a><span>          </span><a name="local-6989586621679053671"><a href="#local-6989586621679053671"><span class="hs-identifier">numLastArgs</span></a></a><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">min</span><span> </span><span class="hs-number">1</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">length</span><span> </span><a href="#local-6989586621679053670"><span class="hs-identifier hs-var">tyArgs</span></a><span>
</span><a name="line-830"></a><span>          </span><span class="hs-special">(</span><a name="local-6989586621679053672"><a href="#local-6989586621679053672"><span class="hs-identifier">lhsArgs</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679053673"><a href="#local-6989586621679053673"><span class="hs-identifier">rhsArgs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">splitAt</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">length</span><span> </span><a href="#local-6989586621679053670"><span class="hs-identifier hs-var">tyArgs</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679053671"><span class="hs-identifier hs-var">numLastArgs</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679053670"><span class="hs-identifier hs-var">tyArgs</span></a><span>
</span><a name="line-831"></a><span>
</span><a name="line-832"></a><span>          </span><span class="hs-identifier">inspectTy</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Type</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Q</span><span> </span><span class="hs-identifier hs-type">Exp</span><span>
</span><a name="line-833"></a><span>          </span><a name="local-6989586621679053674"><a href="#local-6989586621679053674"><span class="hs-identifier">inspectTy</span></a></a><span> </span><span class="hs-identifier hs-var">ForallT</span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Generics.Deriving.TH.Internal.html#rankNError"><span class="hs-identifier hs-var">rankNError</span></a><span>
</span><a name="line-834"></a><span>          </span><span class="hs-identifier">inspectTy</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">SigT</span><span> </span><a name="local-6989586621679053675"><a href="#local-6989586621679053675"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679053674"><span class="hs-identifier hs-var">inspectTy</span></a><span> </span><a href="#local-6989586621679053675"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-835"></a><span>          </span><span class="hs-identifier">inspectTy</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">VarT</span><span> </span><a name="local-6989586621679053676"><a href="#local-6989586621679053676"><span class="hs-identifier">a</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-836"></a><span>            </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679053676"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679053668"><span class="hs-identifier hs-var">name</span></a><span>
</span><a name="line-837"></a><span>            </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">conE</span><span> </span><a href="Generics.Deriving.TH.Internal.html#rec1DataName"><span class="hs-identifier hs-var">rec1DataName</span></a><span>
</span><a name="line-838"></a><span>          </span><span class="hs-identifier">inspectTy</span><span> </span><a name="local-6989586621679053677"><a href="#local-6989586621679053677"><span class="hs-identifier">beta</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">infixApp</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">conE</span><span> </span><a href="Generics.Deriving.TH.Internal.html#comp1DataName"><span class="hs-identifier hs-var">comp1DataName</span></a><span class="hs-special">)</span><span>
</span><a name="line-839"></a><span>                                    </span><span class="hs-special">(</span><span class="hs-identifier hs-var">varE</span><span> </span><a href="Generics.Deriving.TH.Internal.html#composeValName"><span class="hs-identifier hs-var">composeValName</span></a><span class="hs-special">)</span><span>
</span><a name="line-840"></a><span>                                    </span><span class="hs-special">(</span><span class="hs-identifier hs-var">varE</span><span> </span><a href="Generics.Deriving.TH.Internal.html#fmapValName"><span class="hs-identifier hs-var">fmapValName</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">appE</span><span class="hs-special">`</span><span> </span><a href="Generics.Deriving.TH.html#wC"><span class="hs-identifier hs-var">wC</span></a><span> </span><a href="#local-6989586621679053677"><span class="hs-identifier hs-var">beta</span></a><span> </span><a href="#local-6989586621679053668"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">)</span><span>
</span><a name="line-841"></a><span>
</span><a name="line-842"></a><span>      </span><a name="local-6989586621679053678"><a href="#local-6989586621679053678"><span class="hs-identifier">itf</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Generics.Deriving.TH.Internal.html#isTyFamily"><span class="hs-identifier hs-var">isTyFamily</span></a><span> </span><a href="#local-6989586621679053669"><span class="hs-identifier hs-var">tyHead</span></a><span>
</span><a name="line-843"></a><span>      </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier hs-var">any</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-special">(</span><span class="hs-special">`</span><a href="Generics.Deriving.TH.Internal.html#ground"><span class="hs-identifier hs-var">ground</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679053668"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679053672"><span class="hs-identifier hs-var">lhsArgs</span></a><span>
</span><a name="line-844"></a><span>           </span><span class="hs-operator hs-var">||</span><span> </span><span class="hs-identifier hs-var">any</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-special">(</span><span class="hs-special">`</span><a href="Generics.Deriving.TH.Internal.html#ground"><span class="hs-identifier hs-var">ground</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679053668"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679053670"><span class="hs-identifier hs-var">tyArgs</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="#local-6989586621679053678"><span class="hs-identifier hs-var">itf</span></a><span>
</span><a name="line-845"></a><span>         </span><span class="hs-keyword">then</span><span> </span><a href="Generics.Deriving.TH.Internal.html#outOfPlaceTyVarError"><span class="hs-identifier hs-var">outOfPlaceTyVarError</span></a><span>
</span><a name="line-846"></a><span>         </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679053673"><span class="hs-identifier hs-var">rhsArgs</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-847"></a><span>              </span><span class="hs-special">[</span><span class="hs-special">]</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">conE</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Generics.Deriving.TH.html#boxRepName"><span class="hs-identifier hs-var">boxRepName</span></a><span> </span><a href="#local-6989586621679053667"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-848"></a><span>              </span><a name="local-6989586621679053679"><a href="#local-6989586621679053679"><span class="hs-identifier">ty</span></a></a><span class="hs-glyph">:</span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679053674"><span class="hs-identifier hs-var">inspectTy</span></a><span> </span><a href="#local-6989586621679053679"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-849"></a><span>
</span><a name="line-850"></a><span class="hs-identifier">boxRepName</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Type</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Name</span><span>
</span><a name="line-851"></a><a name="boxRepName"><a href="Generics.Deriving.TH.html#boxRepName"><span class="hs-identifier">boxRepName</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">maybe</span><span> </span><a href="Generics.Deriving.TH.Internal.html#k1DataName"><span class="hs-identifier hs-var">k1DataName</span></a><span> </span><a href="Generics.Deriving.TH.Internal.html#snd3"><span class="hs-identifier hs-var">snd3</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Generics.Deriving.TH.html#unboxedRepNames"><span class="hs-identifier hs-var">unboxedRepNames</span></a><span>
</span><a name="line-852"></a><span>
</span><a name="line-853"></a><span class="hs-identifier">toCon</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Generics.Deriving.TH.Internal.html#GenericClass"><span class="hs-identifier hs-type">GenericClass</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Q</span><span> </span><span class="hs-identifier hs-type">Pat</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Q</span><span> </span><span class="hs-identifier hs-type">Pat</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Con</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Q</span><span> </span><span class="hs-identifier hs-type">Match</span><span>
</span><a name="line-854"></a><a name="toCon"><a href="Generics.Deriving.TH.html#toCon"><span class="hs-identifier">toCon</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679053680"><a href="#local-6989586621679053680"><span class="hs-identifier">wrap</span></a></a><span> </span><a name="local-6989586621679053681"><a href="#local-6989586621679053681"><span class="hs-identifier">m</span></a></a><span> </span><a name="local-6989586621679053682"><a href="#local-6989586621679053682"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">NormalC</span><span> </span><a name="local-6989586621679053683"><a href="#local-6989586621679053683"><span class="hs-identifier">cn</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-855"></a><span>    </span><span class="hs-identifier hs-var">match</span><span>
</span><a name="line-856"></a><span>      </span><span class="hs-special">(</span><a href="#local-6989586621679053680"><span class="hs-identifier hs-var">wrap</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Generics.Deriving.TH.html#lrP"><span class="hs-identifier hs-var">lrP</span></a><span> </span><a href="#local-6989586621679053681"><span class="hs-identifier hs-var">m</span></a><span> </span><a href="#local-6989586621679053682"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">conP</span><span> </span><a href="Generics.Deriving.TH.Internal.html#m1DataName"><span class="hs-identifier hs-var">m1DataName</span></a><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-var">conP</span><span> </span><a href="Generics.Deriving.TH.Internal.html#u1DataName"><span class="hs-identifier hs-var">u1DataName</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-857"></a><span>      </span><span class="hs-special">(</span><span class="hs-identifier hs-var">normalB</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">conE</span><span> </span><a href="#local-6989586621679053683"><span class="hs-identifier hs-var">cn</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-858"></a><span class="hs-identifier">toCon</span><span> </span><a name="local-6989586621679053684"><a href="#local-6989586621679053684"><span class="hs-identifier">gClass</span></a></a><span> </span><a name="local-6989586621679053685"><a href="#local-6989586621679053685"><span class="hs-identifier">wrap</span></a></a><span> </span><a name="local-6989586621679053686"><a href="#local-6989586621679053686"><span class="hs-identifier">m</span></a></a><span> </span><a name="local-6989586621679053687"><a href="#local-6989586621679053687"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">NormalC</span><span> </span><a name="local-6989586621679053688"><a href="#local-6989586621679053688"><span class="hs-identifier">cn</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-859"></a><span>    </span><span class="hs-special">(</span><a name="local-6989586621679053692"><a href="#local-6989586621679053692"><span class="hs-identifier">ts</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679053693"><a href="#local-6989586621679053693"><span class="hs-identifier">gk</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><a href="Generics.Deriving.TH.Internal.html#shrink"><span class="hs-identifier hs-var">shrink</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Generics.Deriving.TH.Internal.html#reifyConTys"><span class="hs-identifier hs-var">reifyConTys</span></a><span> </span><a href="#local-6989586621679053684"><span class="hs-identifier hs-var">gClass</span></a><span> </span><a href="#local-6989586621679053688"><span class="hs-identifier hs-var">cn</span></a><span>
</span><a name="line-860"></a><span>    </span><a name="local-6989586621679053694"><a href="#local-6989586621679053694"><span class="hs-identifier">fNames</span></a></a><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Generics.Deriving.TH.Internal.html#newNameList"><span class="hs-identifier hs-var">newNameList</span></a><span> </span><span class="hs-string">&quot;f&quot;</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">length</span><span> </span><a href="#local-6989586621679053692"><span class="hs-identifier hs-var">ts</span></a><span>
</span><a name="line-861"></a><span>    </span><span class="hs-identifier hs-var">match</span><span>
</span><a name="line-862"></a><span>      </span><span class="hs-special">(</span><a href="#local-6989586621679053685"><span class="hs-identifier hs-var">wrap</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Generics.Deriving.TH.html#lrP"><span class="hs-identifier hs-var">lrP</span></a><span> </span><a href="#local-6989586621679053686"><span class="hs-identifier hs-var">m</span></a><span> </span><a href="#local-6989586621679053687"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">conP</span><span> </span><a href="Generics.Deriving.TH.Internal.html#m1DataName"><span class="hs-identifier hs-var">m1DataName</span></a><span>
</span><a name="line-863"></a><span>        </span><span class="hs-special">[</span><span class="hs-identifier hs-var">foldr1</span><span> </span><a href="#local-6989586621679053689"><span class="hs-identifier hs-var">prod</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">zipWith</span><span> </span><span class="hs-special">(</span><a href="Generics.Deriving.TH.html#toField"><span class="hs-identifier hs-var">toField</span></a><span> </span><a href="#local-6989586621679053693"><span class="hs-identifier hs-var">gk</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679053694"><span class="hs-identifier hs-var">fNames</span></a><span> </span><a href="#local-6989586621679053692"><span class="hs-identifier hs-var">ts</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-864"></a><span>      </span><span class="hs-special">(</span><span class="hs-identifier hs-var">normalB</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">foldl</span><span> </span><span class="hs-identifier hs-var">appE</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">conE</span><span> </span><a href="#local-6989586621679053688"><span class="hs-identifier hs-var">cn</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">zipWith</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679053695"><a href="#local-6989586621679053695"><span class="hs-identifier">nr</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Generics.Deriving.TH.Internal.html#expandSyn"><span class="hs-identifier hs-var">expandSyn</span></a><span> </span><span class="hs-operator hs-var">&gt;=&gt;</span><span> </span><a href="Generics.Deriving.TH.html#toConUnwC"><span class="hs-identifier hs-var">toConUnwC</span></a><span> </span><a href="#local-6989586621679053693"><span class="hs-identifier hs-var">gk</span></a><span> </span><a href="#local-6989586621679053695"><span class="hs-identifier hs-var">nr</span></a><span class="hs-special">)</span><span>
</span><a name="line-865"></a><span>                                      </span><a href="#local-6989586621679053694"><span class="hs-identifier hs-var">fNames</span></a><span> </span><a href="#local-6989586621679053692"><span class="hs-identifier hs-var">ts</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-866"></a><span>  </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679053689"><a href="#local-6989586621679053689"><span class="hs-identifier">prod</span></a></a><span> </span><a name="local-6989586621679053690"><a href="#local-6989586621679053690"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679053691"><a href="#local-6989586621679053691"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">conP</span><span> </span><a href="Generics.Deriving.TH.Internal.html#productDataName"><span class="hs-identifier hs-var">productDataName</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679053690"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">,</span><a href="#local-6989586621679053691"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">]</span><span>
</span><a name="line-867"></a><span class="hs-identifier">toCon</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679053696"><a href="#local-6989586621679053696"><span class="hs-identifier">wrap</span></a></a><span> </span><a name="local-6989586621679053697"><a href="#local-6989586621679053697"><span class="hs-identifier">m</span></a></a><span> </span><a name="local-6989586621679053698"><a href="#local-6989586621679053698"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">RecC</span><span> </span><a name="local-6989586621679053699"><a href="#local-6989586621679053699"><span class="hs-identifier">cn</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-868"></a><span>    </span><span class="hs-identifier hs-var">match</span><span>
</span><a name="line-869"></a><span>      </span><span class="hs-special">(</span><a href="#local-6989586621679053696"><span class="hs-identifier hs-var">wrap</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Generics.Deriving.TH.html#lrP"><span class="hs-identifier hs-var">lrP</span></a><span> </span><a href="#local-6989586621679053697"><span class="hs-identifier hs-var">m</span></a><span> </span><a href="#local-6989586621679053698"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">conP</span><span> </span><a href="Generics.Deriving.TH.Internal.html#m1DataName"><span class="hs-identifier hs-var">m1DataName</span></a><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-var">conP</span><span> </span><a href="Generics.Deriving.TH.Internal.html#u1DataName"><span class="hs-identifier hs-var">u1DataName</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-870"></a><span>      </span><span class="hs-special">(</span><span class="hs-identifier hs-var">normalB</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">conE</span><span> </span><a href="#local-6989586621679053699"><span class="hs-identifier hs-var">cn</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-871"></a><span class="hs-identifier">toCon</span><span> </span><a name="local-6989586621679053700"><a href="#local-6989586621679053700"><span class="hs-identifier">gClass</span></a></a><span> </span><a name="local-6989586621679053701"><a href="#local-6989586621679053701"><span class="hs-identifier">wrap</span></a></a><span> </span><a name="local-6989586621679053702"><a href="#local-6989586621679053702"><span class="hs-identifier">m</span></a></a><span> </span><a name="local-6989586621679053703"><a href="#local-6989586621679053703"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">RecC</span><span> </span><a name="local-6989586621679053704"><a href="#local-6989586621679053704"><span class="hs-identifier">cn</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-872"></a><span>    </span><span class="hs-special">(</span><a name="local-6989586621679053708"><a href="#local-6989586621679053708"><span class="hs-identifier">ts</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679053709"><a href="#local-6989586621679053709"><span class="hs-identifier">gk</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><a href="Generics.Deriving.TH.Internal.html#shrink"><span class="hs-identifier hs-var">shrink</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Generics.Deriving.TH.Internal.html#reifyConTys"><span class="hs-identifier hs-var">reifyConTys</span></a><span> </span><a href="#local-6989586621679053700"><span class="hs-identifier hs-var">gClass</span></a><span> </span><a href="#local-6989586621679053704"><span class="hs-identifier hs-var">cn</span></a><span>
</span><a name="line-873"></a><span>    </span><a name="local-6989586621679053710"><a href="#local-6989586621679053710"><span class="hs-identifier">fNames</span></a></a><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Generics.Deriving.TH.Internal.html#newNameList"><span class="hs-identifier hs-var">newNameList</span></a><span> </span><span class="hs-string">&quot;f&quot;</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">length</span><span> </span><a href="#local-6989586621679053708"><span class="hs-identifier hs-var">ts</span></a><span>
</span><a name="line-874"></a><span>    </span><span class="hs-identifier hs-var">match</span><span>
</span><a name="line-875"></a><span>      </span><span class="hs-special">(</span><a href="#local-6989586621679053701"><span class="hs-identifier hs-var">wrap</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Generics.Deriving.TH.html#lrP"><span class="hs-identifier hs-var">lrP</span></a><span> </span><a href="#local-6989586621679053702"><span class="hs-identifier hs-var">m</span></a><span> </span><a href="#local-6989586621679053703"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">conP</span><span> </span><a href="Generics.Deriving.TH.Internal.html#m1DataName"><span class="hs-identifier hs-var">m1DataName</span></a><span>
</span><a name="line-876"></a><span>        </span><span class="hs-special">[</span><span class="hs-identifier hs-var">foldr1</span><span> </span><a href="#local-6989586621679053705"><span class="hs-identifier hs-var">prod</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">zipWith</span><span> </span><span class="hs-special">(</span><a href="Generics.Deriving.TH.html#toField"><span class="hs-identifier hs-var">toField</span></a><span> </span><a href="#local-6989586621679053709"><span class="hs-identifier hs-var">gk</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679053710"><span class="hs-identifier hs-var">fNames</span></a><span> </span><a href="#local-6989586621679053708"><span class="hs-identifier hs-var">ts</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-877"></a><span>      </span><span class="hs-special">(</span><span class="hs-identifier hs-var">normalB</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">foldl</span><span> </span><span class="hs-identifier hs-var">appE</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">conE</span><span> </span><a href="#local-6989586621679053704"><span class="hs-identifier hs-var">cn</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">zipWith</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679053711"><a href="#local-6989586621679053711"><span class="hs-identifier">nr</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Generics.Deriving.TH.Internal.html#expandSyn"><span class="hs-identifier hs-var">expandSyn</span></a><span> </span><span class="hs-operator hs-var">&gt;=&gt;</span><span> </span><a href="Generics.Deriving.TH.html#toConUnwC"><span class="hs-identifier hs-var">toConUnwC</span></a><span> </span><a href="#local-6989586621679053709"><span class="hs-identifier hs-var">gk</span></a><span> </span><a href="#local-6989586621679053711"><span class="hs-identifier hs-var">nr</span></a><span class="hs-special">)</span><span>
</span><a name="line-878"></a><span>                                               </span><a href="#local-6989586621679053710"><span class="hs-identifier hs-var">fNames</span></a><span> </span><a href="#local-6989586621679053708"><span class="hs-identifier hs-var">ts</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-879"></a><span>  </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679053705"><a href="#local-6989586621679053705"><span class="hs-identifier">prod</span></a></a><span> </span><a name="local-6989586621679053706"><a href="#local-6989586621679053706"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679053707"><a href="#local-6989586621679053707"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">conP</span><span> </span><a href="Generics.Deriving.TH.Internal.html#productDataName"><span class="hs-identifier hs-var">productDataName</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679053706"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">,</span><a href="#local-6989586621679053707"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">]</span><span>
</span><a name="line-880"></a><span class="hs-identifier">toCon</span><span> </span><a name="local-6989586621679053712"><a href="#local-6989586621679053712"><span class="hs-identifier">gk</span></a></a><span> </span><a name="local-6989586621679053713"><a href="#local-6989586621679053713"><span class="hs-identifier">wrap</span></a></a><span> </span><a name="local-6989586621679053714"><a href="#local-6989586621679053714"><span class="hs-identifier">m</span></a></a><span> </span><a name="local-6989586621679053715"><a href="#local-6989586621679053715"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">InfixC</span><span> </span><a name="local-6989586621679053716"><a href="#local-6989586621679053716"><span class="hs-identifier">t1</span></a></a><span> </span><a name="local-6989586621679053717"><a href="#local-6989586621679053717"><span class="hs-identifier">cn</span></a></a><span> </span><a name="local-6989586621679053718"><a href="#local-6989586621679053718"><span class="hs-identifier">t2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-881"></a><span>  </span><a href="Generics.Deriving.TH.html#toCon"><span class="hs-identifier hs-var">toCon</span></a><span> </span><a href="#local-6989586621679053712"><span class="hs-identifier hs-var">gk</span></a><span> </span><a href="#local-6989586621679053713"><span class="hs-identifier hs-var">wrap</span></a><span> </span><a href="#local-6989586621679053714"><span class="hs-identifier hs-var">m</span></a><span> </span><a href="#local-6989586621679053715"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">NormalC</span><span> </span><a href="#local-6989586621679053717"><span class="hs-identifier hs-var">cn</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679053716"><span class="hs-identifier hs-var">t1</span></a><span class="hs-special">,</span><a href="#local-6989586621679053718"><span class="hs-identifier hs-var">t2</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-882"></a><span class="hs-identifier">toCon</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679053719"><a href="#local-6989586621679053719"><span class="hs-identifier">con</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Generics.Deriving.TH.Internal.html#gadtError"><span class="hs-identifier hs-var">gadtError</span></a><span> </span><a href="#local-6989586621679053719"><span class="hs-identifier hs-var">con</span></a><span>
</span><a name="line-883"></a><span>
</span><a name="line-884"></a><span class="hs-identifier">toConUnwC</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Generics.Deriving.TH.Internal.html#GenericKind"><span class="hs-identifier hs-type">GenericKind</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Type</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Q</span><span> </span><span class="hs-identifier hs-type">Exp</span><span>
</span><a name="line-885"></a><a name="toConUnwC"><a href="Generics.Deriving.TH.html#toConUnwC"><span class="hs-identifier">toConUnwC</span></a></a><span> </span><a href="Generics.Deriving.TH.Internal.html#Gen0"><span class="hs-identifier hs-var">Gen0</span></a><span>          </span><a name="local-6989586621679053720"><a href="#local-6989586621679053720"><span class="hs-identifier">nr</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">varE</span><span> </span><a href="#local-6989586621679053720"><span class="hs-identifier hs-var">nr</span></a><span>
</span><a name="line-886"></a><span class="hs-identifier">toConUnwC</span><span> </span><span class="hs-special">(</span><a href="Generics.Deriving.TH.Internal.html#Gen1"><span class="hs-identifier hs-var">Gen1</span></a><span> </span><a name="local-6989586621679053721"><a href="#local-6989586621679053721"><span class="hs-identifier">name</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><a name="local-6989586621679053722"><a href="#local-6989586621679053722"><span class="hs-identifier">nr</span></a></a><span> </span><a name="local-6989586621679053723"><a href="#local-6989586621679053723"><span class="hs-identifier">t</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Generics.Deriving.TH.html#unwC"><span class="hs-identifier hs-var">unwC</span></a><span> </span><a href="#local-6989586621679053723"><span class="hs-identifier hs-var">t</span></a><span> </span><a href="#local-6989586621679053721"><span class="hs-identifier hs-var">name</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">appE</span><span class="hs-special">`</span><span> </span><span class="hs-identifier hs-var">varE</span><span> </span><a href="#local-6989586621679053722"><span class="hs-identifier hs-var">nr</span></a><span>
</span><a name="line-887"></a><span>
</span><a name="line-888"></a><span class="hs-identifier">toField</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Generics.Deriving.TH.Internal.html#GenericKind"><span class="hs-identifier hs-type">GenericKind</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Type</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Q</span><span> </span><span class="hs-identifier hs-type">Pat</span><span>
</span><a name="line-889"></a><a name="toField"><a href="Generics.Deriving.TH.html#toField"><span class="hs-identifier">toField</span></a></a><span> </span><a name="local-6989586621679053724"><a href="#local-6989586621679053724"><span class="hs-identifier">gk</span></a></a><span> </span><a name="local-6989586621679053725"><a href="#local-6989586621679053725"><span class="hs-identifier">nr</span></a></a><span> </span><a name="local-6989586621679053726"><a href="#local-6989586621679053726"><span class="hs-identifier">t</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">conP</span><span> </span><a href="Generics.Deriving.TH.Internal.html#m1DataName"><span class="hs-identifier hs-var">m1DataName</span></a><span> </span><span class="hs-special">[</span><a href="Generics.Deriving.TH.html#toFieldWrap"><span class="hs-identifier hs-var">toFieldWrap</span></a><span> </span><a href="#local-6989586621679053724"><span class="hs-identifier hs-var">gk</span></a><span> </span><a href="#local-6989586621679053725"><span class="hs-identifier hs-var">nr</span></a><span> </span><a href="#local-6989586621679053726"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">]</span><span>
</span><a name="line-890"></a><span>
</span><a name="line-891"></a><span class="hs-identifier">toFieldWrap</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Generics.Deriving.TH.Internal.html#GenericKind"><span class="hs-identifier hs-type">GenericKind</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Type</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Q</span><span> </span><span class="hs-identifier hs-type">Pat</span><span>
</span><a name="line-892"></a><a name="toFieldWrap"><a href="Generics.Deriving.TH.html#toFieldWrap"><span class="hs-identifier">toFieldWrap</span></a></a><span> </span><a href="Generics.Deriving.TH.Internal.html#Gen0"><span class="hs-identifier hs-var">Gen0</span></a><span>   </span><a name="local-6989586621679053727"><a href="#local-6989586621679053727"><span class="hs-identifier">nr</span></a></a><span> </span><a name="local-6989586621679053728"><a href="#local-6989586621679053728"><span class="hs-identifier">t</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">conP</span><span> </span><span class="hs-special">(</span><a href="Generics.Deriving.TH.html#boxRepName"><span class="hs-identifier hs-var">boxRepName</span></a><span> </span><a href="#local-6989586621679053728"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-var">varP</span><span> </span><a href="#local-6989586621679053727"><span class="hs-identifier hs-var">nr</span></a><span class="hs-special">]</span><span>
</span><a name="line-893"></a><span class="hs-identifier">toFieldWrap</span><span> </span><a href="Generics.Deriving.TH.Internal.html#Gen1"><span class="hs-identifier hs-var">Gen1</span></a><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><a name="local-6989586621679053729"><a href="#local-6989586621679053729"><span class="hs-identifier">nr</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">varP</span><span> </span><a href="#local-6989586621679053729"><span class="hs-identifier hs-var">nr</span></a><span>
</span><a name="line-894"></a><span>
</span><a name="line-895"></a><span class="hs-identifier">unwC</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Type</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Q</span><span> </span><span class="hs-identifier hs-type">Exp</span><span>
</span><a name="line-896"></a><a name="unwC"><a href="Generics.Deriving.TH.html#unwC"><span class="hs-identifier">unwC</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">SigT</span><span> </span><a name="local-6989586621679053730"><a href="#local-6989586621679053730"><span class="hs-identifier">t</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><a name="local-6989586621679053731"><a href="#local-6989586621679053731"><span class="hs-identifier">name</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Generics.Deriving.TH.html#unwC"><span class="hs-identifier hs-var">unwC</span></a><span> </span><a href="#local-6989586621679053730"><span class="hs-identifier hs-var">t</span></a><span> </span><a href="#local-6989586621679053731"><span class="hs-identifier hs-var">name</span></a><span>
</span><a name="line-897"></a><span class="hs-identifier">unwC</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">VarT</span><span> </span><a name="local-6989586621679053732"><a href="#local-6989586621679053732"><span class="hs-identifier">t</span></a></a><span class="hs-special">)</span><span>   </span><a name="local-6989586621679053733"><a href="#local-6989586621679053733"><span class="hs-identifier">name</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679053732"><span class="hs-identifier hs-var">t</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679053733"><span class="hs-identifier hs-var">name</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">varE</span><span> </span><a href="Generics.Deriving.TH.Internal.html#unPar1ValName"><span class="hs-identifier hs-var">unPar1ValName</span></a><span>
</span><a name="line-898"></a><span class="hs-identifier">unwC</span><span> </span><a name="local-6989586621679053734"><a href="#local-6989586621679053734"><span class="hs-identifier">t</span></a></a><span> </span><a name="local-6989586621679053735"><a href="#local-6989586621679053735"><span class="hs-identifier">name</span></a></a><span>
</span><a name="line-899"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="Generics.Deriving.TH.Internal.html#ground"><span class="hs-identifier hs-var">ground</span></a><span> </span><a href="#local-6989586621679053734"><span class="hs-identifier hs-var">t</span></a><span> </span><a href="#local-6989586621679053735"><span class="hs-identifier hs-var">name</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">varE</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Generics.Deriving.TH.html#unboxRepName"><span class="hs-identifier hs-var">unboxRepName</span></a><span> </span><a href="#local-6989586621679053734"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-900"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-901"></a><span>      </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679053736"><a href="#local-6989586621679053736"><span class="hs-identifier">tyHead</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679053737"><a href="#local-6989586621679053737"><span class="hs-identifier">tyArgs</span></a></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="Generics.Deriving.TH.Internal.html#unapplyTy"><span class="hs-identifier hs-var">unapplyTy</span></a><span> </span><a href="#local-6989586621679053734"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-902"></a><span>          </span><a name="local-6989586621679053738"><a href="#local-6989586621679053738"><span class="hs-identifier">numLastArgs</span></a></a><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">min</span><span> </span><span class="hs-number">1</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">length</span><span> </span><a href="#local-6989586621679053737"><span class="hs-identifier hs-var">tyArgs</span></a><span>
</span><a name="line-903"></a><span>          </span><span class="hs-special">(</span><a name="local-6989586621679053739"><a href="#local-6989586621679053739"><span class="hs-identifier">lhsArgs</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679053740"><a href="#local-6989586621679053740"><span class="hs-identifier">rhsArgs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">splitAt</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">length</span><span> </span><a href="#local-6989586621679053737"><span class="hs-identifier hs-var">tyArgs</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679053738"><span class="hs-identifier hs-var">numLastArgs</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679053737"><span class="hs-identifier hs-var">tyArgs</span></a><span>
</span><a name="line-904"></a><span>
</span><a name="line-905"></a><span>          </span><span class="hs-identifier">inspectTy</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Type</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Q</span><span> </span><span class="hs-identifier hs-type">Exp</span><span>
</span><a name="line-906"></a><span>          </span><a name="local-6989586621679053741"><a href="#local-6989586621679053741"><span class="hs-identifier">inspectTy</span></a></a><span> </span><span class="hs-identifier hs-var">ForallT</span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Generics.Deriving.TH.Internal.html#rankNError"><span class="hs-identifier hs-var">rankNError</span></a><span>
</span><a name="line-907"></a><span>          </span><span class="hs-identifier">inspectTy</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">SigT</span><span> </span><a name="local-6989586621679053742"><a href="#local-6989586621679053742"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679053741"><span class="hs-identifier hs-var">inspectTy</span></a><span> </span><a href="#local-6989586621679053742"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-908"></a><span>          </span><span class="hs-identifier">inspectTy</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">VarT</span><span> </span><a name="local-6989586621679053743"><a href="#local-6989586621679053743"><span class="hs-identifier">a</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-909"></a><span>            </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679053743"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679053735"><span class="hs-identifier hs-var">name</span></a><span>
</span><a name="line-910"></a><span>            </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">varE</span><span> </span><a href="Generics.Deriving.TH.Internal.html#unRec1ValName"><span class="hs-identifier hs-var">unRec1ValName</span></a><span>
</span><a name="line-911"></a><span>          </span><span class="hs-identifier">inspectTy</span><span> </span><a name="local-6989586621679053744"><a href="#local-6989586621679053744"><span class="hs-identifier">beta</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">infixApp</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">varE</span><span> </span><a href="Generics.Deriving.TH.Internal.html#fmapValName"><span class="hs-identifier hs-var">fmapValName</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">appE</span><span class="hs-special">`</span><span> </span><a href="Generics.Deriving.TH.html#unwC"><span class="hs-identifier hs-var">unwC</span></a><span> </span><a href="#local-6989586621679053744"><span class="hs-identifier hs-var">beta</span></a><span> </span><a href="#local-6989586621679053735"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">)</span><span>
</span><a name="line-912"></a><span>                                    </span><span class="hs-special">(</span><span class="hs-identifier hs-var">varE</span><span> </span><a href="Generics.Deriving.TH.Internal.html#composeValName"><span class="hs-identifier hs-var">composeValName</span></a><span class="hs-special">)</span><span>
</span><a name="line-913"></a><span>                                    </span><span class="hs-special">(</span><span class="hs-identifier hs-var">varE</span><span> </span><a href="Generics.Deriving.TH.Internal.html#unComp1ValName"><span class="hs-identifier hs-var">unComp1ValName</span></a><span class="hs-special">)</span><span>
</span><a name="line-914"></a><span>
</span><a name="line-915"></a><span>      </span><a name="local-6989586621679053745"><a href="#local-6989586621679053745"><span class="hs-identifier">itf</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Generics.Deriving.TH.Internal.html#isTyFamily"><span class="hs-identifier hs-var">isTyFamily</span></a><span> </span><a href="#local-6989586621679053736"><span class="hs-identifier hs-var">tyHead</span></a><span>
</span><a name="line-916"></a><span>      </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier hs-var">any</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-special">(</span><span class="hs-special">`</span><a href="Generics.Deriving.TH.Internal.html#ground"><span class="hs-identifier hs-var">ground</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679053735"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679053739"><span class="hs-identifier hs-var">lhsArgs</span></a><span>
</span><a name="line-917"></a><span>           </span><span class="hs-operator hs-var">||</span><span> </span><span class="hs-identifier hs-var">any</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-special">(</span><span class="hs-special">`</span><a href="Generics.Deriving.TH.Internal.html#ground"><span class="hs-identifier hs-var">ground</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679053735"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679053737"><span class="hs-identifier hs-var">tyArgs</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="#local-6989586621679053745"><span class="hs-identifier hs-var">itf</span></a><span>
</span><a name="line-918"></a><span>         </span><span class="hs-keyword">then</span><span> </span><a href="Generics.Deriving.TH.Internal.html#outOfPlaceTyVarError"><span class="hs-identifier hs-var">outOfPlaceTyVarError</span></a><span>
</span><a name="line-919"></a><span>         </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679053740"><span class="hs-identifier hs-var">rhsArgs</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-920"></a><span>              </span><span class="hs-special">[</span><span class="hs-special">]</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">varE</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Generics.Deriving.TH.html#unboxRepName"><span class="hs-identifier hs-var">unboxRepName</span></a><span> </span><a href="#local-6989586621679053734"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-921"></a><span>              </span><a name="local-6989586621679053746"><a href="#local-6989586621679053746"><span class="hs-identifier">ty</span></a></a><span class="hs-glyph">:</span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679053741"><span class="hs-identifier hs-var">inspectTy</span></a><span> </span><a href="#local-6989586621679053746"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-922"></a><span>
</span><a name="line-923"></a><span class="hs-identifier">unboxRepName</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Type</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Name</span><span>
</span><a name="line-924"></a><a name="unboxRepName"><a href="Generics.Deriving.TH.html#unboxRepName"><span class="hs-identifier">unboxRepName</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">maybe</span><span> </span><a href="Generics.Deriving.TH.Internal.html#unK1ValName"><span class="hs-identifier hs-var">unK1ValName</span></a><span> </span><a href="Generics.Deriving.TH.Internal.html#trd3"><span class="hs-identifier hs-var">trd3</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Generics.Deriving.TH.html#unboxedRepNames"><span class="hs-identifier hs-var">unboxedRepNames</span></a><span>
</span><a name="line-925"></a><span>
</span><a name="line-926"></a><span class="hs-identifier">lrP</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Q</span><span> </span><span class="hs-identifier hs-type">Pat</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Q</span><span> </span><span class="hs-identifier hs-type">Pat</span><span class="hs-special">)</span><span>
</span><a name="line-927"></a><a name="lrP"><a href="Generics.Deriving.TH.html#lrP"><span class="hs-identifier">lrP</span></a></a><span> </span><span class="hs-number">1</span><span> </span><span class="hs-number">0</span><span> </span><a name="local-6989586621679053747"><a href="#local-6989586621679053747"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679053747"><span class="hs-identifier hs-var">p</span></a><span>
</span><a name="line-928"></a><span class="hs-identifier">lrP</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-number">0</span><span> </span><a name="local-6989586621679053748"><a href="#local-6989586621679053748"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">conP</span><span> </span><a href="Generics.Deriving.TH.Internal.html#l1DataName"><span class="hs-identifier hs-var">l1DataName</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679053748"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">]</span><span>
</span><a name="line-929"></a><span class="hs-identifier">lrP</span><span> </span><a name="local-6989586621679053749"><a href="#local-6989586621679053749"><span class="hs-identifier">m</span></a></a><span> </span><a name="local-6989586621679053750"><a href="#local-6989586621679053750"><span class="hs-identifier">i</span></a></a><span> </span><a name="local-6989586621679053751"><a href="#local-6989586621679053751"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">conP</span><span> </span><a href="Generics.Deriving.TH.Internal.html#r1DataName"><span class="hs-identifier hs-var">r1DataName</span></a><span> </span><span class="hs-special">[</span><a href="Generics.Deriving.TH.html#lrP"><span class="hs-identifier hs-var">lrP</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679053749"><span class="hs-identifier hs-var">m</span></a><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679053750"><span class="hs-identifier hs-var">i</span></a><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679053751"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">]</span><span>
</span><a name="line-930"></a><span>
</span><a name="line-931"></a><span class="hs-identifier">lrE</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Q</span><span> </span><span class="hs-identifier hs-type">Exp</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Q</span><span> </span><span class="hs-identifier hs-type">Exp</span><span class="hs-special">)</span><span>
</span><a name="line-932"></a><a name="lrE"><a href="Generics.Deriving.TH.html#lrE"><span class="hs-identifier">lrE</span></a></a><span> </span><span class="hs-number">1</span><span> </span><span class="hs-number">0</span><span> </span><a name="local-6989586621679053752"><a href="#local-6989586621679053752"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679053752"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-933"></a><span class="hs-identifier">lrE</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-number">0</span><span> </span><a name="local-6989586621679053753"><a href="#local-6989586621679053753"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">conE</span><span> </span><a href="Generics.Deriving.TH.Internal.html#l1DataName"><span class="hs-identifier hs-var">l1DataName</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">appE</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621679053753"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-934"></a><span class="hs-identifier">lrE</span><span> </span><a name="local-6989586621679053754"><a href="#local-6989586621679053754"><span class="hs-identifier">m</span></a></a><span> </span><a name="local-6989586621679053755"><a href="#local-6989586621679053755"><span class="hs-identifier">i</span></a></a><span> </span><a name="local-6989586621679053756"><a href="#local-6989586621679053756"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">conE</span><span> </span><a href="Generics.Deriving.TH.Internal.html#r1DataName"><span class="hs-identifier hs-var">r1DataName</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">appE</span><span class="hs-special">`</span><span> </span><a href="Generics.Deriving.TH.html#lrE"><span class="hs-identifier hs-var">lrE</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679053754"><span class="hs-identifier hs-var">m</span></a><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679053755"><span class="hs-identifier hs-var">i</span></a><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679053756"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-935"></a><span>
</span><a name="line-936"></a><span class="hs-identifier">unboxedRepNames</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Type</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Name</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Name</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Name</span><span class="hs-special">)</span><span>
</span><a name="line-937"></a><a name="unboxedRepNames"><a href="Generics.Deriving.TH.html#unboxedRepNames"><span class="hs-identifier">unboxedRepNames</span></a></a><span> </span><a name="local-6989586621679053757"><a href="#local-6989586621679053757"><span class="hs-identifier">ty</span></a></a><span>
</span><a name="line-938"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679053757"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">ConT</span><span> </span><a href="Generics.Deriving.TH.Internal.html#addrHashTypeName"><span class="hs-identifier hs-var">addrHashTypeName</span></a><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="Generics.Deriving.TH.Internal.html#uAddrTypeName"><span class="hs-identifier hs-var">uAddrTypeName</span></a><span class="hs-special">,</span><span>   </span><a href="Generics.Deriving.TH.Internal.html#uAddrDataName"><span class="hs-identifier hs-var">uAddrDataName</span></a><span class="hs-special">,</span><span>   </span><a href="Generics.Deriving.TH.Internal.html#uAddrHashValName"><span class="hs-identifier hs-var">uAddrHashValName</span></a><span class="hs-special">)</span><span>
</span><a name="line-939"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679053757"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">ConT</span><span> </span><a href="Generics.Deriving.TH.Internal.html#charHashTypeName"><span class="hs-identifier hs-var">charHashTypeName</span></a><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="Generics.Deriving.TH.Internal.html#uCharTypeName"><span class="hs-identifier hs-var">uCharTypeName</span></a><span class="hs-special">,</span><span>   </span><a href="Generics.Deriving.TH.Internal.html#uCharDataName"><span class="hs-identifier hs-var">uCharDataName</span></a><span class="hs-special">,</span><span>   </span><a href="Generics.Deriving.TH.Internal.html#uCharHashValName"><span class="hs-identifier hs-var">uCharHashValName</span></a><span class="hs-special">)</span><span>
</span><a name="line-940"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679053757"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">ConT</span><span> </span><a href="Generics.Deriving.TH.Internal.html#doubleHashTypeName"><span class="hs-identifier hs-var">doubleHashTypeName</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="Generics.Deriving.TH.Internal.html#uDoubleTypeName"><span class="hs-identifier hs-var">uDoubleTypeName</span></a><span class="hs-special">,</span><span> </span><a href="Generics.Deriving.TH.Internal.html#uDoubleDataName"><span class="hs-identifier hs-var">uDoubleDataName</span></a><span class="hs-special">,</span><span> </span><a href="Generics.Deriving.TH.Internal.html#uDoubleHashValName"><span class="hs-identifier hs-var">uDoubleHashValName</span></a><span class="hs-special">)</span><span>
</span><a name="line-941"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679053757"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">ConT</span><span> </span><a href="Generics.Deriving.TH.Internal.html#floatHashTypeName"><span class="hs-identifier hs-var">floatHashTypeName</span></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="Generics.Deriving.TH.Internal.html#uFloatTypeName"><span class="hs-identifier hs-var">uFloatTypeName</span></a><span class="hs-special">,</span><span>  </span><a href="Generics.Deriving.TH.Internal.html#uFloatDataName"><span class="hs-identifier hs-var">uFloatDataName</span></a><span class="hs-special">,</span><span>  </span><a href="Generics.Deriving.TH.Internal.html#uFloatHashValName"><span class="hs-identifier hs-var">uFloatHashValName</span></a><span class="hs-special">)</span><span>
</span><a name="line-942"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679053757"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">ConT</span><span> </span><a href="Generics.Deriving.TH.Internal.html#intHashTypeName"><span class="hs-identifier hs-var">intHashTypeName</span></a><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="Generics.Deriving.TH.Internal.html#uIntTypeName"><span class="hs-identifier hs-var">uIntTypeName</span></a><span class="hs-special">,</span><span>    </span><a href="Generics.Deriving.TH.Internal.html#uIntDataName"><span class="hs-identifier hs-var">uIntDataName</span></a><span class="hs-special">,</span><span>    </span><a href="Generics.Deriving.TH.Internal.html#uIntHashValName"><span class="hs-identifier hs-var">uIntHashValName</span></a><span class="hs-special">)</span><span>
</span><a name="line-943"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679053757"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">ConT</span><span> </span><a href="Generics.Deriving.TH.Internal.html#wordHashTypeName"><span class="hs-identifier hs-var">wordHashTypeName</span></a><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="Generics.Deriving.TH.Internal.html#uWordTypeName"><span class="hs-identifier hs-var">uWordTypeName</span></a><span class="hs-special">,</span><span>   </span><a href="Generics.Deriving.TH.Internal.html#uWordDataName"><span class="hs-identifier hs-var">uWordDataName</span></a><span class="hs-special">,</span><span>   </span><a href="Generics.Deriving.TH.Internal.html#uWordHashValName"><span class="hs-identifier hs-var">uWordHashValName</span></a><span class="hs-special">)</span><span>
</span><a name="line-944"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>                     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-945"></a><span>
</span><a name="line-946"></a><span class="hs-comment">-- | Deduces the instance type (and kind) to use for a Generic(1) instance.</span><span>
</span><a name="line-947"></a><span class="hs-identifier">buildTypeInstance</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Generics.Deriving.TH.Internal.html#GenericClass"><span class="hs-identifier hs-type">GenericClass</span></a><span>
</span><a name="line-948"></a><span>                  </span><span class="hs-comment">-- ^ Generic or Generic1</span><span>
</span><a name="line-949"></a><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Generics.Deriving.TH.html#KindSigOptions"><span class="hs-identifier hs-type">KindSigOptions</span></a><span>
</span><a name="line-950"></a><span>                  </span><span class="hs-comment">-- ^ Whether or not to use explicit kind signatures in the instance type</span><span>
</span><a name="line-951"></a><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Name</span><span>
</span><a name="line-952"></a><span>                  </span><span class="hs-comment">-- ^ The type constructor or data family name</span><span>
</span><a name="line-953"></a><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">TyVarBndr</span><span class="hs-special">]</span><span>
</span><a name="line-954"></a><span>                  </span><span class="hs-comment">-- ^ The type variables from the data type/data family declaration</span><span>
</span><a name="line-955"></a><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Generics.Deriving.TH.Internal.html#DataVariety"><span class="hs-identifier hs-type">DataVariety</span></a><span>
</span><a name="line-956"></a><span>                  </span><span class="hs-comment">-- ^ If using a data family instance, provides the types used</span><span>
</span><a name="line-957"></a><span>                  </span><span class="hs-comment">-- to instantiate the instance</span><span>
</span><a name="line-958"></a><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Q</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Type</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Kind</span><span class="hs-special">)</span><span>
</span><a name="line-959"></a><span class="hs-comment">-- Plain data type/newtype case</span><span>
</span><a name="line-960"></a><a name="buildTypeInstance"><a href="Generics.Deriving.TH.html#buildTypeInstance"><span class="hs-identifier">buildTypeInstance</span></a></a><span> </span><a name="local-6989586621679053758"><a href="#local-6989586621679053758"><span class="hs-identifier">gClass</span></a></a><span> </span><a name="local-6989586621679053759"><a href="#local-6989586621679053759"><span class="hs-identifier">useKindSigs</span></a></a><span> </span><a name="local-6989586621679053760"><a href="#local-6989586621679053760"><span class="hs-identifier">tyConName</span></a></a><span> </span><a name="local-6989586621679053761"><a href="#local-6989586621679053761"><span class="hs-identifier">tvbs</span></a></a><span> </span><a href="Generics.Deriving.TH.Internal.html#DataPlain"><span class="hs-identifier hs-var">DataPlain</span></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-961"></a><span>    </span><span class="hs-keyword">let</span><span> </span><span class="hs-identifier">varTys</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Type</span><span class="hs-special">]</span><span>
</span><a name="line-962"></a><span>        </span><a name="local-6989586621679053762"><a href="#local-6989586621679053762"><span class="hs-identifier">varTys</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><a href="Generics.Deriving.TH.Internal.html#tyVarBndrToType"><span class="hs-identifier hs-var">tyVarBndrToType</span></a><span> </span><a href="#local-6989586621679053761"><span class="hs-identifier hs-var">tvbs</span></a><span>
</span><a name="line-963"></a><span>    </span><span class="hs-keyword">in</span><span> </span><a href="Generics.Deriving.TH.html#buildTypeInstanceFromTys"><span class="hs-identifier hs-var">buildTypeInstanceFromTys</span></a><span> </span><a href="#local-6989586621679053758"><span class="hs-identifier hs-var">gClass</span></a><span> </span><a href="#local-6989586621679053759"><span class="hs-identifier hs-var">useKindSigs</span></a><span> </span><a href="#local-6989586621679053760"><span class="hs-identifier hs-var">tyConName</span></a><span> </span><a href="#local-6989586621679053762"><span class="hs-identifier hs-var">varTys</span></a><span>
</span><a name="line-964"></a><span class="hs-comment">-- Data family instance case</span><span>
</span><a name="line-965"></a><span class="hs-comment">--</span><span>
</span><a name="line-966"></a><span class="hs-comment">-- The CPP is present to work around a couple of annoying old GHC bugs.</span><span>
</span><a name="line-967"></a><span class="hs-comment">-- See Note [Polykinded data families in Template Haskell]</span><span>
</span><a name="line-968"></a><span class="hs-identifier">buildTypeInstance</span><span> </span><a name="local-6989586621679053763"><a href="#local-6989586621679053763"><span class="hs-identifier">gClass</span></a></a><span> </span><a name="local-6989586621679053764"><a href="#local-6989586621679053764"><span class="hs-identifier">useKindSigs</span></a></a><span> </span><a name="local-6989586621679053765"><a href="#local-6989586621679053765"><span class="hs-identifier">parentName</span></a></a><span> </span><a name="local-6989586621679053766"><a href="#local-6989586621679053766"><span class="hs-identifier">tvbs</span></a></a><span> </span><span class="hs-special">(</span><a href="Generics.Deriving.TH.Internal.html#DataFamily"><span class="hs-identifier hs-var">DataFamily</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679053767"><a href="#local-6989586621679053767"><span class="hs-identifier">instTysAndKinds</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-969"></a><span class="hs-cpp">#if !(MIN_VERSION_template_haskell(2,8,0)) || MIN_VERSION_template_haskell(2,10,0)</span><span>
</span><a name="line-970"></a><span>    </span><span class="hs-keyword">let</span><span> </span><span class="hs-identifier">instTys</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Type</span><span class="hs-special">]</span><span>
</span><a name="line-971"></a><span>        </span><a name="local-6989586621679053768"><a href="#local-6989586621679053768"><span class="hs-identifier">instTys</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">zipWith</span><span> </span><a href="Generics.Deriving.TH.Internal.html#stealKindForType"><span class="hs-identifier hs-var">stealKindForType</span></a><span> </span><a href="#local-6989586621679053766"><span class="hs-identifier hs-var">tvbs</span></a><span> </span><a href="#local-6989586621679053767"><span class="hs-identifier hs-var">instTysAndKinds</span></a><span>
</span><a name="line-972"></a><span class="hs-cpp">#else</span><span>
</span><a name="line-973"></a><span>    </span><span class="hs-keyword">let</span><span> </span><span class="hs-identifier">kindVarNames</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">Name</span><span class="hs-special">]</span><span>
</span><a name="line-974"></a><span>        </span><span class="hs-identifier">kindVarNames</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">nub</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">concatMap</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">tyVarNamesOfType</span><span> </span><span class="hs-operator">.</span><span> </span><span class="hs-identifier">tyVarBndrKind</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">tvbs</span><span>
</span><a name="line-975"></a><span>
</span><a name="line-976"></a><span>        </span><span class="hs-identifier">numKindVars</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Int</span><span>
</span><a name="line-977"></a><span>        </span><span class="hs-identifier">numKindVars</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">length</span><span> </span><span class="hs-identifier">kindVarNames</span><span>
</span><a name="line-978"></a><span>
</span><a name="line-979"></a><span>        </span><span class="hs-identifier">givenKinds</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">givenKinds'</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">Kind</span><span class="hs-special">]</span><span>
</span><a name="line-980"></a><span>        </span><span class="hs-identifier">givenTys</span><span>                </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">Type</span><span class="hs-special">]</span><span>
</span><a name="line-981"></a><span>        </span><span class="hs-special">(</span><span class="hs-identifier">givenKinds</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">givenTys</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">splitAt</span><span> </span><span class="hs-identifier">numKindVars</span><span> </span><span class="hs-identifier">instTysAndKinds</span><span>
</span><a name="line-982"></a><span>        </span><span class="hs-identifier">givenKinds'</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">map</span><span> </span><span class="hs-identifier">sanitizeStars</span><span> </span><span class="hs-identifier">givenKinds</span><span>
</span><a name="line-983"></a><span>
</span><a name="line-984"></a><span>        </span><span class="hs-comment">-- A GHC 7.6-specific bug requires us to replace all occurrences of</span><span>
</span><a name="line-985"></a><span>        </span><span class="hs-comment">-- (ConT GHC.Prim.*) with StarT, or else Template Haskell will reject it.</span><span>
</span><a name="line-986"></a><span>        </span><span class="hs-comment">-- Luckily, (ConT GHC.Prim.*) only seems to occur in this one spot.</span><span>
</span><a name="line-987"></a><span>        </span><span class="hs-identifier">sanitizeStars</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Kind</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Kind</span><span>
</span><a name="line-988"></a><span>        </span><span class="hs-identifier">sanitizeStars</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">go</span><span>
</span><a name="line-989"></a><span>          </span><span class="hs-keyword">where</span><span>
</span><a name="line-990"></a><span>            </span><span class="hs-identifier">go</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Kind</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Kind</span><span>
</span><a name="line-991"></a><span>            </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">AppT</span><span> </span><span class="hs-identifier">t1</span><span> </span><span class="hs-identifier">t2</span><span class="hs-special">)</span><span>                 </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">AppT</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">go</span><span> </span><span class="hs-identifier">t1</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">go</span><span> </span><span class="hs-identifier">t2</span><span class="hs-special">)</span><span>
</span><a name="line-992"></a><span>            </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">SigT</span><span> </span><span class="hs-identifier">t</span><span> </span><span class="hs-identifier">k</span><span class="hs-special">)</span><span>                   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">SigT</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">go</span><span> </span><span class="hs-identifier">t</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">go</span><span> </span><span class="hs-identifier">k</span><span class="hs-special">)</span><span>
</span><a name="line-993"></a><span>            </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ConT</span><span> </span><span class="hs-identifier">n</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-operator">==</span><span> </span><span class="hs-identifier">starKindName</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">StarT</span><span>
</span><a name="line-994"></a><span>            </span><span class="hs-identifier">go</span><span> </span><span class="hs-identifier">t</span><span>                            </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">t</span><span>
</span><a name="line-995"></a><span>
</span><a name="line-996"></a><span>    </span><span class="hs-comment">-- If we run this code with GHC 7.8, we might have to generate extra type</span><span>
</span><a name="line-997"></a><span>    </span><span class="hs-comment">-- variables to compensate for any type variables that Template Haskell</span><span>
</span><a name="line-998"></a><span>    </span><span class="hs-comment">-- eta-reduced away.</span><span>
</span><a name="line-999"></a><span>    </span><span class="hs-comment">-- See Note [Polykinded data families in Template Haskell]</span><span>
</span><a name="line-1000"></a><span>    </span><span class="hs-identifier">xTypeNames</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">newNameList</span><span> </span><span class="hs-string">&quot;tExtra&quot;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">length</span><span> </span><span class="hs-identifier">tvbs</span><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-identifier">length</span><span> </span><span class="hs-identifier">givenTys</span><span class="hs-special">)</span><span>
</span><a name="line-1001"></a><span>
</span><a name="line-1002"></a><span>    </span><span class="hs-keyword">let</span><span> </span><span class="hs-identifier">xTys</span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">Type</span><span class="hs-special">]</span><span>
</span><a name="line-1003"></a><span>        </span><span class="hs-comment">-- Because these type variables were eta-reduced away, we can only</span><span>
</span><a name="line-1004"></a><span>        </span><span class="hs-comment">-- determine their kind by using stealKindForType. Therefore, we mark</span><span>
</span><a name="line-1005"></a><span>        </span><span class="hs-comment">-- them as VarT to ensure they will be given an explicit kind annotation</span><span>
</span><a name="line-1006"></a><span>        </span><span class="hs-comment">-- (and so the kind inference machinery has the right information).</span><span>
</span><a name="line-1007"></a><span>        </span><span class="hs-identifier">xTys</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">map</span><span> </span><span class="hs-identifier">VarT</span><span> </span><span class="hs-identifier">xTypeNames</span><span>
</span><a name="line-1008"></a><span>
</span><a name="line-1009"></a><span>        </span><span class="hs-identifier">substNamesWithKinds</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-identifier">Name</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">Kind</span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Type</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Type</span><span>
</span><a name="line-1010"></a><span>        </span><span class="hs-identifier">substNamesWithKinds</span><span> </span><span class="hs-identifier">nks</span><span> </span><span class="hs-identifier">t</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">foldr'</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">uncurry</span><span> </span><span class="hs-identifier">substNameWithKind</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">t</span><span> </span><span class="hs-identifier">nks</span><span>
</span><a name="line-1011"></a><span>
</span><a name="line-1012"></a><span>        </span><span class="hs-comment">-- The types from the data family instance might not have explicit kind</span><span>
</span><a name="line-1013"></a><span>        </span><span class="hs-comment">-- annotations, which the kind machinery needs to work correctly. To</span><span>
</span><a name="line-1014"></a><span>        </span><span class="hs-comment">-- compensate, we use stealKindForType to explicitly annotate any</span><span>
</span><a name="line-1015"></a><span>        </span><span class="hs-comment">-- types without kind annotations.</span><span>
</span><a name="line-1016"></a><span>        </span><span class="hs-identifier">instTys</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">Type</span><span class="hs-special">]</span><span>
</span><a name="line-1017"></a><span>        </span><span class="hs-identifier">instTys</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">map</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">substNamesWithKinds</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">zip</span><span> </span><span class="hs-identifier">kindVarNames</span><span> </span><span class="hs-identifier">givenKinds'</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1018"></a><span>                  </span><span class="hs-comment">-- Note that due to a GHC 7.8-specific bug</span><span>
</span><a name="line-1019"></a><span>                  </span><span class="hs-comment">-- (see Note [Polykinded data families in Template Haskell]),</span><span>
</span><a name="line-1020"></a><span>                  </span><span class="hs-comment">-- there may be more kind variable names than there are kinds</span><span>
</span><a name="line-1021"></a><span>                  </span><span class="hs-comment">-- to substitute. But this is OK! If a kind is eta-reduced, it</span><span>
</span><a name="line-1022"></a><span>                  </span><span class="hs-comment">-- means that is was not instantiated to something more specific,</span><span>
</span><a name="line-1023"></a><span>                  </span><span class="hs-comment">-- so we need not substitute it. Using stealKindForType will</span><span>
</span><a name="line-1024"></a><span>                  </span><span class="hs-comment">-- grab the correct kind.</span><span>
</span><a name="line-1025"></a><span>                </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">zipWith</span><span> </span><span class="hs-identifier">stealKindForType</span><span> </span><span class="hs-identifier">tvbs</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">givenTys</span><span> </span><span class="hs-operator">++</span><span> </span><span class="hs-identifier">xTys</span><span class="hs-special">)</span><span>
</span><a name="line-1026"></a><span class="hs-cpp">#endif</span><span>
</span><a name="line-1027"></a><span>    </span><a href="Generics.Deriving.TH.html#buildTypeInstanceFromTys"><span class="hs-identifier hs-var">buildTypeInstanceFromTys</span></a><span> </span><a href="#local-6989586621679053763"><span class="hs-identifier hs-var">gClass</span></a><span> </span><a href="#local-6989586621679053764"><span class="hs-identifier hs-var">useKindSigs</span></a><span> </span><a href="#local-6989586621679053765"><span class="hs-identifier hs-var">parentName</span></a><span> </span><a href="#local-6989586621679053768"><span class="hs-identifier hs-var">instTys</span></a><span>
</span><a name="line-1028"></a><span>
</span><a name="line-1029"></a><span class="hs-comment">-- For the given Types, deduces the instance type (and kind) to use for a</span><span>
</span><a name="line-1030"></a><span class="hs-comment">-- Generic(1) instance. Coming up with the instance type isn't as simple as</span><span>
</span><a name="line-1031"></a><span class="hs-comment">-- dropping the last types, as you need to be wary of kinds being instantiated</span><span>
</span><a name="line-1032"></a><span class="hs-comment">-- with *.</span><span>
</span><a name="line-1033"></a><span class="hs-comment">-- See Note [Type inference in derived instances]</span><span>
</span><a name="line-1034"></a><span class="hs-identifier">buildTypeInstanceFromTys</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Generics.Deriving.TH.Internal.html#GenericClass"><span class="hs-identifier hs-type">GenericClass</span></a><span>
</span><a name="line-1035"></a><span>                         </span><span class="hs-comment">-- ^ Generic or Generic1</span><span>
</span><a name="line-1036"></a><span>                         </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Generics.Deriving.TH.html#KindSigOptions"><span class="hs-identifier hs-type">KindSigOptions</span></a><span>
</span><a name="line-1037"></a><span>                         </span><span class="hs-comment">-- ^ Whether or not to use explicit kind signatures in the instance type</span><span>
</span><a name="line-1038"></a><span>                         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Name</span><span>
</span><a name="line-1039"></a><span>                         </span><span class="hs-comment">-- ^ The type constructor or data family name</span><span>
</span><a name="line-1040"></a><span>                         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Type</span><span class="hs-special">]</span><span>
</span><a name="line-1041"></a><span>                         </span><span class="hs-comment">-- ^ The types to instantiate the instance with</span><span>
</span><a name="line-1042"></a><span>                         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Q</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Type</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Kind</span><span class="hs-special">)</span><span>
</span><a name="line-1043"></a><a name="buildTypeInstanceFromTys"><a href="Generics.Deriving.TH.html#buildTypeInstanceFromTys"><span class="hs-identifier">buildTypeInstanceFromTys</span></a></a><span> </span><a name="local-6989586621679053769"><a href="#local-6989586621679053769"><span class="hs-identifier">gClass</span></a></a><span> </span><a name="local-6989586621679053770"><a href="#local-6989586621679053770"><span class="hs-identifier">useKindSigs</span></a></a><span> </span><a name="local-6989586621679053771"><a href="#local-6989586621679053771"><span class="hs-identifier">tyConName</span></a></a><span> </span><a name="local-6989586621679053772"><a href="#local-6989586621679053772"><span class="hs-identifier">varTysOrig</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-1044"></a><span>    </span><span class="hs-comment">-- Make sure to expand through type/kind synonyms! Otherwise, the</span><span>
</span><a name="line-1045"></a><span>    </span><span class="hs-comment">-- eta-reduction check might get tripped up over type variables in a</span><span>
</span><a name="line-1046"></a><span>    </span><span class="hs-comment">-- synonym that are actually dropped.</span><span>
</span><a name="line-1047"></a><span>    </span><span class="hs-comment">-- (See GHC Trac #11416 for a scenario where this actually happened.)</span><span>
</span><a name="line-1048"></a><span>    </span><a name="local-6989586621679053773"><a href="#local-6989586621679053773"><span class="hs-identifier">varTysExp</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">mapM</span><span> </span><a href="Generics.Deriving.TH.Internal.html#expandSyn"><span class="hs-identifier hs-var">expandSyn</span></a><span> </span><a href="#local-6989586621679053772"><span class="hs-identifier hs-var">varTysOrig</span></a><span>
</span><a name="line-1049"></a><span>
</span><a name="line-1050"></a><span>    </span><span class="hs-keyword">let</span><span> </span><span class="hs-identifier">remainingLength</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-1051"></a><span>        </span><a name="local-6989586621679053774"><a href="#local-6989586621679053774"><span class="hs-identifier">remainingLength</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">length</span><span> </span><a href="#local-6989586621679053772"><span class="hs-identifier hs-var">varTysOrig</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-identifier hs-var">fromEnum</span><span> </span><a href="#local-6989586621679053769"><span class="hs-identifier hs-var">gClass</span></a><span>
</span><a name="line-1052"></a><span>
</span><a name="line-1053"></a><span>        </span><span class="hs-identifier">droppedTysExp</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Type</span><span class="hs-special">]</span><span>
</span><a name="line-1054"></a><span>        </span><a name="local-6989586621679053775"><a href="#local-6989586621679053775"><span class="hs-identifier">droppedTysExp</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">drop</span><span> </span><a href="#local-6989586621679053774"><span class="hs-identifier hs-var">remainingLength</span></a><span> </span><a href="#local-6989586621679053773"><span class="hs-identifier hs-var">varTysExp</span></a><span>
</span><a name="line-1055"></a><span>
</span><a name="line-1056"></a><span>        </span><span class="hs-identifier">droppedStarKindStati</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Generics.Deriving.TH.Internal.html#StarKindStatus"><span class="hs-identifier hs-type">StarKindStatus</span></a><span class="hs-special">]</span><span>
</span><a name="line-1057"></a><span>        </span><a name="local-6989586621679053776"><a href="#local-6989586621679053776"><span class="hs-identifier">droppedStarKindStati</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><a href="Generics.Deriving.TH.Internal.html#canRealizeKindStar"><span class="hs-identifier hs-var">canRealizeKindStar</span></a><span> </span><a href="#local-6989586621679053775"><span class="hs-identifier hs-var">droppedTysExp</span></a><span>
</span><a name="line-1058"></a><span>
</span><a name="line-1059"></a><span>    </span><span class="hs-comment">-- Check there are enough types to drop and that all of them are either of</span><span>
</span><a name="line-1060"></a><span>    </span><span class="hs-comment">-- kind * or kind k (for some kind variable k). If not, throw an error.</span><span>
</span><a name="line-1061"></a><span>    </span><span class="hs-identifier hs-var">when</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679053774"><span class="hs-identifier hs-var">remainingLength</span></a><span> </span><span class="hs-operator hs-var">&lt;</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-operator hs-var">||</span><span> </span><span class="hs-identifier hs-var">any</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">==</span><span> </span><a href="Generics.Deriving.TH.Internal.html#NotKindStar"><span class="hs-identifier hs-var">NotKindStar</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679053776"><span class="hs-identifier hs-var">droppedStarKindStati</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-1062"></a><span>      </span><a href="Generics.Deriving.TH.Internal.html#derivingKindError"><span class="hs-identifier hs-var">derivingKindError</span></a><span> </span><a href="#local-6989586621679053771"><span class="hs-identifier hs-var">tyConName</span></a><span>
</span><a name="line-1063"></a><span>
</span><a name="line-1064"></a><span>        </span><span class="hs-comment">-- Substitute kind * for any dropped kind variables</span><span>
</span><a name="line-1065"></a><span>    </span><span class="hs-keyword">let</span><span> </span><span class="hs-identifier">varTysExpSubst</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Type</span><span class="hs-special">]</span><span>
</span><a name="line-1066"></a><span class="hs-comment">-- See Note [Generic1 is polykinded in base-4.10]</span><span>
</span><a name="line-1067"></a><span class="hs-cpp">#if MIN_VERSION_base(4,10,0)</span><span>
</span><a name="line-1068"></a><span>        </span><span class="hs-identifier">varTysExpSubst</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">varTysExp</span><span>
</span><a name="line-1069"></a><span class="hs-cpp">#else</span><span>
</span><a name="line-1070"></a><span>        </span><a name="local-6989586621679053777"><a href="#local-6989586621679053777"><span class="hs-identifier">varTysExpSubst</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><a href="Generics.Deriving.TH.Internal.html#substNamesWithKindStar"><span class="hs-identifier hs-var">substNamesWithKindStar</span></a><span> </span><a href="#local-6989586621679053778"><span class="hs-identifier hs-var">droppedKindVarNames</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679053773"><span class="hs-identifier hs-var">varTysExp</span></a><span>
</span><a name="line-1071"></a><span>
</span><a name="line-1072"></a><span>        </span><span class="hs-identifier">droppedKindVarNames</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Name</span><span class="hs-special">]</span><span>
</span><a name="line-1073"></a><span>        </span><a name="local-6989586621679053778"><a href="#local-6989586621679053778"><span class="hs-identifier">droppedKindVarNames</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Generics.Deriving.TH.Internal.html#catKindVarNames"><span class="hs-identifier hs-var">catKindVarNames</span></a><span> </span><a href="#local-6989586621679053776"><span class="hs-identifier hs-var">droppedStarKindStati</span></a><span>
</span><a name="line-1074"></a><span class="hs-cpp">#endif</span><span>
</span><a name="line-1075"></a><span>
</span><a name="line-1076"></a><span>    </span><span class="hs-keyword">let</span><span> </span><span class="hs-identifier">remainingTysExpSubst</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">droppedTysExpSubst</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Type</span><span class="hs-special">]</span><span>
</span><a name="line-1077"></a><span>        </span><span class="hs-special">(</span><a name="local-6989586621679053779"><a href="#local-6989586621679053779"><span class="hs-identifier">remainingTysExpSubst</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679053780"><a href="#local-6989586621679053780"><span class="hs-identifier">droppedTysExpSubst</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1078"></a><span>          </span><span class="hs-identifier hs-var">splitAt</span><span> </span><a href="#local-6989586621679053774"><span class="hs-identifier hs-var">remainingLength</span></a><span> </span><a href="#local-6989586621679053777"><span class="hs-identifier hs-var">varTysExpSubst</span></a><span>
</span><a name="line-1079"></a><span>
</span><a name="line-1080"></a><span class="hs-comment">-- See Note [Generic1 is polykinded in base-4.10]</span><span>
</span><a name="line-1081"></a><span class="hs-cpp">#if !(MIN_VERSION_base(4,10,0))</span><span>
</span><a name="line-1082"></a><span>    </span><span class="hs-comment">-- If any of the dropped types were polykinded, ensure that there are of</span><span>
</span><a name="line-1083"></a><span>    </span><span class="hs-comment">-- kind * after substituting * for the dropped kind variables. If not,</span><span>
</span><a name="line-1084"></a><span>    </span><span class="hs-comment">-- throw an error.</span><span>
</span><a name="line-1085"></a><span>    </span><span class="hs-identifier hs-var">unless</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">all</span><span> </span><a href="Generics.Deriving.TH.Internal.html#hasKindStar"><span class="hs-identifier hs-var">hasKindStar</span></a><span> </span><a href="#local-6989586621679053780"><span class="hs-identifier hs-var">droppedTysExpSubst</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-1086"></a><span>      </span><a href="Generics.Deriving.TH.Internal.html#derivingKindError"><span class="hs-identifier hs-var">derivingKindError</span></a><span> </span><a href="#local-6989586621679053771"><span class="hs-identifier hs-var">tyConName</span></a><span>
</span><a name="line-1087"></a><span class="hs-cpp">#endif</span><span>
</span><a name="line-1088"></a><span>
</span><a name="line-1089"></a><span>        </span><span class="hs-comment">-- We now substitute all of the specialized-to-* kind variable names</span><span>
</span><a name="line-1090"></a><span>        </span><span class="hs-comment">-- with *, but in the original types, not the synonym-expanded types. The reason</span><span>
</span><a name="line-1091"></a><span>        </span><span class="hs-comment">-- we do this is a superficial one: we want the derived instance to resemble</span><span>
</span><a name="line-1092"></a><span>        </span><span class="hs-comment">-- the datatype written in source code as closely as possible. For example,</span><span>
</span><a name="line-1093"></a><span>        </span><span class="hs-comment">-- for the following data family instance:</span><span>
</span><a name="line-1094"></a><span>        </span><span class="hs-comment">--</span><span>
</span><a name="line-1095"></a><span>        </span><span class="hs-comment">--   data family Fam a</span><span>
</span><a name="line-1096"></a><span>        </span><span class="hs-comment">--   newtype instance Fam String = Fam String</span><span>
</span><a name="line-1097"></a><span>        </span><span class="hs-comment">--</span><span>
</span><a name="line-1098"></a><span>        </span><span class="hs-comment">-- We'd want to generate the instance:</span><span>
</span><a name="line-1099"></a><span>        </span><span class="hs-comment">--</span><span>
</span><a name="line-1100"></a><span>        </span><span class="hs-comment">--   instance C (Fam String)</span><span>
</span><a name="line-1101"></a><span>        </span><span class="hs-comment">--</span><span>
</span><a name="line-1102"></a><span>        </span><span class="hs-comment">-- Not:</span><span>
</span><a name="line-1103"></a><span>        </span><span class="hs-comment">--</span><span>
</span><a name="line-1104"></a><span>        </span><span class="hs-comment">--   instance C (Fam [Char])</span><span>
</span><a name="line-1105"></a><span>    </span><span class="hs-keyword">let</span><span> </span><span class="hs-identifier">varTysOrigSubst</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Type</span><span class="hs-special">]</span><span>
</span><a name="line-1106"></a><span>        </span><a name="local-6989586621679053781"><a href="#local-6989586621679053781"><span class="hs-identifier">varTysOrigSubst</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1107"></a><span class="hs-comment">-- See Note [Generic1 is polykinded in base-4.10]</span><span>
</span><a name="line-1108"></a><span class="hs-cpp">#if MIN_VERSION_base(4,10,0)</span><span>
</span><a name="line-1109"></a><span>          </span><span class="hs-identifier">id</span><span>
</span><a name="line-1110"></a><span class="hs-cpp">#else</span><span>
</span><a name="line-1111"></a><span>          </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><a href="Generics.Deriving.TH.Internal.html#substNamesWithKindStar"><span class="hs-identifier hs-var">substNamesWithKindStar</span></a><span> </span><a href="#local-6989586621679053778"><span class="hs-identifier hs-var">droppedKindVarNames</span></a><span class="hs-special">)</span><span>
</span><a name="line-1112"></a><span class="hs-cpp">#endif</span><span>
</span><a name="line-1113"></a><span>            </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679053772"><span class="hs-identifier hs-var">varTysOrig</span></a><span>
</span><a name="line-1114"></a><span>
</span><a name="line-1115"></a><span>        </span><span class="hs-identifier">remainingTysOrigSubst</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">droppedTysOrigSubst</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Type</span><span class="hs-special">]</span><span>
</span><a name="line-1116"></a><span>        </span><span class="hs-special">(</span><a name="local-6989586621679053782"><a href="#local-6989586621679053782"><span class="hs-identifier">remainingTysOrigSubst</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679053783"><a href="#local-6989586621679053783"><span class="hs-identifier">droppedTysOrigSubst</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1117"></a><span>            </span><span class="hs-identifier hs-var">splitAt</span><span> </span><a href="#local-6989586621679053774"><span class="hs-identifier hs-var">remainingLength</span></a><span> </span><a href="#local-6989586621679053781"><span class="hs-identifier hs-var">varTysOrigSubst</span></a><span>
</span><a name="line-1118"></a><span>
</span><a name="line-1119"></a><span>        </span><span class="hs-identifier">remainingTysOrigSubst'</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Type</span><span class="hs-special">]</span><span>
</span><a name="line-1120"></a><span>        </span><span class="hs-comment">-- See Note [Kind signatures in derived instances] for an explanation</span><span>
</span><a name="line-1121"></a><span>        </span><span class="hs-comment">-- of the useKindSigs check.</span><span>
</span><a name="line-1122"></a><span>        </span><a name="local-6989586621679053784"><a href="#local-6989586621679053784"><span class="hs-identifier">remainingTysOrigSubst'</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1123"></a><span>          </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679053770"><span class="hs-identifier hs-var">useKindSigs</span></a><span>
</span><a name="line-1124"></a><span>             </span><span class="hs-keyword">then</span><span> </span><a href="#local-6989586621679053782"><span class="hs-identifier hs-var">remainingTysOrigSubst</span></a><span>
</span><a name="line-1125"></a><span>             </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><a href="Generics.Deriving.TH.Internal.html#unSigT"><span class="hs-identifier hs-var">unSigT</span></a><span> </span><a href="#local-6989586621679053782"><span class="hs-identifier hs-var">remainingTysOrigSubst</span></a><span>
</span><a name="line-1126"></a><span>
</span><a name="line-1127"></a><span>        </span><span class="hs-identifier">instanceType</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Type</span><span>
</span><a name="line-1128"></a><span>        </span><a name="local-6989586621679053785"><a href="#local-6989586621679053785"><span class="hs-identifier">instanceType</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Generics.Deriving.TH.Internal.html#applyTyToTys"><span class="hs-identifier hs-var">applyTyToTys</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">ConT</span><span> </span><a href="#local-6989586621679053771"><span class="hs-identifier hs-var">tyConName</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679053784"><span class="hs-identifier hs-var">remainingTysOrigSubst'</span></a><span>
</span><a name="line-1129"></a><span>
</span><a name="line-1130"></a><span>        </span><span class="hs-comment">-- See Note [Kind signatures in derived instances]</span><span>
</span><a name="line-1131"></a><span>        </span><span class="hs-identifier">instanceKind</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Kind</span><span>
</span><a name="line-1132"></a><span>        </span><a name="local-6989586621679053786"><a href="#local-6989586621679053786"><span class="hs-identifier">instanceKind</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Generics.Deriving.TH.Internal.html#makeFunKind"><span class="hs-identifier hs-var">makeFunKind</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">map</span><span> </span><a href="Generics.Deriving.TH.Internal.html#typeKind"><span class="hs-identifier hs-var">typeKind</span></a><span> </span><a href="#local-6989586621679053783"><span class="hs-identifier hs-var">droppedTysOrigSubst</span></a><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">starK</span><span>
</span><a name="line-1133"></a><span>
</span><a name="line-1134"></a><span>    </span><span class="hs-comment">-- Ensure the dropped types can be safely eta-reduced. Otherwise,</span><span>
</span><a name="line-1135"></a><span>    </span><span class="hs-comment">-- throw an error.</span><span>
</span><a name="line-1136"></a><span>    </span><span class="hs-identifier hs-var">unless</span><span> </span><span class="hs-special">(</span><a href="Generics.Deriving.TH.Internal.html#canEtaReduce"><span class="hs-identifier hs-var">canEtaReduce</span></a><span> </span><a href="#local-6989586621679053779"><span class="hs-identifier hs-var">remainingTysExpSubst</span></a><span> </span><a href="#local-6989586621679053780"><span class="hs-identifier hs-var">droppedTysExpSubst</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-1137"></a><span>      </span><a href="Generics.Deriving.TH.Internal.html#etaReductionError"><span class="hs-identifier hs-var">etaReductionError</span></a><span> </span><a href="#local-6989586621679053785"><span class="hs-identifier hs-var">instanceType</span></a><span>
</span><a name="line-1138"></a><span>    </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679053785"><span class="hs-identifier hs-var">instanceType</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679053786"><span class="hs-identifier hs-var">instanceKind</span></a><span class="hs-special">)</span><span>
</span><a name="line-1139"></a><span>
</span><a name="line-1140"></a><span class="hs-comment">-- See Note [Arguments to generated type synonyms]</span><span>
</span><a name="line-1141"></a><span class="hs-identifier">grabTyVarsFromCons</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Generics.Deriving.TH.Internal.html#GenericClass"><span class="hs-identifier hs-type">GenericClass</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Con</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Q</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Type</span><span class="hs-special">]</span><span>
</span><a name="line-1142"></a><a name="grabTyVarsFromCons"><a href="Generics.Deriving.TH.html#grabTyVarsFromCons"><span class="hs-identifier">grabTyVarsFromCons</span></a></a><span> </span><span class="hs-identifier">_</span><span>      </span><span class="hs-special">[</span><span class="hs-special">]</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-1143"></a><span class="hs-identifier">grabTyVarsFromCons</span><span> </span><a name="local-6989586621679053787"><a href="#local-6989586621679053787"><span class="hs-identifier">gClass</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679053788"><a href="#local-6989586621679053788"><span class="hs-identifier">con</span></a></a><span class="hs-glyph">:</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1144"></a><span>    </span><span class="hs-identifier hs-var">fmap</span><span> </span><a href="Generics.Deriving.TH.Internal.html#fst3"><span class="hs-identifier hs-var">fst3</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Generics.Deriving.TH.Internal.html#reifyConTys"><span class="hs-identifier hs-var">reifyConTys</span></a><span> </span><a href="#local-6989586621679053787"><span class="hs-identifier hs-var">gClass</span></a><span> </span><span class="hs-special">(</span><a href="Generics.Deriving.TH.Internal.html#constructorName"><span class="hs-identifier hs-var">constructorName</span></a><span> </span><a href="#local-6989586621679053788"><span class="hs-identifier hs-var">con</span></a><span class="hs-special">)</span><span>
</span><a name="line-1145"></a><span>
</span><a name="line-1146"></a><span class="hs-comment">{-
Note [Forcing buildTypeInstance]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Sometimes, we don't explicitly need to generate a Generic(1) type instance, but
we force buildTypeInstance nevertheless. This is because it performs some checks
for whether or not the provided datatype can actually have Generic(1) implemented for
it, and produces errors if it can't. Otherwise, laziness would cause these checks
to be skipped entirely, which could result in some indecipherable type errors
down the road.

Note [Substituting types in constructor type signatures]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

While reifyConTys gives you the type variables of a constructor, they may not be
the same of the data declaration's type variables. The classic example of this is
GADTs:

  data GADT a b where
    GADTCon :: e -&gt; f -&gt; GADT e f

The type variables of GADTCon are completely different from the declaration's, which
can cause a problem when generating a Rep instance:

  type Rep (GADT a b) = Rec0 e :*: Rec0 f

Na&#239;vely, we would generate something like this, since traversing the constructor
would give us precisely those arguments. Not good. We need to perform a type
substitution to ensure that e maps to a, and f maps to b.

This turns out to be surprisingly simple. Whenever you have a constructor type
signature like (e -&gt; f -&gt; GADT e f), take the result type, collect all of its
distinct type variables in order from left-to-right, and then map them to their
corresponding type variables from the data declaration.

There is another obscure case where we need to do a type subtitution. With
-XTypeInType enabled on GHC 8.0, you might have something like this:

  data Proxy (a :: k) (b :: k) = Proxy k deriving Generic1

Then k gets specialized to *, which means that k should NOT show up in the RHS of
a Rep1 type instance! To avoid this, make sure to substitute k with *.
See also Note [Generic1 is polykinded in base-4.10].

Note [Arguments to generated type synonyms]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

A surprisingly difficult component of generating the type synonyms for Rep/Rep1 is
coming up with the type synonym variable arguments, since they have to be just the
right name and kind to work. The type signature of a constructor does a remarkably
good job of coming up with these type variables for us, so if at least one constructor
exists, we simply steal the type variables from that constructor's type signature
for use in the generated type synonym. We also count the number of type variables
that the first constructor's type signature has in order to determine how many
type variables we should give it as arguments in the generated
(type Rep (Foo ...) = &lt;makeRep&gt; ...) code.

This leads one to ask: what if there are no constructors? If that's the case, then
we're OK, since that means no type variables can possibly appear on the RHS of the
type synonym! In such a special case, we're perfectly justified in making the type
synonym not have any type variable arguments, and similarly, we don't apply any
arguments to it in the generated (type Rep Foo = &lt;makeRep&gt;) code.

Note [Polykinded data families in Template Haskell]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

In order to come up with the correct instance context and head for an instance, e.g.,

  instance C a =&gt; C (Data a) where ...

We need to know the exact types and kinds used to instantiate the instance. For
plain old datatypes, this is simple: every type must be a type variable, and
Template Haskell reliably tells us the type variables and their kinds.

Doing the same for data families proves to be much harder for three reasons:

1. On any version of Template Haskell, it may not tell you what an instantiated
   type's kind is. For instance, in the following data family instance:

     data family Fam (f :: * -&gt; *) (a :: *)
     data instance Fam f a

   Then if we use TH's reify function, it would tell us the TyVarBndrs of the
   data family declaration are:

     [KindedTV f (AppT (AppT ArrowT StarT) StarT),KindedTV a StarT]

   and the instantiated types of the data family instance are:

     [VarT f1,VarT a1]

   We can't just pass [VarT f1,VarT a1] to buildTypeInstanceFromTys, since we
   have no way of knowing their kinds. Luckily, the TyVarBndrs tell us what the
   kind is in case an instantiated type isn't a SigT, so we use the stealKindForType
   function to ensure all of the instantiated types are SigTs before passing them
   to buildTypeInstanceFromTys.
2. On GHC 7.6 and 7.8, a bug is present in which Template Haskell lists all of
   the specified kinds of a data family instance efore any of the instantiated
   types. Fortunately, this is easy to deal with: you simply count the number of
   distinct kind variables in the data family declaration, take that many elements
   from the front of the  Types list of the data family instance, substitute the
   kind variables with their respective instantiated kinds (which you took earlier),
   and proceed as normal.
3. On GHC 7.8, an even uglier bug is present (GHC Trac #9692) in which Template
   Haskell might not even list all of the Types of a data family instance, since
   they are eta-reduced away! And yes, kinds can be eta-reduced too.

   The simplest workaround is to count how many instantiated types are missing from
   the list and generate extra type variables to use in their place. Luckily, we
   needn't worry much if its kind was eta-reduced away, since using stealKindForType
   will get it back.

Note [Kind signatures in derived instances]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

We generally include explicit type signatures in derived instances. One reason for
doing so is that in the case of certain data family instances, not including kind
signatures can result in ambiguity. For example, consider the following two data
family instances that are distinguished by their kinds:

  data family Fam (a :: k)
  data instance Fam (a :: * -&gt; *)
  data instance Fam (a :: *)

If we dropped the kind signature for a in a derived instance for Fam a, then GHC
would have no way of knowing which instance we are talking about.

Another motivation for explicit kind signatures is the -XTypeInType extension.
With -XTypeInType, dropping kind signatures can completely change the meaning
of some data types. For example, there is a substantial difference between these
two data types:

  data T k (a :: k) = T k
  data T k a        = T k

In addition to using explicit kind signatures on type variables, we also put
explicit return kinds in the instance head, so generated instances will look
something like this:

  data S (a :: k) = S k
  instance Generic1 (S :: k -&gt; *) where
    type Rep1 (S :: k -&gt; *) = ... (Rec0 k)

Why do we do this? Imagine what the instance would be without the explicit return kind:

  instance Generic1 S where
    type Rep1 S = ... (Rec0 k)

This is an error, since the variable k is now out-of-scope!

Although explicit kind signatures are the right thing to do in most cases, there
are sadly some degenerate cases where this isn't true. Consider this example:

  newtype Compose (f :: k2 -&gt; *) (g :: k1 -&gt; k2) (a :: k1) = Compose (f (g a))

The Rep1 type instance in a Generic1 instance for Compose would involve the type
(f :.: Rec1 g), which forces (f :: * -&gt; *). But this library doesn't have very
sophisticated kind inference machinery (other than what is mentioned in
Note [Substituting types in constructor type signatures]), so at the moment we
have no way of actually unifying k1 with *. So the na&#239;ve generated Generic1
instance would be:

  instance Generic1 (Compose (f :: k2 -&gt; *) (g :: k1 -&gt; k2)) where
    type Rep1 (Compose f g) = ... (f :.: Rec1 g)

This is wrong, since f's kind is overly generalized. To get around this issue,
there are variants of the TH functions that allow you to configure the KindSigOptions.
If KindSigOptions is set to False, then generated instances will not include
explicit kind signatures, leaving it up to GHC's kind inference machinery to
figure out the correct kinds.

Note [Generic1 is polykinded in base-4.10]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Prior to base-4.10, Generic1 :: (* -&gt; *) -&gt; Constraint. This means that if a Generic1
instance is defined for a polykinded data type like so:

  data Proxy k (a :: k) = Proxy

Then k is unified with *, and this has an effect on the generated Generic1 instance:

  instance Generic1 (Proxy *) where ...

We must take great care to ensure that all occurrences of k are substituted with *,
or else the generated instance will be ill kinded.

In base-4.10 and later, Generic1 :: (k -&gt; *) -&gt; Constraint. This means we don't have
to do any of this kind unification trickery anymore! Hooray!
-}</span><span>
</span><a name="line-1335"></a></pre></body></html>